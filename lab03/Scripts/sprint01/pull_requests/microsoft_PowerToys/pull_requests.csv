number,created_at,merged_at,closed_at,files,additions,deletions,body_text,participants,comments
2,2019-05-06T23:33:59Z,2019-05-09T15:53:16Z,2019-05-09T15:53:16Z,1,1,1,Just a few typos I noticed while reading through the ReadMe.,4,1
9,2019-05-07T03:37:11Z,2019-05-09T15:57:30Z,2019-05-09T15:57:30Z,1,1,1,,3,1
201,2019-09-05T18:47:24Z,2019-09-06T17:02:33Z,2019-09-06T17:02:33Z,2,26,26,"Update the links in the backlog documentation

PR Checklist

 CLA signed.
 I've discussed this with core contributors already.",2,0
240,2019-09-06T11:54:46Z,,2019-09-06T17:18:45Z,1,1,1,Fixed a typo,3,1
242,2019-09-06T13:09:15Z,,2019-09-06T17:19:45Z,1,1,1,"Typos

Summary of the Pull Request
 
References

PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,1
251,2019-09-06T14:16:20Z,,2019-09-06T17:23:06Z,1,1,1,"Summary of the Pull Request
Fix a typo in README.md
References
None",3,1
258,2019-09-06T15:18:56Z,2019-09-06T17:42:58Z,2019-09-06T17:42:58Z,1,5,5,"Minor typos and more concise language.

Summary of the Pull Request
More concise language and fixed typos.
 
References
No other ref.

PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Used spellchecking software",3,1
273,2019-09-06T21:01:28Z,2019-09-09T16:19:17Z,2019-09-09T16:19:17Z,3,19,33,"Summary of the Pull Request
This PR changes the installer to use an advertised shortcut. It also enables the MSI Customize dialog, so that as we add more features to the MSI, the user can choose to install or not install the new features.
PR Checklist

 Closes #182
 CLA signed.
 I've discussed this with core contributors already. Issue number where discussion took place: #182.

Validation Steps Performed
Build the PR, and run the installer. I have tested initial installation, uninstallation, Customize and Repair (from Apps & Features in Windows), as well as shortcut self-healing.",2,4
280,2019-09-06T23:38:59Z,2019-09-09T11:47:19Z,2019-09-09T11:47:19Z,10,35,64,"Very minor code cleanup relating to HTML/JS/TS: add and remove empty lines where appropriate, replace double quotes in JS with single quotes, adjust vertical alignment, space out React lifecycle functions and move the opening curly braces to the same line as the function name.",4,4
318,2019-09-09T08:59:01Z,2019-09-09T13:13:22Z,2019-09-09T13:13:22Z,3,1,1,"Summary of the Pull Request


 I've discussed this with core contributors already.


Detailed Description of the Pull Request / Additional comments
Update the CI pipeline settings to use Visual Studio 2019.
Move the CI pipeline files from the build/ folder to the .pipelines/ci folder.

Validation Steps Performed
Tested on Azure.",2,0
323,2019-09-09T15:11:26Z,2019-11-15T23:28:19Z,2019-11-15T23:28:19Z,1,0,0,"Summary of the Pull Request
Added Hi-res logo (4k PNG)
 
References

PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
I've added a 4k logo since the one in the repo is a super-compressed .jpg

Validation Steps Performed
/",2,1
327,2019-09-09T16:41:44Z,2019-09-13T16:07:16Z,2019-09-13T16:07:16Z,4,34,4,"Summary of the Pull Request
This PR changes the license dialog to display the license, but not require the user to agree to it, as pointed out in #298. I also took the opportunity to edit the license RTF to use the Segoe UI font, rather than the ugly-looking Courier.
PR Checklist

 Closes #298
 CLA signed
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #298

Detailed Description of the Pull Request / Additional comments
The PTLicenseDlg.wxs file was copied and modified from WiX3. I assume that since the PTInstallDirDlg has the same license header, that this is OK.
Validation Steps Performed
Build the installer, run the installer. Observe the license page.",3,5
333,2019-09-10T09:18:07Z,2019-09-11T10:38:21Z,2019-09-11T10:38:21Z,19,34,36,"Summary of the Pull Request
Code cleanup. Fixes: #266

PR Checklist

 Closes #266
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
340,2019-09-10T16:50:51Z,2019-09-11T10:38:59Z,2019-09-11T10:38:59Z,1,9,4,"Summary of the Pull Request
When the taskbar is set to autohide do not display the arrows with numbers. This partially fixes #291.
 
References
#291

PR Checklist

 CLA signed. If not, go over here and sign the CLA",2,0
347,2019-09-11T10:10:03Z,2019-09-11T19:12:40Z,2019-09-11T19:12:40Z,1,6,8,"Summary of the Pull Request
Fix for #209

PR Checklist

 I've discussed this with core contributors already.


Detailed Description of the Pull Request / Additional comments
FZ needs to determine if the received event is for a window resize or a window move.
Before this fix, we were checking if the cursor was in the titlebar, but there are apps with custom titlebar that cause our logic to fail.
Instead of calling GetTitleBarInfo(), use the windows rect and assume that if the cursor position is inside the windows rect by a certain padding, the eent is for a window move.

Validation Steps Performed
Manual testing with several apps that have custom titlebars.",3,1
352,2019-09-11T14:12:18Z,2019-09-11T19:11:55Z,2019-09-11T19:11:55Z,1,1,1,"Summary of the Pull Request
Mitigate the problem described in #306

PR Checklist

 Tests passed
 I've discussed this with core contributors already.",3,0
364,2019-09-12T16:45:31Z,2019-09-14T10:53:54Z,2019-09-14T10:53:54Z,1,1,1,"Summary of the Pull Request
Simple edit to the README.md
References
None
PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Detailed Description of the Pull Request / Additional comments
Validation Steps Performed
None required",3,3
373,2019-09-13T13:30:11Z,2019-09-17T07:53:06Z,2019-09-17T07:53:06Z,2,10,5,"Summary of the Pull Request
Make sure an upgrade does a full uninstall first.

PR Checklist

 Closes #158
 I've discussed this with core contributors already.


Detailed Description of the Pull Request / Additional comments
Upgrading from a older version was not cleanup the previous installation completely.
RemovePowerToysSchTasks needs to be always executed after RemoveFiles regardless of any condition.
Updated a link in a comment.

Validation Steps Performed
Manual tests.",3,3
391,2019-09-16T20:17:09Z,2019-09-18T00:58:54Z,2019-09-18T00:58:54Z,9,576,499,"Summary of the Pull Request
This change makes the FZ editor get invoked on the monitor with the foreground window (or primary monitor if there is no foreground window). This allows the user to configure each monitor individually using the new editor.
This also fixes the issue where invoking the editor from the settings dialog does not bring the editor to the foreground
PR Checklist

[y] Closes #195 #292
[y] CLA signed. If not, go over here and sign the CLA
[y] Tests added/passed
[n] Requires documentation to be updated
[y] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Detailed Description of the Pull Request / Additional comments
WPF is pretty bad at mixed DPI systems so I use the engine to pass in the appropriate size/location that the editor should use
Updated various places throughout the code that I had marked with TODO multimon tags to ensure the proper experience
Validation Steps Performed
Manually deployed locally using monitors of various DPI to verify the editor invokes at the appropriate size and location",6,6
394,2019-09-17T11:55:16Z,2019-09-18T08:41:17Z,2019-09-18T08:41:18Z,6,35,23,"Summary of the Pull Request
First commit improves the filtering of what is considered ""active window"". This fixes #346.
The second commit uses the same filtering for FancyZones. This fixes #378.

PR Checklist

 Closes #346 and #378
 CLA signed.

Validation Steps Performed
Manual",2,0
395,2019-09-17T12:43:45Z,2019-09-18T08:41:52Z,2019-09-18T08:41:52Z,1,7,1,"Summary of the Pull Request
When moving a window to a zone, ensure it does not remain in maximized state. Fixes #388

PR Checklist

 Closes #388
 CLA signed.

Validation Steps Performed
Manual.",2,0
401,2019-09-18T16:29:45Z,2019-09-28T14:29:30Z,2019-09-28T14:29:30Z,7,108,72,"With this commit, I'm changing the behaviour of the FancyZones Layout
Editor. IMHO it should launch on the screen with the mouse cursor and
not the screen with the active window.
I found this behaviour way more intuitive.

Summary of the Pull Request
 
References
#400

PR Checklist

 Closes #400
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #400


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,12
406,2019-09-19T13:35:15Z,2019-09-26T06:54:01Z,2019-09-26T06:54:02Z,4,56,24,"Summary of the Pull Request
Fix for #389

PR Checklist

 Closes #389
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
438,2019-09-23T22:10:56Z,2019-09-26T21:23:11Z,2019-09-26T21:23:11Z,1,25,4,"the screen. Previously, it would iterate through the zones in the order
they were added and find the first one that fit the description. While
this works in most cases, if a user wants to have overlapping zones, it
is better to iterate through all of them and find the zone that the user
expects. There are cases where a zone is completely inaccessible on drag
because of the current code. To resolve this, the zone search will look
for the smallest zone possible. The reason I chose this solution is
because this guarantees that zones are at least reachable since if a
zone was bigger than another zone, then there must be a part of it
that is exposed, therefore reachable itself. Note: this solution is for
the scenario between two zones. More than that is not guaranteed. But I
feel like this covers enough scenarios to warrant its addition.
Example:

Zone1        -





Zone2  -  -






Previously, zone2 was inaccessible since it would iterate through 1 then
2. But 1 would always be seen first when dragging a window. With this
fix it zone2 will be accessible.

Summary of the Pull Request
 
References

PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,6
450,2019-09-27T10:21:30Z,2019-10-02T15:18:56Z,2019-10-02T15:18:56Z,13,237,17,"Summary of the Pull Request
Add a way to add custom hotkey input to the settings page. Use that to enable users to change the FancyZones editor launch hotkey.

PR Checklist

 Closes #203
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",3,3
467,2019-10-02T15:34:46Z,2019-10-03T08:12:37Z,2019-10-03T08:12:37Z,11,135,10,"Summary of the Pull Request
Add radio button group setting UI element and use it to add theme select for ShortcutGuide:

 

PR Checklist

 Closes #339
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,1
468,2019-10-03T08:33:41Z,2019-10-04T07:26:41Z,2019-10-04T07:26:41Z,5,92,5,"Summary of the Pull Request
Add a dropdown settings UI element. Example:

(This PR does not change the Shortcut Guide settings screen)

PR Checklist

 Closes #451
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Modified Shortcut Guide to use the dropdown instead of a choice group and tested manually.",2,1
471,2019-10-03T16:56:32Z,2019-10-04T09:50:28Z,2019-10-04T09:50:28Z,3,208,143,"Summary of the Pull Request
This PR fixes the blank Settings window when the PowerToysSettings.exe is running elevated.
Improved error handling for the WebView control initialization.

PR Checklist

 Solves one of the two bugs that are reported in #243
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
At startup, checks if PowerToysSettings.exe is running elevated and in that case drop the access token admin privileges.
If a fatal error occur during the WebView initialization, shows an error message instead of showing a blank window.
Code refactoring for easier integration of the upcoming WebView2 support.
Fix some warnings.
Coding style.
Note for the reviewers: I made several small commits to isolate the important changes from the code refactoring/variables and functions renaming.

Validation Steps Performed
Manual test.",2,1
474,2019-10-04T12:49:27Z,2019-10-07T09:12:45Z,2019-10-07T09:12:45Z,6,68,55,"Improve window filter to include start menu and Cortana search box.
Also moves GetProcessPath* functions to common, renaming both to get_process_path.

PR Checklist

 Closes #274
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,1
476,2019-10-05T06:53:38Z,2019-10-07T12:39:56Z,2019-10-07T12:39:56Z,1,32,34,"Summary of the Pull Request
After a fatal error, exit the Settings process.

Detailed Description of the Pull Request / Additional comments
After showing a MessageBox with the error, exit the process.
Fix some places where WINRT_VERIFY was used improperly.
Code formatting.

Validation Steps Performed
Manual test.",2,0
481,2019-10-08T07:15:25Z,2019-10-08T09:06:54Z,2019-10-08T09:06:54Z,1,1,1,"Summary of the Pull Request
Update the destination folder in the setting-html build command.
This is a regression from renaming the src/editor folder to src/settings
 
References
b50df5a

Validation Steps Performed
Manual testing.",2,0
483,2019-10-08T15:32:40Z,2019-10-09T13:57:33Z,2019-10-09T13:57:33Z,2,2,2,"this will fix issue #453 but I'm not sure about the. I'll change it if required

Summary of the Pull Request
this will fix issue #453 but I'm not sure about the. I'll change it if required. The window name was replaced from Window1 to ""FancyZones Editor""
 
References

PR Checklist

 Closes #453
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #453


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,2
488,2019-10-09T04:36:46Z,2019-10-09T14:18:37Z,2019-10-09T14:18:37Z,2,19,7,"Fix FancyZonesEditor CLI parsing of DPI on locales with comma as decimal separator.
 
Related existing issue #449

Although the CLI should be constructed with C locale (C/C++, invariant in C#) by the FancyZones application, I wasn't completely certain about that, so I resorted to using a fallback mechanism of trying both invariant and current cultures for float parsing.

Validation Steps Performed
Tested manually by setting computer language e.g. to Finnish (comma as decimal separator) and regression tested with en-us as computer culture, as well as Finnish with forced period as decimal separator.",2,1
491,2019-10-10T00:17:24Z,2019-10-10T15:25:09Z,2019-10-10T15:25:09Z,2,24,1,"Summary of the Pull Request
Ignore tool files.
 
References

PR Checklist

 Closes #xxx [N/A]
 CLA signed. If not, go over here and sign the CLA [MSFT employee]
 Tests added/passed [no change to code]
 Requires documentation to be updated [N/A]
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx [N/A]


Detailed Description of the Pull Request / Additional comments
Ignores Wix Toolset files.

Validation Steps Performed
Built.",2,0
494,2019-10-10T20:13:58Z,2019-10-16T08:21:45Z,2019-10-16T08:21:45Z,22,343,59,"Summary of the Pull Request
Make settings window support dark mode:


PR Checklist

 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manual",4,2
499,2019-10-11T20:32:34Z,2019-10-18T03:57:19Z,2019-10-18T03:57:20Z,63,6055,1,This is the initial add of the PowerRename PowerToy I ported from my SmartRename repo.  It is a Windows Shell Context Menu Extension for performing simple search and replace renaming or using regular expressions.,4,2
501,2019-10-14T16:13:02Z,2019-10-14T17:22:15Z,2019-10-14T17:22:15Z,14,39,4,"Summary of the Pull Request
Add product version to launch telemetry event.

PR Checklist

 I've discussed this with core contributors already.


Detailed Description of the Pull Request / Additional comments
Add defines in  common/version.h to be used by .rc files and other places.
There are still a few places where we don't use the file version number from common/version.h, I will file an issue to track it.

Validation Steps Performed
Manual test.",2,2
504,2019-10-14T19:25:48Z,2019-10-16T16:54:08Z,2019-10-16T16:54:08Z,2,6,5,"Summary of the Pull Request
rcNormalPosition in SetWindowPlacement is relative to the desktop work area. m_zoneRect is in absolute screen coordinates so we need to offset it by the diff between the monitor work area top/left and the monitor rect.",2,0
506,2019-10-15T03:38:13Z,2019-10-15T07:09:11Z,2019-10-15T07:09:11Z,1,1,1,"Summary of the Pull Request
Fixes a typo in organization.md
 
References

PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan.


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
508,2019-10-15T13:37:53Z,2019-10-22T07:46:16Z,2019-10-22T07:46:16Z,1,1,1,"Summary of the Pull Request
When a new window is created but is hidden, do not move it into a zone.

PR Checklist

 Closes #498
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",3,1
509,2019-10-15T13:42:49Z,2019-10-16T08:23:23Z,2019-10-16T08:23:23Z,1,1,0,"Summary of the Pull Request
Right now window-to-zone assignment is only saved if the window was snapped to a zone using the mouse. This PR makes snapping a window to a zone using WinKey+Left/Right also save the assigned zone to the registry.
 
References

PR Checklist

 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manual",3,0
510,2019-10-15T13:58:31Z,2019-10-15T23:14:41Z,2019-10-15T23:14:41Z,1,60,17,"Summary of the Pull Request
Resizing zones was not working in some cases.

PR Checklist

 Closes #257 #409 #427


Detailed Description of the Pull Request / Additional comments
The logic used by Move() works only for dragging the entire zone but it fails when dragging a top/left edge if the right/bottom edge is on the working area edge.
It was also causing the zone to drift right/bottom when resized to it's minimum width/height.
I split the methods to simplify the logic:

Move() is used only to move the zone.
SizeMove() (fell free to suggest a better name) is used when dragging the left/top edge.
Size() is used when dragging the right/bottom edge.

Also set c_minZoneWidth to 64 and c_minZoneHeight to 72 to reflect the actual minimum dimensions.

Validation Steps Performed
Manual test.",2,0
511,2019-10-15T17:11:35Z,2019-10-15T19:17:58Z,2019-10-15T19:17:58Z,1,1,1,"Fix typo in ""Resource"" on suggestion 3

Summary of the Pull Request
There as a typo in item #3 of the suggested enhancements
 
References

PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
512,2019-10-15T20:51:24Z,2019-10-15T22:02:13Z,2019-10-15T22:02:13Z,1,1,1,"Fix spelling.

Summary of the Pull Request
 
References

PR Checklist

 Closes #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
514,2019-10-16T10:14:59Z,2019-10-22T06:11:24Z,2019-10-22T06:11:24Z,11,79,49,"Summary of the Pull Request
Fix trace events when turning modules on/off.

PR Checklist

 I've discussed this with core contributors already.


Detailed Description of the Pull Request / Additional comments
The runner was calling module->disable(); before calling module->destroy();, that was preventing a module to distinguish between being turned off and PowerToys exiting and therefore misfiring the off trace event.
Added the on/off trace events to ShortcutGuide.

Validation Steps Performed
Manual test.",3,1
519,2019-10-17T11:10:40Z,2019-10-17T13:06:27Z,2019-10-17T13:06:27Z,5,213,300,"Summary of the Pull Request
Update some of the module dependencies to the newest version.

PR Checklist

 Closes #460
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
521,2019-10-17T16:39:28Z,,2019-10-24T20:01:47Z,66,6091,16,"Summary of the Pull Request
When the user releases the windows key, the shortcut guide overlay just disappears instantly. This PR fixes that by making the overlay fade out the same way as it fades in.
References
PR Checklist

[x ] Closes #486
[x ] CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
One weird behaviour I noticed is after the fade out was implemented, the thumbnail of the monitor on the overlay seemed to have its alpha (opacity) value go from transparent to fully visible for a split second, and after that it faded out properly with the rest of the overlay. The same brief transparency flash was happening no matter how long I made the fade out animation. This was however fixed with changing the alpha values of two lines on 588 and 597. I could not figure this out but it only worked when the two lines were changed, changing one and not the other and vice versa didn't make any difference. Maybe someone can shed some light on this?
Validation Steps Performed
Tested the fade in and fade out manually on different animation speeds from very short (0.1 secs) to very long (10 secs).",3,4
528,2019-10-18T09:10:29Z,2019-10-22T06:19:15Z,2019-10-22T06:19:15Z,1,4,4,"Summary of the Pull Request
Fix for crashing bug when resizing a zone in multi monitor configuration.
 
References
The bug was introduced in this commit c803982

Detailed Description of the Pull Request / Additional comments
The bug effects only multi monitor case where a monitor WorkArea coordinates may be different from {0,0}.
Since the zone rect.X and rect.Y coordinates are relative to the current monitor, the boundary check should be made using X=0 and Y=0 as coordinates of the current monitor regardless the absolute value of WorkArea.X and WorkArea.Y.

Validation Steps Performed
Manual tests.
Verified the fix works when the taskbar is on the left edge of the screen.",4,4
529,2019-10-18T09:45:09Z,2019-10-18T11:40:58Z,2019-10-18T11:40:58Z,1,1,1,"The issue reported in #375 (comment). Animation time should be refactored to a global setting after #521 lands.
PR Checklist

 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
537,2019-10-21T06:27:19Z,2019-10-21T11:28:22Z,2019-10-21T11:28:22Z,8,31,112,"Summary of the Pull Request
Add an icon for the PowerRename module settings.

PR Checklist

 I've discussed this with core contributors already.


Detailed Description of the Pull Request / Additional comments
Also removed unused icons.

Validation Steps Performed
Manual test:",3,1
541,2019-10-22T07:45:50Z,2019-10-23T16:42:41Z,2019-10-23T16:42:41Z,1,5,2,"PR Checklist

 Closes #437
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
542,2019-10-22T07:54:18Z,2019-10-24T21:07:10Z,2019-10-24T21:07:10Z,2,25,6,"Summary of the Pull Request
FZ Editor wasn't fitting small screens.

PR Checklist

 Closes #263 #442


Detailed Description of the Pull Request / Additional comments
This is just a quick fix to unblock users that have screen with a working area height less than 900px.
In that case the editor shows the layouts  horizontally and reduces the size of the squares.
We may revisit this fix to improve it since it has some limitations, for example the list of custom layouts will keep growing horizontally out of the screen area.
My proposal is to increase the current number of columns from 3 to 5 and use it on all monitors. We may also want to add a scrollbar.
I added the minimize button to the editor window, since on small screens it's very handy to not have the editor window covering most of the screen (on larger screens it doesn't hurt to have it as well).


Validation Steps Performed
Manual tests.",3,1
545,2019-10-23T13:37:36Z,2019-10-28T18:07:33Z,2019-10-28T18:07:33Z,7,33,19,"Summary of the Pull Request
Event names have to follow the naming convention, regex [A-Za-z][A-Za-z0-9_]* as per https://osgwiki.com/wiki/Vortex/EventQuality#Quality_bits

PR Checklist

 I've discussed this with core contributors already.


Detailed Description of the Pull Request / Additional comments
Replaced ::Event:: substring in event names with underscore.
Replaced ::Activity:: substring with _Activity_ because it's a different event and it may be useful to specify that in the name.
Added setting changed event for ShortcutGuide.

Validation Steps Performed
Manual test.",2,0
548,2019-10-23T16:37:45Z,2019-10-23T19:22:37Z,2019-10-23T19:22:37Z,2,14,12,"Summary of the Pull Request
Don't quit the FZ editor if no layout is selected when clicking on the ""Edit selected layout"".
Don't exit when clicking on ""Apply"" if no layout is selected.

PR Checklist

 Closes #448


Detailed Description of the Pull Request / Additional comments
Credit to @alexr3 for the fix. Alex provided a more extensive fix that disables the button when no layout  is selected, but it requires more changes to the XAML and we preferred to avoid that now.

Validation Steps Performed
Manual test.",2,0
553,2019-10-24T16:42:08Z,2019-10-24T20:17:45Z,2019-10-24T20:17:45Z,1,4,4,"Fixing casing of GitHub
Making release link accessible and specific
Correcting CLA text (labels were replaced with status checks)

Summary of the Pull Request
Doc-only update

 CLA signed. If not, go over here and sign the CLA
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan.",3,1
555,2019-10-24T21:05:19Z,,2019-12-18T10:28:06Z,2,26,10,"When the user releases the windows key, the shortcut guide overlay just disappears instantly. This PR fixes that by making the overlay fade out the same way as it fades in.
 
References
This is a replacement Pull Request from #521.

PR Checklist

 Closes #486
 CLA signed. If not, go over here and sign the CLA",4,8
563,2019-10-26T06:19:08Z,2019-10-28T17:15:00Z,2019-10-28T17:15:00Z,14,184,13,"This change adds the new icon for PowerRename as well as some telemetry calls

When we are invoked
Was the invocation successful or not
Enabled/Disabled set state of PowerRename
Was the UI stood up successfully
Details of the rename operation

total item count
selected item count
rename item count
flags used
list of extensions used with count",4,4
570,2019-10-28T19:00:11Z,2019-10-28T20:48:52Z,2019-10-28T20:48:53Z,2,0,0,"Summary of the Pull Request
Use PowerRename instead of Power Rename in the shell context menu and in the dialog title.

PR Checklist

 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
Also change the version number to use the same version number of PowerToys.

Validation Steps Performed
Tested manually.",3,9
596,2019-10-30T10:15:43Z,2019-10-31T09:26:02Z,2019-10-31T09:26:03Z,1,3,3,"Summary of the Pull Request
Use reserved 0xCF virtual key-code to suppress the Start menu from appearing instead of 0x07 which is used by the Xbox Controller for the Xbox Guide button.

PR Checklist

 Closes #595
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
605,2019-10-30T17:04:18Z,2019-10-31T09:26:25Z,2019-10-31T09:26:25Z,5,22,0,"Summary of the Pull Request
Hide Shortcut Guide when screenshots are taken.

PR Checklist

 Closes #574
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
614,2019-10-31T07:43:48Z,2019-10-31T13:57:39Z,2019-10-31T13:57:39Z,7,37,25,"Fixes include:

Pass parent HWND to UI so dialog is no longer appearing in top corner all the time
Fix duplicate entries for PowerRename in context menu for shortcuts
Fix crashing bug due to telemetry not getting unregistered on unload
Ensure we show the file extension in the UI even if extensions are hidden in Windows Explorer",2,0
617,2019-10-31T10:14:00Z,2019-10-31T16:51:21Z,2019-10-31T16:51:21Z,6,8,8,"Update the version, also fix #572",2,2
635,2019-11-01T06:59:24Z,2019-11-01T15:54:49Z,2019-11-01T15:54:50Z,4,148,14,This change updates the PowerRename dialog to be re-sizable.,2,1
656,2019-11-04T14:06:29Z,2019-11-05T13:29:43Z,2019-11-05T13:29:43Z,1,4,1,"Summary of the Pull Request
When a Chrome tab is moved, its style is changed so IsInterestingWindow no longer returns true. This would leave the zones highlighted. This PR stores the HWND of the window which move triggered the zones to be highlighted.

PR Checklist

 Closes #534
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,2
664,2019-11-06T10:49:53Z,2019-11-07T19:05:13Z,2019-11-07T19:05:13Z,2,5,5,"Summary of the Pull Request
Since winrt::com_ptr is akin to std::shared_ptr, it can cause memory leaks via circular references. We've had a FancyZones::m_zoneWindowMap field holding a reference to itself(this), preventing the destructor from running.

Detailed Description of the Pull Request / Additional comments
We never destroyed FancyZones object. The leak was happening because FancyZones had a field with a pointer to itself:

zoneWindow stores ref-counter pointer to a host, which is the actually FancyZones object
We store zoneWindow as part of a FancyZones::m_zoneWindowMap. winrt::com_ptr::copy_from is basically the same as shared_ptr copy ctor

So we need to clear the m_zoneWindowMap to break circularity.
I've also removed some of the com_ptrs fields, because now that we actually call ~FancyZones, it will free its FancyZones::m_settings member. But since FancyZones is being destroyed, that means we're in FancyZonesModule::destroy which has its own FancyZonesModule::m_settings. However, since FancyZones::FancyZones didn't share a refcount to the settings and instead did a m_settings.attach(settings);, we would crash in ~FancyZonesModule with a double free.
Same problem with a winrt::com_ptr<IFancyZonesCallback> m_callback basically.
Initial review was done by @bzoz, and he noticed that we would later may need to call set_config again after enable() in the runner.

Validation Steps Performed

Tested FancyZones dtor invocation by turning it off and on via settings window",4,1
665,2019-11-06T11:20:31Z,2019-11-07T08:52:35Z,2019-11-07T08:52:36Z,1,9,0,"Summary of the Pull Request
I've experienced severe system-wide keyboard input lagging when debugging a runner process caused by SetWindowsHookEx.
This PR allows to safely and easily toggling it in a debug environment.",2,1
669,2019-11-06T17:01:59Z,2019-11-07T16:50:05Z,2019-11-07T16:50:05Z,1,24,21,"Summary of the Pull Request
We could crash/read invalid memory if we have more than 9 zones. This PR adds wrap around for the array index.
 
References

PR Checklist

 Applies to #668",3,0
673,2019-11-07T11:03:42Z,2019-11-18T09:29:57Z,2019-11-18T09:29:57Z,15,537,332,"Summary of the Pull Request
Unifies the way windows are considered ""interesting"" by FancyZone. Before the change, WinKey + arrows would use a different method than dragging. This PR makes both use the WinKey + arrows method.
Cleans up FancyZones Settings.cpp by removing m_configStrings variable. Contrary to its name it was used to create color picker control.
Adds a multiline option to the text input to settings. Uses this to provide the user with a way to exclude certain apps from snapping to zones.

PR Checklist

 Applies to #531 #515 #500 #496 #479
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,6
677,2019-11-08T22:28:10Z,2019-11-12T10:48:14Z,2019-11-12T10:48:15Z,17,350,1,"Expose API for handling customized system menu per window. Allow modules to create system menu items, specify hotkey for them, specify default item state after creation (enabled/disabled) and specify whether checkbox will appear left to the menu item (checked/unchecked).
Each module registers helper class and pass configuration to it. Afterwards, when action is registered on custom system menu item, module will be triggered to process it accordingly.
All handling of custom system menu items is centralized and located inside runner project. This implementation ensures that no conflicts can occur in between modules.",5,4
692,2019-11-11T19:57:25Z,2019-11-11T21:16:29Z,2019-11-11T21:16:30Z,1,14,8,"added in processor support type with issue links
added in section to call out WinStore support issue
reduced size on image",2,0
694,2019-11-11T22:02:38Z,2019-11-12T05:55:41Z,2019-11-12T05:55:41Z,9,278,2,"getting specs into main repo from Mike's repo, trying to make us slowly a single entity :)",2,0
697,2019-11-12T07:12:44Z,2019-11-12T22:16:10Z,2019-11-12T22:16:11Z,23,1510,693,"Multiple fixes and feature implementations for PowerRename

Ensure each item to rename is added in depth-first order to ensure renames of children occur before parents.
Add icon to context menu item
Add autosuggest and autocomplete for search and replace fields
Persist inputs from previous runs
Add ability to restrict PowerRename to the extended context menu only
Add settings to configure some of the options in PowerRename
Fix a crashing bug that could occur on teardown due to an extra release of CPowerRenameUI
Renaming internal variables to not have ""smart"" in name.
Add delay loads for module dependencies",2,1
701,2019-11-12T14:05:14Z,2019-11-12T15:29:54Z,2019-11-12T15:29:55Z,2,8,7,"Summary of the Pull Request

_active wasn't initialized, so sometimes OnThreadExecutor thread could exit instantly.
renamed _active to _shutdown_request to clarify its purpose


PR Checklist

 Applies to #699


Validation Steps Performed
Launched the app multiple times both in debug and release configurations",2,0
702,2019-11-12T19:48:28Z,,2019-12-18T10:02:02Z,22,609,46,"This service provides simple window management, where user can specify certain window and force it to be always on top. This can be achieved either by opening window system menu (right mouse click on window title bar) and selecting Always On Top option, or through hotkey, which can be configured in general settings for Always On Top module.
This is a PR for #13 which also referenced #49",6,21
715,2019-11-14T18:45:12Z,2019-11-15T07:40:11Z,2019-11-15T07:40:11Z,3,41,5,"Summary of the Pull Request
Determine if we're using custom layout currently and open a corresponding editor tab on startup.

PR Checklist

 Applies to #592

Validation Steps Performed
Launched editor in debug&release mode",2,1
729,2019-11-17T01:27:08Z,2019-12-06T11:32:44Z,2019-12-06T11:32:44Z,2,26,1,"Per this issue:
#672
Added options in settings to use mouse buttons in addition to (or replacement of) the Shift key to enable/disable the zones in FancyZones. This allows for one-handed interaction with zones without disrupting existing interaction workflows.
Summary of the Pull Request
Other than settings additions, the only major change was the boolean logic determining shift enables.
References

PR Checklist

 Applies to #672
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Detailed Description of the Pull Request / Additional comments
One note here is that this is for all Virtual Key enabled buttons (Right, Middle, X1, and X2). There's no option to just use one or another at the moment.
Validation Steps Performed
Tested all button combinations.",3,7
735,2019-11-18T12:01:37Z,,2019-11-18T15:25:16Z,12,403,39,"Summary of the Pull Request

handles remote(RDC) case somewhat
workaround for EnumDisplayMonitors bug
uses WMI data when possible

References

PR Checklist

 Applies to #611


Validation Steps Performed

Debug/Release full registry clean launch on a desktop machine VM, VM-RDC, VM-RDC multimonitor.",3,0
737,2019-11-18T15:37:14Z,,2019-12-18T09:57:13Z,14,675,322,"Summary of the Pull Request

handles remote(RDC) case somewhat
workaround for EnumDisplayMonitors bug
uses WMI data when possible


PR Checklist

 Applies to #611
 Applies to #721


Validation Steps Performed

Debug/Release full registry clean launch on a desktop machine VM, VM-RDC, VM-RDC multimonitor.",3,1
739,2019-11-18T23:33:14Z,2019-11-19T18:00:49Z,2019-11-19T18:00:50Z,14,164,1179,"Summary of the Pull Request
This change removes the legacy editor and cleans up any code that depended on it being available.
Validation Steps Performed
Ran all tests and verified they still pass
Manually verified everything still runs as expected",3,0
742,2019-11-19T15:59:55Z,2019-12-06T11:16:25Z,2019-12-06T11:16:25Z,15,1852,1443,"Summary of the Pull Request
Our codebase has multiple code styles which differ from file to file. That goes in the way of Visual Studio auto-formatting rules and takes extra time to review. Visual Studio 2017+ has built-in .clang-format support.
Therefore I propose to decide on a preferred code style using this handy online configurator tool and then use this Powershell script to format all the source files. We could commit that change during Xmas break, so we minimize the chance of introducing merge conflicts for people with big pending PRs.
You can launch the script from a powershell prompt to format any modified source files in your working tree like this:
.\format_sources.ps1
Or format the entire codebase like this:
.\format_sources.ps1 -all
Note that you have to either run the script from the ""Native Tools Command Prompt for VS"" or have a clang-format.exe executable in your %PATH%.
Please let me know what you think and how we can improve this.",3,7
744,2019-11-19T23:03:03Z,2019-11-20T09:00:54Z,2019-11-20T09:00:55Z,8,31,13,"Summary of the Pull Request
Various improvements to the settings screen:

no more hardcoded version (#736)
padding below PowerToy description (#716)
make the labels for some items wrap correctly (#712)
user keyboard layout dependent key displayed in the settings screen (#700)


PR Checklist

 Applies to #700 #712 #716 #736
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,1
757,2019-11-22T13:17:50Z,2019-11-22T15:19:37Z,2019-11-22T15:19:37Z,4,9,4,"Summary of the Pull Request
Before:

After:

PR Checklist

 Applies to #720
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
771,2019-11-25T09:15:58Z,2019-11-25T10:54:11Z,2019-11-25T10:54:11Z,1,5,1,"Summary of the Pull Request
This makes the Hotkey settings object ignore the key value stored in JSON. Instead, it will be deduced from the current keyboard layout and the vk_code.

PR Checklist

 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manual",2,0
772,2019-11-25T12:49:24Z,2019-11-25T14:06:07Z,2019-11-25T14:06:07Z,1,1,1,"Summary of the Pull Request
The keyboard event handler in the ShortcutGuide was disabled (_enabled = false) after the handling object was destroyed (delete target_state). This caused a segfault when TargetState tried to process incoming events. This changes the order, disabling the event handler before deleting the object.
PR Checklist

 Applies to #780
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual.",3,2
784,2019-11-26T12:03:44Z,2019-11-26T15:14:35Z,2019-11-26T15:14:35Z,3,26,20,"Summary of the Pull Request
As a fallback, use the key detected by the WebUI.
Use the key detected by WebUI and our mapping only for from_settings call.
PR Checklist

 Applies to #783
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,1
786,2019-11-26T21:20:54Z,2019-11-27T03:45:19Z,2019-11-27T03:45:19Z,1,4,0,"This change adds handling for WM_THEMECHANGED which fires on theme or dpi changes.  We handle this with the same code we handle WM_SIZE.  This ensures we are sized correctly after a DPI change.  Works when moving to a different monitor that has different DPI setting as well.  Before, this would break our resize handling and the child window controls would exceed the width of the dialog window.  This doesn't resolve the issue of window contents being blurred when the window is moved to a monitor with higher DPI.  I'll resolve that when I get more time.",2,1
789,2019-11-27T11:31:36Z,2019-11-27T14:19:11Z,2019-11-27T14:19:11Z,1,26,12,"Summary of the Pull Request
Shell_NotifyIcon can fail when we invoke it during the time explorer.exe isn't present/ready to handle it. We'll also never receive wm_taskbar_restart message if the first call to Shell_NotifyIcon failed, so that changes reacts to WM_WINDOWPOSCHANGING which is always received on explorer startup sequence.

PR Checklist

 Applies to #268

Validation Steps Performed
Launched PowerToys while there's/isn't explorer.exe present, restarted explorer.exe",3,0
790,2019-11-27T12:06:45Z,2019-11-27T13:53:19Z,2019-11-27T13:53:19Z,1,8,0,"Summary of the Pull Request
There's no standard API to tell explorer to unload a shell extension, so we need to restart it.
RestartResource, which is a wrapper for Restart Manager API, isn't able to cleanly restart explorer since we got the API disabled, although enabling it produces other issues.
CloseApplication does the trick though. It's also conditioned not to close explorer if a user doesn't have an existing PowerRenameExt.dll shell extension installed.

PR Checklist

 Applies to #785


Validation Steps Performed
Performed clean and upgrade from 0.13 installation of compiled msi on desktop and VM.",2,0
796,2019-11-28T07:19:10Z,2019-11-30T13:38:27Z,2019-11-30T13:38:27Z,1,10,0,"Summary of the Pull Request
If there is a window focused in full screen don't flash current zone setup, even if that option is checked in FancyZones general settings. Window in full screen in different resolution (video game for example) would otherwise cause zones to flash since change in resolution is detected. Flashing zones would steel focus from currently active window.
Fix for: #306

Validation Steps Performed

Start any window in full screen (in different resolution than the specified desktop resolution).
Turn on Flash zones when the active FancyZones layout changes.

Expected behavior: Window keep his focus in full screen and FancyZones layout will not be flashed.",2,0
797,2019-11-28T08:10:41Z,2019-11-28T10:06:23Z,2019-11-28T10:06:23Z,3,5,5,"Summary of the Pull Request
Update version number.

Validation Steps Performed
Manually tested.",2,0
798,2019-11-28T19:55:46Z,,2020-04-14T08:27:35Z,10,44,269,"Summary of the Pull Request

port the editor to .NET core 3.0
update MahApps dependency to be fully compatible with .NET core 3.0
enable ReadyToRun startup optimization
update Wix installer to support the ported editor

PR Checklist

 Applies to #778
 Applies to #776


launched editor and performed common tasks
compiled installer and did the same in a clean VM",4,6
806,2019-11-29T14:27:40Z,2019-12-02T17:00:14Z,2019-12-02T17:00:15Z,2,7,5,"Summary of the Pull Request
Update the FancyZones readme to reflect the new options.

PR Checklist

 Applies to #805


Detailed Description of the Pull Request / Additional comments
Update FancyZoneSettings.png with current settings, and update the content of the table under the Settings paragraph.
Clarify that the Windows Snap override only applies to the right and left arrows.",2,0
815,2019-11-30T20:55:32Z,2019-12-06T14:09:27Z,2019-12-06T14:09:27Z,4,32,35,"Summary of the Pull Request
Newly created virtual desktops on same monitor should have same zone set initially as the virtual desktop they are created from. Currently when new virtual desktop is created, default zone set (only one zone representing work area) is used.

PR Checklist

 Applies to #383


Validation Steps Performed

Start PowerToys and select zone layout in FancyZones.
Create one or more virtual desktops on same monitor.
Check how zones are configured on each of them.

Expected behavior: Virtual desktops on same monitor have same zone layout initially as the virtual desktop from where they are created. User can change it latter through FancyZones Editor settings.",3,1
818,2019-12-01T20:27:00Z,2019-12-12T09:10:56Z,2019-12-12T09:10:56Z,1,85,1,"Summary of the Pull Request
Do not flash fancyzones layout every time user switches between virtual desktops. Only flash current fancyzones layout when user creates new virtual desktop. Flag Flash zones when the active FancyZones layout changes must be turned on.

PR Checklist

 Applies to #550


Validation Steps Performed

Start PowerToys application and turn on flag Flash zones when the active FancyZones layout changes.
Create several new virtual desktops.
Switch between virtual desktops using CTRL + WIN + Left/Right Arrow.

Expected behavior: Zone layout is flashed only when new virtual desktop is created. Later, during switching between virtual desktops there is no zone flashing.",3,8
822,2019-12-02T10:01:58Z,2019-12-06T08:40:23Z,2019-12-06T08:40:23Z,41,489,15703,"Summary of the Pull Request

port the solution to winrt::json library
remove deps
remove many unnecessary allocations
do not leak members of shortcut_guide in dtor
simplify module class and move implementation to .cpp
simplify settings API
fix some typos & update docs

PR Checklist

 Applies to #568

Validation Steps Performed

played with settings in debug and release mode
tested with removed general/module settings files from the %LOCALAPPDATA%
tested with malformed json for general/module settings files
54/55 unit tests succeeded (the one that fails also does so in master)",4,4
824,2019-12-02T12:36:18Z,,2019-12-06T09:45:41Z,14,78,104,"Summary of the Pull Request
Minor refactoring. Initial implementation and description in #822

PR Checklist

 Applies to #823",2,1
841,2019-12-03T17:30:36Z,2019-12-03T18:45:04Z,2019-12-03T18:45:04Z,2,7,4,"Summary of the Pull Request
Fixes ""Move newly created windows to their last known zone""

PR Checklist

 Applies to #830 and #840
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",3,0
852,2019-12-03T23:37:25Z,2019-12-04T00:55:13Z,2019-12-04T00:55:13Z,1,1,1,"Summary of the Pull Request
Fix for this issue revered original behavior which is not intended. Description for this FancyZones settings was invalid, as it didn't explained behavior of this feature in proper way. This pull request will revert original fix, and description for this setting will be updated.
 
References

PR Checklist

 Applies to #768


Validation Steps Performed

Create two customs layouts.
Select the first layout, move a window to the zone.
Switch layout and verify that the window is only moved to the second zone when the flag is off.

Expected behavior: When the flag is on, the window should not move.",2,0
856,2019-12-04T09:23:53Z,2019-12-04T16:53:54Z,2019-12-04T16:53:54Z,2,19,4,"Summary of the Pull Request
Further improve the filtering of the windows for FancyZones. Clean up the code and make it more straightforward.
PR Checklist

 Applies to #829 #830 #840 #851
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",3,4
868,2019-12-05T12:15:14Z,,2019-12-19T15:27:42Z,2,35,2,"Summary of the Pull Request
Handles correctly hidden and minimized windows.
PR Checklist

 Applies to #867
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",3,6
871,2019-12-05T16:52:49Z,2019-12-05T18:09:33Z,2019-12-05T18:09:33Z,3,5,5,"Summary of the Pull Request
Update version number.
Validation Steps Performed
Manually tested.",2,0
883,2019-12-06T16:30:30Z,2019-12-09T08:03:07Z,2019-12-09T08:03:07Z,4,11,11,"Summary of the Pull Request
Update WiX NuGet package to latest version
 
References

PR Checklist

 Applies to #791


Validation Steps Performed
Manually tested.",2,0
896,2019-12-09T11:32:22Z,2019-12-09T13:37:43Z,2019-12-09T13:37:44Z,1,7,0,"Summary of the Pull Request

how to use clang-format from Visual studio
how to use format_sources script


PR Checklist

 Applies to #882",2,1
898,2019-12-09T13:42:08Z,2019-12-09T16:02:47Z,2019-12-09T16:02:48Z,2,9,2,"Summary of the Pull Request
Ngen reduces app startup time for .NET 4.7.

PR Checklist

 Applies to #778


Validation Steps Performed
Installed PowerToys and launched ngen display for the installed FancyZonesEditor executable.",2,3
902,2019-12-10T05:16:09Z,2019-12-10T23:31:32Z,2019-12-10T23:31:32Z,4,32,21,"Summary of the Pull Request
Gets the example project to build as part of the PowerToys.sln
 
References

PR Checklist

[] Applies to #xxx
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Updating configuration manager to build example_project for Debug/Release
Including  in common.h
Using std::optional instead of PowerToysValues::is_[type]_value
Fixing warnings generated by unreferenced 'ex' variable in exception handling.
Updated relative path of version.h in exeample_powertoy.rc


Validation Steps Performed
Manual",2,3
905,2019-12-10T06:00:36Z,2019-12-10T22:13:13Z,2019-12-10T22:13:13Z,1,43,9,"Summary of the Pull Request
This test brake was introduced in the following fix:
1efe5bf
It looks to me like the test cases just was also wrong and just wasn't updated with the fix.
I've modified some of the test cases to verify the expected behavior:

Slight refactor of the tests to pass in the SearchReplaceExpected and flags for the tests.
Using Assert::AreEqual instead of Assert::IsTrue for better error meesaging when failed.
Verifying that the behavior is the same with or without match all occurances when using *.
Verifying that without the UseRegularExpressionsFlag the .* characters get replaced, including when MatchAllOccurances is set.

 
References

PR Checklist

[] Applies to #904
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Ran updated unit tests
Note:  The clang format change is making this diff very difficult to read in github.  Here is a screenshot(s) of the main changes in beyond compare.
Edit:

Added Methods:",3,5
911,2019-12-10T23:33:29Z,2019-12-11T08:41:06Z,2019-12-11T08:41:06Z,1,5,0,"Summary of the Pull Request
Sometimes FancyZones editor is displayed behind PowerToys general settings window.

PR Checklist

 Applies to #832


Validation Steps Performed

Open PowerToys general settings page.
Go to FancyZones and start editor (Edit zones button).

Expected behavior: FancyZones editor is displayed in front of PowerToys settings window.",3,0
912,2019-12-11T01:27:33Z,2019-12-11T16:49:46Z,2019-12-11T16:49:46Z,1,28,6,"Just attempting to get the remainder of the unit tests green, as I onboard to the codebase.

Summary of the Pull Request

Creating a mock ZoneWindowHost.   Previously creating a ZoneWindow would throw an exception if the ZoneWindowHost is null.
Passing in HWND() instead of null to get rig of SAL annotation warnings.

 
References

PR Checklist

 Applies to #918
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Manually ran unit tests.",4,5
913,2019-12-11T11:36:23Z,2019-12-12T09:25:20Z,2019-12-12T09:25:20Z,20,432,348,"Summary of the Pull Request
This is the initial PR to split docs between audiences: users and developers. It also adds details for runner implementation, since it's a module which the majority of developers should be familiar with.
You can test the new navigation here.

split usage and dev docs
add runner documentation and move hooks documentation to devdocs
add stubs for modules technical description
add paragraph about event thread-safety


PR Checklist

 Applies to #761",3,1
917,2019-12-11T18:16:43Z,2019-12-16T17:03:38Z,2019-12-16T17:03:38Z,3,325,216,"Summary of the Pull Request
When a non-admin user runs PowerToys as Adminstrator, the runner fails to start the Settings app.
 
References
#884

PR Checklist

 Applies to #344


Detailed Description of the Pull Request / Additional comments
Instead of just failing, if the runner can't get the Settings to run non-elevated, run it elevated and let the Settings handle that.
This is part one of the fix since the current way way of dropping elevated privileges in the Settings process doesn't work in this scenario. We'll make those changes in a different PR.
This change also applies to the changes made by #884 since it simplify the way the Settings are executed when the runner is not running elevated.

Validation Steps Performed
Manually tested.",3,0
921,2019-12-12T16:18:33Z,2019-12-12T17:24:01Z,2019-12-12T17:24:01Z,1,762,1,"Summary of the Pull Request
Unit tests for PowerToysSettings: Settings, PowerToyValues, CustomActionObject, HotkeyObject
 
References

PR Checklist

 Applies to #184
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
924,2019-12-12T21:01:06Z,2019-12-13T17:55:31Z,2019-12-13T17:55:31Z,2,2,2,"Summary of the Pull Request
Fix warning messages in runner and FancyZones module (signed / unsigned comparisons).

PR Checklist

 Applies to #922",2,0
926,2019-12-12T23:55:12Z,,2019-12-16T21:08:45Z,1,3,2,"Summary of the Pull Request
Spacing was added to the zones after editing custom layout based on value written for spacing, no matter if flag Show space around zones is on or off. Use spacing 0 if Show space around zones is disabled.

PR Checklist

 Applies to #752


Validation Steps Performed

Open FancyZones editor.
Switch off Show space around zones. Set Space Around Zones to some positive value.
Select any layout and click Edit Selected Layout.
Apply and save changes.

Expected Behavior: If flag Show space around zones is disabled, no space should be when layout is applied.",3,5
927,2019-12-13T00:30:41Z,2019-12-13T22:09:20Z,2019-12-13T22:09:20Z,34,1026,747,"Summary of the Pull Request
Enabled code analysis for the editor. This does not fix 2 issues for ##923 for
 
References

PR Checklist

 Applies to #910
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
ran application and editor worked as expected",2,0
934,2019-12-13T15:06:15Z,2019-12-16T10:12:36Z,2019-12-16T10:12:36Z,10,395,337,"Summary of the Pull Request

fix compilation errors in the PowerToy project template
include it to the main solution to keep it up to date
create a separate solution to easily export/sign it later
update exported .zip and clarify usage in README


PR Checklist

 Applies to  #566

Validation Steps Performed
Built the template project, added new PowerToy via template to the main solution, built it.",2,1
943,2019-12-15T01:10:03Z,2019-12-16T08:40:16Z,2019-12-16T08:40:16Z,1,2,2,"Now in line with #913
Applies to #944
Just fixing some links, checked them myself, now in line with package structure.
Validation Steps Performed
Just checked links.",2,1
950,2019-12-16T18:56:06Z,2019-12-17T08:21:47Z,2019-12-17T08:21:47Z,33,61,23,"Summary of the Pull Request
Removed headers which are actually could be changed.

PR Checklist

 Applies to #949",3,0
957,2019-12-17T09:45:22Z,2019-12-17T12:37:11Z,2019-12-17T12:37:11Z,3,104,46,"Summary of the Pull Request
Restrict DPI unaware windows horizontally to the current display to avoid unwanted automatic resize by Windows. This could introduce a small horizontal gap for those windows due to clamped right_margin; increasing it even by 1px triggers the bug though.

PR Checklist

 Applies to #762
 Applies to #893


Validation Steps Performed
Tested various horizontal/vertical combinations of column/row/custom layout with a different scaling levels and dpi-(un)aware apps.",3,0
982,2019-12-19T12:17:19Z,2019-12-24T14:47:29Z,2019-12-24T14:47:29Z,2,18,3,"Summary of the Pull Request
FancyZones won't zone windows when starting.

PR Checklist

 Applies to #967
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,4
983,2019-12-19T12:42:26Z,2019-12-19T15:02:25Z,2019-12-19T15:02:25Z,1,6,0,"Summary of the Pull Request
FancyZones: do not zone invisible windows
PR Checklist

 Applies to #867
 CLA signed. If not, go over here and sign the CLA

Validation Steps Performed
Manual",2,0
990,2019-12-19T19:54:40Z,2019-12-19T21:39:09Z,2019-12-19T21:39:09Z,1,0,0,"Summary of the Pull Request
Adds the *.vstemplate file to the ModuleTemplate.zip folder so that it can be picked up from Visual Studio.
References

PR Checklist

 Applies to #971
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


I re-exported the ModuleTemplate.zip folder, and manually modified the MyTemplate.vstemplate file.


Validation Steps Performed
These steps can be validated on the following branch:
https://github.com/ryanbodrug-microsoft/PowerToys/tree/user/ryanbod/example_ui

I added a new powertoy using the PowerToy module template.
Verified that the safeprojectname variable is correctly replaced.
Verified that the project runs and breakpoints hit inside  powertoy_create and init_settings",2,2
992,2019-12-20T15:20:39Z,2019-12-24T14:06:59Z,2019-12-24T14:06:59Z,9,164,3,"Summary of the Pull Request
Update project template with a fixed $projectname$.rc.
PR Checklist

 Applies to #991",3,2
993,2019-12-20T17:16:43Z,2019-12-24T14:06:11Z,2019-12-24T14:06:11Z,34,706,165,"Summary of the Pull Request
Implemented initial MSIX support. Follow the instructions at installer\README.md to test it. I haven't done exhaustive test of each setting, though generally this stuff works:

FancyZones
Shortcut_guide
Startup task as non-elevated and as elevated (tested as admin user)
PowerRename, except for bool_show_extended_menu option, since it's not supported by IExplorerCommand. Backward compatibility with .msi is preserved for now


PR Checklist

 Applies to #836
 Applies to #202",4,3
1000,2019-12-20T22:56:09Z,2019-12-24T04:17:18Z,2019-12-24T04:17:18Z,1,2,2,"Summary of the Pull Request
 
References

PR Checklist

 Applies to #923
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
validated with owner regarding proper math and other spots in code match pattern.  Example:
Canvas.SetTop(resizer, _rowInfo[row].End + (spacing / 2) - 24);",2,0
1001,2019-12-20T23:49:20Z,2019-12-24T04:16:04Z,2019-12-24T04:16:04Z,1,3,1,"clearly stating when ""Match all"" needs to be enabled

Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
1008,2019-12-23T20:41:03Z,2020-01-06T17:59:19Z,2020-01-06T17:59:19Z,9,29,4,"Opacity of the zone selection highlight is now a user setting.  I tested this manually.
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,6
1010,2019-12-25T09:42:16Z,2020-01-09T21:40:39Z,2020-01-09T21:40:39Z,3,118,18,"Summary of the Pull Request
Zone layout looks different in layout priview (just going through predefined zones in main editor window) and once You actually try to edit zone by going to Edit selected layout. Over the edges of the screen, in layout preview zone spacing is smaller in comparisson to editing layout where we have correct spacing both between zones and between zone edges and border of the screen (monitor).

PR Checklist

 Applies to #952


Validation Steps Performed

Open FancyZones editor (go to edit zones in FancyZones general settings).
Select a 4 zones grid template with 20px spacing.
Check one of the corners, for instance the top-left corner.
Click Edit selected layout.

Expected result: Spacing between edges of the zones and border of the screen is the same as the spacing between zones itself (both for layout preview and when editing layout).",3,4
1012,2019-12-26T14:23:32Z,2019-12-26T16:25:57Z,2019-12-26T16:25:57Z,3,367,305,"Summary of the Pull Request
Codying style applied to the settings project.

PR Checklist

 Applies to ##779


Validation Steps Performed
Verified solution builds correctly.",2,0
1013,2019-12-26T14:40:32Z,2019-12-26T16:26:12Z,2019-12-26T16:26:12Z,21,1398,1150,"Summary of the Pull Request
Codying style applied to the runner project.

PR Checklist

 Applies to #779


Validation Steps Performed
Manually tested.",2,0
1017,2019-12-26T19:07:30Z,2019-12-26T22:20:38Z,2019-12-26T22:20:38Z,1,0,0,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #768
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
1023,2019-12-27T14:13:22Z,2019-12-27T15:20:37Z,2019-12-27T15:20:37Z,2,2,2,"Change the text to Run PowerToys with elevated privileges

PR Checklist

 Applies to #1022
 CLA signed.",2,0
1024,2019-12-27T19:13:24Z,2019-12-27T20:51:09Z,2019-12-27T20:51:09Z,1,2,0,Docs was missing statement on getting changes picked up by the main app.,2,0
1025,2019-12-27T20:35:51Z,2019-12-27T21:41:51Z,2019-12-27T21:41:51Z,4,45,7,"matching language from Windows.
#937 is tracking issue.",2,0
1037,2020-01-02T09:07:19Z,2020-01-03T15:10:33Z,2020-01-03T15:10:33Z,3,4,38,"Summary of the Pull Request
Remove temp build files.

PR Checklist

 Applies to #1036",2,1
1054,2020-01-08T00:19:42Z,2020-01-08T17:22:45Z,2020-01-08T17:22:45Z,123,135,755,"Summary of the Pull Request
Shifted the ImageResizer projects to the PowerToys solution. The ImageResizer folder was moved to src/modules, but the folder was renamed to imageresizer to be consistent with naming conventions in the modules. The following projects were added to PowerToys.sln:

ImageResizer
ImageResizer.Test
ShellExtensions


PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments

ImageResizer moved to src/modules/imageresizer
ImageResizer, ImageResizer.Test, ShellExtensions added to PowerToys.sln


Validation Steps Performed
All the projects build successfully, and all the tests pass in both PowerToys.sln and ImageResizer.sln. The ImageResizer C# project runs normally in the PowerToys.sln.",2,0
1058,2020-01-08T22:41:35Z,2020-01-09T00:24:07Z,2020-01-09T00:24:07Z,12,466,2,"Summary of the Pull Request
Added COM interfaces and structure required to implement preview handler

PR Checklist

 Applies to #914


Detailed Description of the Pull Request / Additional comments
List of COM interfaces added

IPreviewHandler
IPreviewHandlerFrame
IPreviewHandlerVisuals
IObjectWithSite
IOleWindow
IInitialiseWithStream

List of struct added

COLORREF
LOGFONT
MSG
RECT",3,0
1061,2020-01-09T15:22:50Z,2020-01-09T17:17:43Z,2020-01-09T17:17:43Z,6,46,5,"Summary of the Pull Request
Also make the message box appear on top of the settings window.
New message box texts:
IDS_COULDNOT_RESTART_NONELEVATED ""Could not start PowerToys as a user!""
IDS_COULDNOT_RESTART_ELEVATED ""Could not start PowerToys as an administrator!""
IDS_ERROR ""PowerToys Error""

Preview:

PR Checklist

 Applies to #1060
 CLA signed

Validation Steps Performed
Manual",2,0
1068,2020-01-10T10:48:00Z,2020-01-10T13:38:36Z,2020-01-10T13:38:36Z,2,2,1,"Summary of the Pull Request
Create a separate script for msix_building w/o signing, since MS has internal pipeline for that.

PR Checklist

 Applies to #1067


Validation Steps Performed
Launched the scripts.",2,0
1073,2020-01-10T23:22:15Z,2020-01-14T19:43:40Z,2020-01-14T19:43:40Z,9,619,375,"Summary of the Pull Request
Updated the dllmain.cpp to match the PowerToys template, and added a Settings.cpp which mimics the settings codebase of PowerRename.
Currently the only setting which is implemented is Enabling/Disabling the PowerToy.
There is now a working ImageResizer which can be enabled/disabled with the PowerToy settings. It can currently be ""installed"" by the process described in the Validation Steps Performed section.
 
Future Changes to be made

Include ImageResizer in the installer
Renaming the files and projects to be consistent with other power toys code bases.
Shift settings from registry to JSON while maintaining performance and access safety


PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Detailed Description of the Pull Request / Additional comments

Implemented the PowerToyModuleIface in dllmain.cpp
Added ShellExtensions.dll to the runner
Updated header files stdafx.h and targetver.h to build and mimic other power toys (if the version support was provided for WinXP as in the original image resizer code, the common/settings_objects.h cannot be used as it contains macros which aren't defined for WinXP.)
Added Settings.cpp and Settings.h which mimic PowerRename. A class with static methods is used and the settings are stored in registry instead of a JSON file. Since registry operations are atomic in Windows there is no issue of thread-safety.
The settings implemented so far are only the Enabled/Disabled flag for the powertoy as a whole. If ImageResizer is disabled, the ""Resize pictures"" option is removed from the context menu.
The changes in the vcxproj file and vcxproj.filters file are the addition of the new files(Settings.h and Settings.cpp).


Validation Steps Performed

Since the installer has not yet been updated, the following steps can be followed for testing the power toy:

Build the solution. This will automatically register the ShellExtensions.dll at HKEY_CLASSES_ROOT\*\shellex\ContextMenuHandlers\Image Resizer. The Resize pictures option will now appear on the context menu when an image is right clicked, however it will fail as the exe file hasn't been linked yet.
Add registry entry for the ImageResizer.exe file at HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\BriceLambson\ImageResizer with the string value as the path of the ImageResizer.exe generated from the build (src\modules\imageresizer\ImageResizer\bin\Debug\ImageResizer.exe). The Resize pictures option will work now.
Run PowerToys. The enable/disable ImageResizer option will work as expected.



Screenshots

Enabled


Disabled",2,0
1076,2020-01-11T14:48:08Z,2020-01-20T10:02:13Z,2020-01-20T10:02:13Z,2,9,4,"Summary of the Pull Request
We added the dialog box styles to the ""not zonable window"" filter, to prevent Save As.. and similar dialogs to be assigned to a zone. This caused a lot of apps that use dialog styles to not work with FancyZones. This PR removes those dialog box styles, since the ""window has no owner"" rule makes the actual dialog boxes not zonable.

PR Checklist

 Applies to #970 #908 #531 #209
 CLA signed

Validation Steps Performed
Manual
--
Edit: affected issues",3,11
1078,2020-01-11T14:56:30Z,,2020-01-15T21:17:07Z,1,8,0,"PR Checklist

 Applies to #1077
 CLA signed.

Validation Steps Performed
Manual",3,1
1087,2020-01-14T00:24:38Z,2020-01-15T18:16:23Z,2020-01-15T18:16:23Z,3,19,9,"Summary of the Pull Request
 
References

PR Checklist

 Applies to #1086, #1047
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,1
1089,2020-01-14T11:12:27Z,,2020-01-15T17:48:56Z,1,5,0,"Summary of the Pull Request
We try to bring the dialog using SetForegroundWindow, which sometimes fail in cases like a user immediately pressing alt+tab after executing rename command and before the dialog was initialized. We use SetWindowPos in that case.

PR Checklist

 Applies to #1039


Validation Steps Performed
Launched PowerRename dialog multiple times.",3,3
1090,2020-01-14T11:26:23Z,2020-01-14T16:36:09Z,2020-01-14T16:36:09Z,1,1,1,"PR Checklist

 Applies to #1047


Validation Steps Performed
Assembled msix package and installed it, verified that the name has been changed.",2,0
1093,2020-01-14T17:57:27Z,2020-01-14T19:05:10Z,2020-01-14T19:05:10Z,1,5,0,"PR Checklist

 Applies to #1092",2,0
1094,2020-01-14T18:11:04Z,2020-01-15T17:42:16Z,2020-01-15T17:42:16Z,7,56,165,"Summary of the Pull Request

Removed unnecessary configurations in the solution file to match master (Only Release/Debug-x64).
Added ImageResizer installation files to the msi installer (PowerToysSetup project)
Changed output directories and configurations in ImageResizer project files.
Fixed registry locations to Software/Microsoft.

Tested manually using the installer.
 

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA


Changes to Installer

Added check for existing image resizer installation to kill explorer.exe(same procedure is done for powerrename)
Added all the requisite dll files for ImageResizer
Added 3 registry entries - DragAndDropHandler, ContextMenuHandler and for the CLSID with the ShellExtensions.dll source.


Validation Steps Performed

Installed/uninstalled when registry entry for powerrename/imageresizer/both was there and explorer.exe was open
Installed/uninstalled when registry entry for powerrename/imageresizer wasn't there and explorer.exe was open
Used the Resize pictures option when PowerToys.exe was open/closed.",3,3
1095,2020-01-14T20:17:19Z,2020-01-15T18:15:25Z,2020-01-15T18:15:25Z,1,12,5,Adjusting based on going through instructions,3,0
1101,2020-01-16T00:46:36Z,2020-01-16T07:06:22Z,2020-01-16T07:06:23Z,13,158,119,"Summary of the Pull Request
Shifted some functions from PowerRenameLib/Helpers.h to Common as they could be reused. Out of the 5 functions 3 were moved as these 3 did not seem PowerRename specific. CreateBitMapFromIcon would be reused for ImageResizer (the motivation for this issue/PR).

PR Checklist

 Applies to #1098
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Detailed Description of the Pull Request / Additional comments

Created two new header files and source files under common:

icon_helpers.h : Moved CreateBitmapFromIcon and GetIconIndexFromPath
window_helpers.h : Moved CreateMsgWindow


Included these header files wherever they were referenced (PowerRenameLib/PowerRenameItem.cpp, PowerRenameLib/PowerRenameManager.cpp, PowerRenameExt/PowerRenameExt.cpp)
Added Common project reference in PowerRenameTest and PowerRenameUnitTests to fix compilation linker errors


Validation Steps Performed

Builds successfully in Debug/Release x64
All test cases pass
Used the MSI installer to install PowerToys and verify that PowerRename is working",3,0
1105,2020-01-16T19:00:38Z,2020-01-18T01:42:18Z,2020-01-18T01:42:18Z,41,420,263,"Summary of the Pull Request
Synced the imageResizer dev branch with master. (Last synced at the creation of this branch).
Adding these changes as a separate PR to make reviewing easier. There were no merge conflicts, so all the changes from master have been added as is.

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed

Build and install debug/release x64, all powertoys run normally
All test cases pass",8,0
1106,2020-01-16T22:05:36Z,2020-01-20T20:11:08Z,2020-01-20T20:11:08Z,8,34,17,"Summary of the Pull Request
This pull request is to localize the PowerRename Project. All the hardcoded strings from the PowerRename projects are moved to resource script files.
 
References

PR Checklist

 Applies to #199
 CLA signed. If not, go over here and sign the CLA
 PowerRename Tests passed


Detailed Description of the Pull Request / Additional comments
All hardcoded strings have been moved out to the .rc (resource script files) of each project. Wrappers have been implemented to extract these resources from the string tables of the resource script files.

Validation Steps Performed

Build and install all configurations of PowerToys (Debug/Release x64)
All Unit tests pass
Installed PowerToys run as expected.",6,3
1107,2020-01-17T00:37:47Z,,2020-01-17T18:23:24Z,0,0,0,"Summary of the Pull Request
This pull request is adding the functional spec for the Keyboard Manager.
Changes:

Added the KeyManager.md in the spec folder
Added the images from the spec in a new folder in the image folder in doc/specs/images
Updated the readme.MD in images to include link to KeyManager.md

 
References
N/A

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
N/A",3,1
1108,2020-01-17T06:21:30Z,2020-01-22T01:18:14Z,2020-01-22T01:18:14Z,9,428,5,"Summary of the Pull Request
Added extension for manipulating markdown AST

PR Checklist

 Tests added/passed


Detailed Description of the Pull Request / Additional comments

Added a markdig extension to modify markdown AST to add bootstrap classes and convert relative paths in markdown to absolute path.
Added a test project to use for previewpane and added tests for the extension",4,1
1109,2020-01-17T17:31:21Z,2020-02-12T23:30:41Z,2020-02-12T23:30:41Z,33,418,0,"Summary of the Pull Request
Adding PowerLauncher spec and images under doc/specs/images/PowerLauncher/.
this is for Issue #44
We'll be closing feedback here 1/29/2020",14,29
1112,2020-01-17T21:21:40Z,2020-02-01T00:10:31Z,2020-02-01T00:10:31Z,18,267,0,"Summary of the Pull Request
This pull request is adding the functional spec for the Keyboard Manager.
Changes:

Added the KeyManager.md in the spec folder
Added the images from the spec in a new folder in the image folder in doc/specs/images
Updated the readme.MD in images to include link to KeyManager.md


PR Checklist

 Applies to #6

We'll be closing feedback here 1/29/2020",6,9
1114,2020-01-17T23:52:12Z,2020-01-21T16:57:57Z,2020-01-21T16:57:57Z,2,76,2,"Summary of the Pull Request
This PR moves the context menu entry to the same section as the Rotate right/left options and moves the drag and drop menu entry down below the Copy here entry. Details of the investigations are available in issue #1110. These changes have only been verified for the MSI installer. Handling the same for MSIX will be done in a separate PR linked to the same issue.

PR Checklist

 Applies to #1110
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Detailed Description of the Pull Request / Additional comments

Details of how the context menu ordering works can be found in #1110
Based on the details above, since the ShellImagePreview which contains Rotate Left/Right is registered at HKCR/SystemFileAssociation/.png/ShellEx/ContextMenuHandlers/ShellImagePreview, the same has to be done with ImageResizer for each of the supported types. Thus there are entries for bmp, dib, gif, jfif, jpe, jpeg, jpg, jxr, png, rle, tif, tiff, wdp (all the directly supported types mentioned in the ImageResizer code). Images like .ico also ""work"" with the ImageResizer.exe but it converts it to jpg instead, so it doesn't actually resize a .ico back to .ico.
ShellImagePreview adds 4 entries: a separator, Rot right, Rot left and another separator. For a basic check without making the context menu handling more resource intensive, a simple check for a separator at the start index(indexMenu arg) has been added to make sure that if an older version of Windows is being used where ShellImagePreview isn't available or if it has been disabled the code will still run fine.
The drag and drop handler index was simply increased by one because Copy here was the initial first value in the context menu.


Validation Steps Performed

Build, install, run on Debug/Release x64
Tests passed
Checked position of drag/drop and context menu entry for .jpg, .png, .bmp.",4,6
1115,2020-01-18T14:36:58Z,2020-01-22T19:15:36Z,2020-01-22T19:15:36Z,4,131,44,"Summary of the Pull Request
Zone layout looks different in layout priview (just going through predefined zones in main editor window) and once You actually try to edit zone by going to Edit selected layout. Over the edges of the screen, in layout preview zone spacing is smaller in comparisson to editing layout where we have correct spacing both between zones and between zone edges and border of the screen (monitor).

PR Checklist

 Applies to #952


Validation Steps Performed

Open FancyZones editor (go to edit zones in FancyZones general settings).
Select a 4 zones grid template with 20px spacing.
Check one of the corners, for instance the top-left corner.
Click Edit selected layout.

Expected result: Spacing between edges of the zones and border of the screen is the same as the spacing between zones itself (both for layout preview and when editing layout).",4,1
1120,2020-01-20T18:28:13Z,2020-01-20T19:43:48Z,2020-01-20T19:43:48Z,2,9,4,"Reverts #1105 and re-adds the same changes. To be merged normally.
The diff shows the changes only for the last commit on master.",9,0
1121,2020-01-20T19:52:59Z,2020-01-21T17:08:08Z,2020-01-21T17:08:08Z,109,60,60,"Summary of the Pull Request
Renamed the folders and projects as per PowerRename.
There are 3 folders under imageresizer:

dll : Contains the ImageResizerExt project (previously ShellExtensions)
ui : Contains the ImageResizerUI project (previously ImageResizer)
tests : Contains the ImageResizerUITest project (previously ImageResizer.Test)

All files and references of ShellExtensions has been replaced by ImageResizerExt.
Added an empty README.md file for ImageResizer.

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed

Build/Install/Run Debug/Release x64
All test cases pass",3,1
1122,2020-01-20T22:09:40Z,2020-01-21T20:02:32Z,2020-01-21T20:02:32Z,6,198,24,"Summary of the Pull Request
Removed the hardcoded strings from the C# Project of FancyZones (FancyZonesEditor) and moved them to a resource file instead. Set the ResourceManager to use the UI Culture, so that the corresponding resource file would be chosen once the strings are translated.

PR Checklist

 Applies to #199
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Detailed Description of the Pull Request / Additional comments
The hardcoded strings of the FancyZonesEditor Project have been moved to resource files and referenced. In the future, once we have a resource file for each language, the resource file corresponding to the user UI is chosen, otherwise the default Resource file is used.

Validation Steps Performed

Build and run all the powerToys in both the Debug and Release modes.
Validated the working of the resource files by creating a French resource file and checked its working by changing my System language.",5,1
1123,2020-01-20T22:18:26Z,2020-01-21T00:48:54Z,2020-01-21T00:48:54Z,2,2,26,"Summary of the Pull Request

Renamed references to ""Advanced Options"" string in Resources.resx to ""Settings"". A similar change would have to be made to the resx files of the other languages.
Removed the About tab from Advanced Options (Views/AdvancedWindow.xaml).


PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests passed",2,0
1126,2020-01-21T01:08:48Z,2020-01-22T17:43:50Z,2020-01-22T17:43:50Z,5,66,48,"Summary of the Pull Request
Localize the strings of the shortcut guide PowerToy. Moved the hard coded strings to the resource file and reference them in the project.

PR Checklist

 Applies to #199
 CLA signed. If not, go over here and sign the CLA
 All Tests of the PowerToys code passed


Detailed Description of the Pull Request / Additional comments
All the strings of the shortcut guide power toy are moved to the Stringtable of the resource script file and referenced.

Validation Steps Performed

Build and Run PowerToys in both Debug and Release modes.
All the tests pass.",6,0
1128,2020-01-21T17:12:25Z,2020-01-22T21:36:11Z,2020-01-22T21:36:11Z,12,784,602,"Summary of the Pull Request
Added a markdig based preview pane handler.
 
References

https://docs.microsoft.com/en-us/archive/msdn-magazine/2007/january/windows-vista-and-office-writing-your-own-preview-handlers


PR Checklist

 Applies to #914
 Tests added/passed


Steps to build this project

Open the solution in VS 2019 as admin.
Build MarkdownPreviewHandler project. Dll would be located at <root>\src\modules\MarkdownPreviewHandler\common\bin\Debug
Open developer command prompt in visual studio. Goto Tools > Command Line > Developer command prompt.
Change directory to C:\Windows\Microsoft.NET\Framework64\<LatestVersion>
Register dll using below command
gacutil -i <path to dll>
RegAsm.exe <path to dll> \codebase",6,5
1129,2020-01-21T17:44:39Z,2020-01-23T17:27:12Z,2020-01-23T17:27:12Z,13,676,9,"Summary of the Pull Request
Extended the Common library to create a Preview Handler for Svg.
 
References

PR Checklist

 Applies to #963
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Added a Preview Pane Handler for Svg Files. Implementation is leveraging the WebBrowser Control to render the Svg.

Validation Steps Performed
Run the SvgPreviewHandler Locally.
Steps to run the

Open the solution in VS 2019 as admin.
Build SvgPreviewHandler project. Dll would be located at <root>\src\modules\SvgPreviewHandler\common\bin\Debug
Open developer command prompt in visual studio. Goto Tools > Command Line > Developer command prompt.
Change directory to C:\Windows\Microsoft.NET\Framework64\<LatestVersion>
Register dll using below command
gacutil -i <path to dll>
RegAsm.exe <path to dll> \codebase

OutStanding Work

 Add unit tests for the Svg Preview Handler.",3,0
1130,2020-01-21T23:49:11Z,2020-01-22T18:24:01Z,2020-01-22T18:24:01Z,3,21,17,"Summary of the Pull Request
The hardcoded strings are moved into resource files.

PR Checklist

 Applies to #199
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed

Build and run powerToys in both Debug and Release mode.",3,0
1133,2020-01-22T15:38:56Z,2020-01-23T14:12:03Z,2020-01-23T14:12:03Z,2,3,3,"Summary of the Pull Request
Fixes restarting with the same elevation when installed from MSIX

PR Checklist

 Applies to #1132
 CLA signed.

Validation Steps Performed
Manual",3,0
1134,2020-01-22T15:43:53Z,,2020-02-03T22:06:51Z,10,131,137,"Summary of the Pull Request
Add a ""approved apps"" settings, similar to the ""excluded apps"" one. If an app is on this list, more of the apps window will be zonable.
Unifies the code that decides if a window is zonable. Before this, WinKey + Arrows used different code than dragging the window.
PR Checklist

 Applies to #894 (SUMo and XYplorer) #1104
 CLA signed.

Validation Steps Performed
Manual.",3,12
1139,2020-01-23T09:40:12Z,2020-01-23T11:42:29Z,2020-01-23T11:42:29Z,3,66,2,"Summary of the Pull Request
We need both of those .rc's for localization and dialog boxes to work. I've kept the boilerplate generated by VS's resource editor, so it doesn't get added automatically in the future etc.
The issue was caused by PowerRenameUWPUI using external resource file - PowerRenameUI.rc. It doesn't contain the IDS_POWERRENAME string which is responsible for the menu item title (see CPowerRenameMenu::GetTitle).
We cannot just simply use PowerRenameExt.rc instead which contains IDS_POWERRENAME, because we also need IDD_MAIN for the UI dialog, which is contained in the former file.
Therefore, I've created a new resource file for UWPUI project, which simply #includes both files mentioned above.

PR Checklist

 Applies to #1136

Validation Steps Performed
Launched the PowerRename from the MSIX",2,1
1146,2020-01-24T14:30:36Z,2020-01-27T17:01:37Z,2020-01-27T17:01:37Z,6,80,2,"Summary of the Pull Request
Implement the new event and telemetry support in the settings project.
 
PR Checklist

 Applies to #1145",2,0
1148,2020-01-24T14:35:38Z,2020-01-27T14:33:51Z,2020-01-27T14:33:51Z,1,1,1,"Summary of the Pull Request
The problem description is in the issue #1147.
PR Checklist

 Applies to #1147",2,0
1152,2020-01-24T17:54:06Z,2020-01-27T15:00:42Z,2020-01-27T15:00:42Z,2,11,3,"Summary of the Pull Request
added links for feedback and reporting a bug.  It would be nice if we added in the version automatically
 
References

PR Checklist

 Applies to #1140 and #569


Validation Steps Performed
clicked links and validated they launch correctly",2,0
1156,2020-01-26T00:55:07Z,2020-01-31T19:40:20Z,2020-01-31T19:40:20Z,23,1212,103,"Summary of the Pull Request
Added Unit tests for the PreviewHandlerCommon.

PR Checklist

 Applies to #963
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Added a new Unit Test Project UnitTests-PreviewHandlerCommon. Updated the access modifiers for existing interfaces.
External Dependencies:

Moq(Used for mocking interfaces): Consumed as Nuget by Unit Test Project BSD Clause-3 Licensed.



Validation Steps Performed
Unit tests passed.",3,0
1170,2020-01-28T19:41:14Z,2020-01-28T23:01:18Z,2020-01-28T23:01:18Z,1,17,8,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #1164",2,0
1174,2020-01-29T11:23:24Z,2020-01-29T13:15:19Z,2020-01-29T13:15:19Z,3,15,7,"Summary of the Pull Request

do not apply the option for packaged
add this.state.settings.general.packaged flag so we can filter other settings (e.g. admin/elevation-related) using it
add condition to not show the option in settings-web


PR Checklist

 Applies to #1161, #1163

Validation Steps Performed

Launched packaged and non-packaged versions of PT and verified that the feature is working
Enabled/Disabled the setting from the non-packaged version
All unit tests passed",3,0
1177,2020-01-29T19:14:26Z,2020-01-31T23:14:38Z,2020-01-31T23:14:38Z,53,14345,0,"Import the codebase for Window Walker without loading it into the module list nor adding it to the installer list.
Summary of the Pull Request
A couple of things to note,

You won't be able to try out window walker in PowerToys until you add WindowWalker back into the module list (reverting the change here)
The code is essentially the same as what is currently sitting on the develop branch in betsegaw/windowwalker except that Window Walker won't show on first launch to be consistent with the other PowerToys.

 
References
#44 - Win+R replacement

PR Checklist

 Applies to #861 alt-tab quick selector
 CLA signed.
Tests added/passed
Requires documentation to be updated
 I've discussed this with core contributors already.


Validation Steps Performed

Tested the when activated Window Walker launches and the other Power Toys launch as well. Currently, this module is just an import of the existing Window Walker code so the goal was just to make sure not to break PowerToys.",3,0
1178,2020-01-29T21:14:12Z,2020-02-04T16:41:01Z,2020-02-04T16:41:02Z,28,794,0,"Summary of the Pull Request
Initial implementation of #1020:

simple MessageBox-like toasts
toasts with multiple buttons with background activation and easy handler registration


PR Checklist

 Applies to #1020

Detailed Description of the Pull Request / Additional comments
PT is a Desktop Bridge app, not a true UWP app, because we need to run it full-trust to access numerous APIs and have compatibility with MSI. We might want to fully port it to UWP in the future, but as it currently is, the toast notifications' registration is done in a bit roundabout way.
We must implement IBackgroundTask as an in-proc activation server (WinRT analogue of in-proc COM server) if we want reacting to ToastNotification's actions while the PT isn't running.
Since IBackgroundTask implementation class should be in a WinRT component library to be built correctly, it must use the dynamic version of C/C++ runtime. That means it cannot link e.g. common libraries to it, since all PT's modules use static runtime instead. Moreover, it cannot be the activatable DLL directly, since in that case it must be linked to a true UWP app, otherwise we get an obscure error in the Event viewer while Windows was trying to launch our background task:

failed to activate with error code 0x8007007E

After some researching, I've discovered that it actually means that Windows uses WinRT analogue of regsvr32 to load notifications.dll and instantiate IBackgroundTask's class, but fails to do so because of missing msvcp140_app.dll and the like. Those libraries are UWP versions of C/C++ runtime and, as we imagine, shouldn't be distributed with our app directly. Since we're a Desktop Bridge app, dynamic loader isn't made aware of them, and we fail to load our DLL.
That brings us to the following design:

notifications is a static WinRT library with a dynamic C/C++ runtime which implements a single IBackgroundTask implementation class which serves as a dispatcher for all background tasks handlers
all actual handlers should be implemented in notifications library and registered via handler_functions.cpp:handlers_map
notifications_dll is a classic DLL library with a dynamic C/C++ runtime which implements some plumbing and avoids having to deal with 0x8007007E. we register it as a activator in manifest
common library and any other PT modules can use new notifications API functions for showing toasts using the src/common/notifications.h header

Validation Steps Performed

unit test passed
launched multiple toasts",4,5
1181,2020-01-30T13:11:39Z,2020-01-31T17:35:22Z,2020-01-31T17:35:22Z,8,147,22,"Summary of the Pull Request

make the option inactive instead of hiding it
provide explanation string why it's inactive

P.S. yay, coroutines!

PR Checklist

 Applies to #1161, #1163

Validation Steps Performed

Launched packaged and non-packaged versions of PT and verified that the feature is working
Enabled/Disabled the setting from the non-packaged version
All unit tests passed",4,0
1183,2020-01-30T13:18:15Z,2020-02-04T15:56:11Z,2020-02-04T15:56:11Z,5,12,11,"Summary of the Pull Request
Add wildcard to search for old and new package name versions.
PR Checklist

 Applies to #1180",2,1
1184,2020-01-30T13:42:30Z,2020-02-03T08:32:39Z,2020-02-03T08:32:39Z,2,55,66,"Summary of the Pull Request
Makes FancyZone use the same code for filtering windows when windows are being dragged and when moved by WinKey + arrows.
This is mostly a code refactor, but it also solves one issue.

PR Checklist

 Applies (partly) to #1182
 CLA signed.
 Tests added/passed

Detailed Description of the Pull Request / Additional comments

The IsInterestingWindow method is moved ""as is"" to the FancyZones.cpp.
3 IsInterestingWindow calls were moved to the FancyZones.cpp in appropriate places
In 2 places in FancyZones.cpp where we used get_filtered_active_window() and GetWindow(window, GW_OWNER) calls, we now use IsInteresetingWindow.
The m_movedWindow is removed. It fixed an issue when a Chrom tab is dragged into another Chrome instance, the style would change so that the window would become uninteresting. FancyZones would be stuck in ""window is dragged mode"", so we kept a reference to the dragged window to make sure we disengage the display of the zones. In the FancyZones.cpp the reference is already kept in m_windowMoveSize, we will reuse it.
For #1182 we should probably not swallow the keyboard events. Excluded apps should probably be able to use regular Windows snapping.

Validation Steps Performed
Unit tests
Manual tests with Notepad, Git Extensions and Chrome",2,6
1186,2020-01-30T14:28:08Z,2020-02-06T12:13:00Z,2020-02-06T12:13:00Z,2,5,4,"Summary of the Pull Request
Do not swallow WinKey+Arrow events for non-interesting windows. This makes apps that are in the ""excluded apps"" list behave as if ""Override windows snap keys"" is disabled - they will react to the Windows default snap.
This requires #1184 to be merged first. The changes specific to this PR are in the second commit.

PR Checklist

 Applies to #1182
 CLA signed.
 Tests added/passed

Detailed Description of the Pull Request / Additional comments

This does not include CycleActiveZoneSet. For whatever reason WinKey+Ctrl+Nubers seems to not work at all.
The ""Save As..."" dialog can be snapped using WinKey+Arrow when the ""Override windows snap keys"" is disabled. With this change the ""Save As..."" dialog will always react to the Windows default snap keys.

Validation Steps Performed
Unit test
Notepad and Notepads Save As dialog with and without it in the excluded apps.",2,3
1194,2020-01-31T17:02:18Z,2020-02-10T13:59:52Z,2020-02-10T13:59:52Z,41,8475,1884,"This PR introduces large redesign of FancyZones core functionalities: instead of Windows registries, the user custom zone layouts, the active layouts and all the relevant information are now stored in a JSON file. No user content will be lost after applying these changes, since migration from registry to JSON is performed at startup (if detected that user is still using ""old"" storage). Human readable JSON files will make it easier for users to understand the behavior of FancyZones and if needed to change some settings directly inside the JSON file.
Communication between FancyZones module (C++) and editor window (C#) is done through temporary JSON files, where the editor always returns difference between old and new zone layout setup (changes invoked by user during activity in editor window). The FancyZones editor (C#) is no longer loading native FancyZones library (this was a requirement for future ARM support).
This applies to #368 and #390.
Special thanks to @SeraphimaZ for all the help regarding improving code quality and minimizing the risk of regressions and covering entire FancyZones module with unit tests. Also, thanks to @vldmr11080 for the latest bug fixing and making the entire change more stable.
NOTE: App zone history feature for multi monitor is not fully functional yet. It's WIP.",6,1
1195,2020-01-31T19:07:14Z,2020-02-01T01:12:55Z,2020-02-01T01:12:55Z,48,885,193,"Summary of the Pull Request
This PR syncs changes from master, since a large number of the changes correspond to MSIX.

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests passed",8,1
1198,2020-02-01T00:27:40Z,2020-02-01T02:17:08Z,2020-02-01T02:17:08Z,1,14,14,Tweaks to readme,2,0
1212,2020-02-04T16:13:47Z,2020-02-05T11:31:35Z,2020-02-05T11:31:35Z,1,8,0,"Summary of the Pull Request
This filters out TaskView and Win32 menus.
PR Checklist

 Applies to #1159
 CLA signed.

Validation Steps Performed
Manual using PaswordSafe, 1Password, TortoiseSVN, GOG Galaxy beta, GlassWire, VS Code and Battle.net launcher",2,4
1216,2020-02-04T17:57:33Z,2020-02-05T11:27:54Z,2020-02-05T11:27:54Z,1,21,1,"Summary of the Pull Request
Further improve what can and cannot be zonable. This fixes a case for some apps that run an invisible top-level window.

PR Checklist

 Applies to #1204 #894 (SUMo, XYplorer and the self-coded app from the 3rd comment)
 CLA signed.

Validation Steps Performed
Manual. Tested with PaswordSafe, 1Password, TortoiseSVN, GOG Galaxy beta, GlassWire, VS Code and Battle.net launcher which still can be zonable. Tested with Notepad: Save As is not zonable, File menu and the about window is not getting zoned on creation. Tested SUMo, XYplorer, the self-coded app, and the FastZone Image View app - those can now be zoned as expected.",2,0
1219,2020-02-05T22:06:20Z,2020-02-10T17:29:31Z,2020-02-10T17:29:31Z,7,160,26,"Summary of the Pull Request
This PR adds ImageResizer to the MSIX package and makes code refactoring to implement the IExplorerCommand interface which is required for MSIX Context menu handlers. There is no perf issue for ImageResizer (as in #1197 ) when PowerRename is commented out in the appmanifest.xml.

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Detailed Description of the Pull Request / Additional comments

Added ImageResizer files and dlls to MSIX packaging layout
Added ImageResizerExt.dll as SurrogateServer (ExeServer can't be used as there is no C++ exe for it).
Added a file explorer context menu entry to the appmanifest for *
Removed the registry key which stores the ImageResizer.exe file location from the MSI installer and made changes to the code so that the location of ImageResizer.exe is identified using the location of the module ImageResizerExt.dll.
Implemented IExplorerCommand interface methods which are required for MSIX.
Modified ResizePictures() method to be reusable for both MSI and MSIX builds.

Observed issues and workarounds

On adding the SurrogateServer, the icon failed to load. This happened because the current module in ContextMenuHandler.cpp is Dllhost.exe, and in the GetIcon function the icon was being retrieved from the current module. This was resolved by pointing to the module HINSTANCE of ImageResizerExt.dll instead.
Adding the ImageResizer fileExplorerContextMenus handler to a particular file type like .png instead of * resulted in very weird menu entry positioning, and it caused the ""Open"" entry to move down for some reason. A workaround was to set it as * instead of particular file types and filter for image file types within the GetState function in the code.
.png handler

* handler


Open Issues

The drag and drop handler does not appear on MSIX install.
The Resize pictures option does not appear with Rotate left/right (as in #1110 ). Unlikely to be fixable based on investigation for #1038 .

Validation Steps Performed

Verified with multiple MSIX install/uninstalls.
All tests pass
Checked the context menu with png and jpg files and non-image files.
Checked enabling/disabling ImageResizer

How to Validate

Follow the instructions in the Readme to create the self-signed certificate and install using MSIX. Make sure to enable Sideloading Apps under the Windows Developer Options.
Launch the PowerToys Preview from start menu to adjust any global settings.
Right-clicking any image/group of images will provide a Resize pictures option which opens the ImageResizer executable.",2,1
1220,2020-02-06T01:38:53Z,2020-02-11T19:59:43Z,2020-02-11T19:59:43Z,14,639,209,"Summary of the Pull Request
Updated markdown preview pane project to remove script tag and block images with absolute path.

PR Checklist

 Applies to #914
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
This PR adds security feature similar to html preview pane renderer. The following are major features :

Script tag is removed from the Markdig AST before parsing to html.
Images with absolute paths are blocked from being displayed.
Clicking on any link will open it in the default user browser.
Added information bar at the top of previews which have atleast one image blocked.",3,0
1222,2020-02-06T11:59:15Z,2020-02-07T11:21:11Z,2020-02-07T11:21:11Z,1,4,3,"Summary of the Pull Request
Don't send WM_QUIT message for PowerRename local COM server to prevent its shutdown. Detailed discussion is in the issue. Also avoid unnecessary dynamic allocation during the server start to reduce the first time lag.

PR Checklist

 Applies to #1197

Validation Steps Performed

PowerRename GUI window is functional
no lag is observed except for the first time the COM server is loaded (hard to avoid)",2,0
1223,2020-02-06T13:51:09Z,2020-02-06T17:04:11Z,2020-02-06T17:04:11Z,6,60,197,"Summary of the Pull Request
The cache was introduced to improve performance by not querying the OS for the window process path every time we need to check if the window is interesting to FancyZones. Since then other changes where made to the way we check the windows. Right now, the IsInterestingWindow function is called when:

WinKey + arrows are used
window is started to be dragged
window is created

1 and 2 are initiated by the user, happen only once per interaction so their performance impact can be dismissed. The 3) happens all the time, but for the most part the check for WS_CHILD or GetAncestor(window, GA_ROOT) == window will filter those out. In the end only top-level windows will be queried for their path.
Removing the cache improves code readability and will make code maintenance easier.
This PR only refactored the code used to filter the windows. It moved the logic from hwnd_data_cache to the get_filtered_base_window_and_path only dropping the caching of the executable path.

PR Checklist

 Applies to #1187
 CLA signed.

Validation Steps Performed
Unit tests.
Tested with GOG Galaxy, Notepad and its Save As.. dialog, XYeplorer and TaskView. In all cases, FZ behaved as the current master.",3,1
1225,2020-02-06T16:28:44Z,2020-02-07T14:53:58Z,2020-02-07T14:53:58Z,6,96,61,"Summary of the Pull Request
(This requires that #1223 lands first, relevant changes are in this commit) (edit: PR landed)
Splits the code use to filter windows for FancyZones and the ""active window"" for the ShortcutGuide. The FancyZones logic is preserved and merged into a single function. We keep it in common.h, as it might be also used in other PowerToys, like maximized to new desktop. We do however change the return type to be more descriptive. It also returns a separate flag for if the window has a visible owner. This can be used to implement the approved apps list.
For the ShortcutGuide, the logic is relaxed to include more windows. One example are Explorer properties windows. Those are (and should) filtered by the FancyZones, but should appear in the window preview in the SCG.
The new return type also includes information if the window will react to the default Windows Snap. This is not ideal though. Currently, SCG can only disable the entire ""Windows Controls"" group. OTOH windows like ""Save As..."" dialogs can be snapped to corners etc., but cannot be minimized nor maximized. Until SCG can separately disable those buttons we will display the buttons in the enabled state only if the window supports all settings. In the future, we should integrate FancyZones snap override here too.
PR Checklist

 Applies to #1187
 CLA signed.

Validation Steps Performed
Manual. Tested with GOG Galaxy, Notepad and its Save As.. dialog, XYeplorer and TaskView. In all cases, FZ behaved as the current master. SCG displays correctly Explorer properties windows.",2,0
1230,2020-02-06T20:55:23Z,2020-02-07T23:38:34Z,2020-02-07T23:38:34Z,13,416,143,"Summary of the Pull Request
This task is meant to implement the methods that enable and disable preview handlers. The approach used adds and removes the Registry Keys in the CURRENT USER key to disable and enable preview handlers.
 
References
About the Registry: https://docs.microsoft.com/en-us/windows/win32/sysinfo/structure-of-the-registry

PR Checklist

 Applies to #914
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
This task is meant to implement the methods that enable and disable preview handlers. The approach used adds and removes the Registry Keys in the CURRENT USER key to disable and enable preview handlers.

Validation Steps Performed

Added Unit Tests.
Verified that registry entries were added/removed and that the preview handler was rendering/no-rendering after settings were changed.",5,0
1231,2020-02-06T22:46:48Z,2020-02-12T02:30:37Z,2020-02-12T02:30:37Z,9,586,30,"Summary of the Pull Request
Removing the Script and Image  Element from the previewing Svg to avoid loading images or run scripts from unknown resources. In case of script or image element is found an information bar will be shown on the top of the preview.

 
References

PR Checklist

[ x ] Applies to #963
[ x ] Tests added/passed


Validation Steps Performed
Tests passed and validated changes locally.",5,0
1237,2020-02-07T19:39:42Z,2020-02-07T22:22:50Z,2020-02-07T22:22:50Z,1,3,0,"Summary of the Pull Request
The MSIX installer Readme is missing the step of enabling sideloaded apps under the Developer Options. Adding this to the Readme so that the steps can be followed without any errors.
Failing to enable Sideload apps/Developer mode results in this error:
Add-AppxPackage : Deployment failed with HRESULT: 0x80073CFF, To install this application you need either a Windowsdeveloper license or a sideloading-enabled system.
Deployment of package Microsoft.PowerToys_0.15.0.0_x64__8wekyb3d8bbwe with package origin Unknown failed because no valid license or sideloading policy could be applied. A developer license (http://go.microsoft.com/fwlink/?LinkId=233074) or enterprise sideloading configuration (http://go.microsoft.com/fwlink/?LinkId=231020) may be required.
NOTE: For additional information, look for [ActivityId] 93449567-d863-0006-1e2f-529363d8d501 in the Event Log or use the command line Get-AppPackageLog -ActivityID 93449567-d863-0006-1e2f-529363d8d501

At E:\Power_toys\PowerToys_master\installer\MSIX\msix_reinstall.ps1:9 char:1
+ Add-AppxPackage .\bin\PowerToys.msixbundle
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ CategoryInfo          : NotSpecified: (E:\Power_toys\P...Toys.msixbundle:String) [Add-AppxPackage], Exception
+ FullyQualifiedErrorId : DeploymentError,Microsoft.Windows.Appx.PackageManager.Commands.AddAppxPackageCommand""",3,0
1248,2020-02-10T11:40:51Z,2020-02-18T15:11:02Z,2020-02-18T15:11:02Z,19,747,35,"Summary of the Pull Request

refactor and simplify getting a system error message string (also the previous version wasn't working due to lpMsgBuf instead of &lpMsgBuf usage)
rename ""PowerToys.exe"" executable to ""Power Toys.exe"" to fix the self-terminating issue described in that comment
start a thread which checks for the current MSI PT installation by its upgrade code and prompts its uninstallation
prompt dialog has a ""don't show again"" tick and won't be shown if no installed MSI is detected
uninstallation result is shown as a toast


PR Checklist

 Applies to #1131

Validation Steps Performed

Launched PT from MSIX and uninstalled MSI PT",2,5
1249,2020-02-10T11:50:35Z,2020-02-10T13:07:02Z,2020-02-10T13:07:02Z,1,24,0,"Summary of the Pull Request
fix project dependency order

PR Checklist

 Applies to #1247

Validation Steps Performed

performed a clean rebuild 2 times",2,0
1257,2020-02-10T17:21:23Z,2020-02-11T11:34:38Z,2020-02-11T11:34:38Z,2,3,2,"Summary of the Pull Request
Settings with app history, device info and custom zonesets are saved every time changes are performed.

PR Checklist

 Applies to #1253
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Validation Steps Performed
manual testing",3,0
1258,2020-02-10T18:38:17Z,2020-02-13T22:09:13Z,2020-02-13T22:09:13Z,12,433,351,"Summary of the Pull Request
This PR rewrites the settings handler in ImageResizer to store the settings in JSON instead of the default XML config files created by the ApplicationSettings class.
The format of the file has been made to match the json format used by other powertoys so that shifting to the PowerToys C++ settings in the future will not be a breaking change.

PR Checklist

 Applies to #1124
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments\

Removed the Settings.Designer.cs autogen file and Settings.settings
Moved all the settings from settings.designer.cs as properties in Settings.cs
Implemented Save and Reload functions for JSON file read/writing
Added thread safety for JSON file access
Added tests for Reload/Save methods and PropertyChanged behavior
Added Newtonsoft.Json.dll to the MSI/MSIX installer
Fixed dll folder locations in PackagingLayout.xml. (Earlier set to x64/Release which contained the dlls from the test project. Changed to x64/Release/modules which has the dlls for the correct project).


Validation Steps Performed

Added Reload_createsFile_when_FileNotFound, Save_creates_file, Save_json_is_readable_by_Reload and Reload_raises_PropertyChanged tests
Tried without settings.json file and with json file in correct format. Tried changing each of the settings in the settings menu.
Installed with MSIX and verified functionality.",4,4
1259,2020-02-10T18:53:09Z,2020-02-11T06:57:11Z,2020-02-11T06:57:11Z,4,29,17,"Summary of the Pull Request
After powertoy module is disabled we need to make sure that no crash occurs when user tries to change settings of disabled powertoy.

PR Checklist

 Applies to #1250


Validation Steps Performed

Disable any of the available powertoys.
Change settings of disabled powertoy.

Expected result: Nothing happens (no crash occurs).",3,7
1261,2020-02-10T22:42:12Z,2020-02-11T20:52:27Z,2020-02-11T20:52:27Z,4,31,10,"Summary of the Pull Request
Shifted out hardcoded strings in the dllmain file, namely the module name and description, to the rc file. Added the resource dlls for the .NET UI to the MSIX installer. It hasn't been added to the MSI installer since its deprecated.
Since the description has not been decided it yet, it has been temporarily set to Lorem Ipsum.

PR Checklist

 Applies to #53, #199
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Removed hardcoded MODULE_NAME and MODULE_DESC strings and moved it to the rc and resource.h file.
For localization to work in .NET applications the resource.dll file needs to be available. For ImageResizer.exe, ImageResizer.resources.dll is generated for each language add build time under modules/$lang/ImageResizer.resources.dll, where $lang is the language ID. If these files are available, then if the Windows display language is changed, the localized strings in the .NET UI are also loaded.
This requires the language folders to be added at the time of installation. For this it has been added in the PackagingLayout.xml file for MSIX installer.


Validation Steps Performed
Verified by changing language to French(fr) and Basque(eu-ES).",3,3
1263,2020-02-11T00:46:06Z,2020-02-13T19:53:27Z,2020-02-13T19:53:27Z,9,106,118,"Summary of the Pull Request
This task is intended to implement best practices (string return types should be const and use pass by const reference on objects we do not need to modify) for the common settings objects class.
DoD:
The methods in settings_objects.h/cpp that needs to return const and pass by reference now do so.
Corresponding changes are made to affected PowerToys that fail tests after the impact of the changes.
Changes merged in dev/previewPane.
 
References

PR Checklist

 Applies to #963
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed

Ran all tests.
Verified that all settings for PowerToys are working ( tested them manually)",3,0
1265,2020-02-11T10:16:10Z,2020-02-11T11:33:41Z,2020-02-11T11:33:42Z,3,10,26,"Summary of the Pull Request
Fixed warnings, removed unneeded tests

PR Checklist

 Applies to #1267",2,0
1268,2020-02-11T11:41:24Z,2020-02-12T10:08:12Z,2020-02-12T10:08:12Z,1,15,1,"Summary of the Pull Request
Added settings values to Trace::SettingsChanged

PR Checklist

 Applies to #1251",2,2
1269,2020-02-11T16:22:59Z,2020-02-12T10:03:41Z,2020-02-12T10:03:41Z,5,114,32,"Summary of the Pull Request
Added telemetry event on applying general settings. Updated runner launch event with elevated value.

PR Checklist

 Applies to #1252",2,1
1270,2020-02-11T18:13:43Z,2020-02-12T07:18:58Z,2020-02-12T07:18:58Z,1,17,0,Design change request for improvements in virtual desktops creating/deleting behavior.,3,0
1272,2020-02-11T20:07:38Z,2020-02-19T19:47:33Z,2020-02-19T19:47:34Z,7,114,39,"Summary of the Pull Request
Added tracelogging telemetry to the ImageResizerExt cpp project. The following tracelog telemetry functions were added based on PowerRename:

EnableImageResizer - To log if a user enables/disables ImageResizer
Invoked - To log if a user clicks the Resize pictures option in the right click menu
InvokedRet - To log when the Resize pictures operations returns and logs the HRESULT success/error code of the operation.

The set_config and init_settings functions were made empty as the save/load from json option is not being done on the C++ side for ImageResizer. All the JSON settings are being handled on the C# side.

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA",4,0
1275,2020-02-12T00:04:36Z,2020-02-18T17:27:01Z,2020-02-18T17:27:01Z,1,133,0,"This is what we'll be planning for v1.  This is one of two parts to resolve #932 for roadmap.  The second half is the workback schedule.  We want to ship the v1.0 in the 2nd half of 2020 which is the scoping lens we applied.
easy to view link
I'll be adding in linking issues to item here but wanted to get it in front of our community.  The extended PowerToy team has seen this.
We'll close this for feedback on 2020.02.17",2,3
1276,2020-02-12T00:06:08Z,2020-02-12T22:55:40Z,2020-02-12T22:55:40Z,28,12,822,Moving the spec to the wiki area.  Goal is to clean up the main repository a bit as we are using more and more images in the spec,2,0
1279,2020-02-12T14:31:17Z,2020-02-13T09:44:04Z,2020-02-13T09:44:04Z,5,27,5,"Summary of the Pull Request
Add telemetry event after PowerRename settings are changed

PR Checklist

 Applies to #1255",2,0
1280,2020-02-12T15:25:38Z,2020-02-12T18:06:16Z,2020-02-12T18:06:16Z,1,3,2,,2,0
1281,2020-02-12T16:38:12Z,2020-02-17T15:28:49Z,2020-02-17T15:28:50Z,10,1472,1374,"Summary of the Pull Request

add a recursive mutex to FanncyZonesData to protect it from possible crashes
refactor unit tests, since FanncyZonesData isn't implicitly copyable now because of the mutex
format the sources as a separate commit

Please see the first commit diff for a convenient navigation.
 
References

PR Checklist

 Applies to #1246

Validation Steps Performed

all unit tests passed
launched fancyzones/editor from VS context",4,1
1282,2020-02-12T16:38:37Z,2020-02-17T15:38:15Z,2020-02-17T15:38:15Z,3,10,2,"Summary of the Pull Request

Use AttachThreadInput to be able to workaround the SetForegroundWindow bug. More info is in the issue. The same fix could be also applied to ImageResizer and other context menu tools.
Do not kill explorer for MSIX (separate commit)


PR Checklist

 Applies to #1039


Validation Steps Performed
As described by Raymond Chen, the main issue with attaching the input queue of another application, is that our thread could hang with the application we've attached to. To aid testing, I've developed a small test application which works in tandem with PowerRenameExt:

it locks a named mutex when launched
PowerRenameExt waits for this mutex to be unlocked until I've pressed a button in small application window: it stops the message pump loop (now we've ""stopped responding"") and unlocks the mutex. Pressing the button also brings the test app to the foreground.
PowerRenameExt attaches itself to the foreground thread from a different thread, which is killed after 10 seconds in case of hanging.

Actually, I've observed that even though I didn't process intentionally any messages in the test app, PowerRename didn't hang. Even though, we create a separate thread just in case. In the worst case scenario, we'll just remain in the background.",3,2
1287,2020-02-12T19:58:52Z,2020-02-13T18:55:01Z,2020-02-13T18:55:01Z,22,877,4,"Summary of the Pull Request
Create a base PowerToys PowerLauncher project as in the PowerToys_Example project. This should contain an empty PowertOToys module that implements the PowerToys Module Interface with empty settings and empty test project.
DoD:
We have a C++  PowerLaunchy Dummy Project.
PowerLauncher now shows in PowerToys Settings.
We have a test Project for PowerLauncher.
The Code is reviewed and in feature branch.
 
References

PR Checklist

 Applies to #44
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #44


Validation Steps Performed

Ran all tests and verified output in the UI.",3,0
1290,2020-02-13T01:23:04Z,2020-02-13T19:34:55Z,2020-02-13T19:34:55Z,24,824,1,"Summary of the Pull Request
This PR is intended to add an empty project to PowerToys.  Since the Project might contain a lot of files, this will not be integrated into PowerToys settings yet.
Out of Scope
Intergration into PowerToys settings.
Launching with Keyboard shortcut.
UI Components.
DoD:
We have a project for the PowerLancher add to the PowerToys solution.
We have a test project for the Fluent UI project.
Codebase reviewed and in feature branch.
 

PR Checklist

 Applies to #44
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx



Validation Steps Performed
The solution builds without any errors. Manually validated.",2,0
1293,2020-02-13T14:02:08Z,2020-03-05T09:57:45Z,2020-03-05T09:57:45Z,1,3,0,"Fixed an issue (#365) where a window gets resized after it gets dropped into a zone.

Summary of the Pull Request
This was tested manually in the same scenario described in the issue.
 
References

PR Checklist

[] Applies to #365
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Tested manually and compared to the version without this commit. I verified that calling the API twice doesn't have side effects on regular windows that snap correctly the first time.",5,6
1294,2020-02-13T16:55:39Z,2020-02-17T16:40:03Z,2020-02-17T16:40:03Z,4,96,3,"Summary of the Pull Request
Added telemetry on zone settings change event

PR Checklist

 Applies to #1254",3,1
1296,2020-02-13T17:31:49Z,2020-02-18T10:55:08Z,2020-02-18T10:55:08Z,3,101,54,"Summary of the Pull Request
Deletion/Creation of virtual desktops need to be reflected on state of our json storage immediately, therefore we need better handling of virtual desktop updates. Improve existing tracker of virtual desktops so that we track actual work area, which is uniquely defined by virtual desktop identifier and monitor on which is located. With this improvement, at the moment of creation of ZoneWindow object (which represents single work area) we have precise information is it new or already processed work area and we can act accordingly (flash zones, save data to storage or not etc.).

PR Checklist

 Applies to #878",5,0
1298,2020-02-13T19:05:46Z,2020-02-14T08:57:21Z,2020-02-14T08:57:21Z,2,14,2,"Summary of the Pull Request

include assembly redirects for FancyZonesEditor
include new dependent assemblies for FancyZonesEditor after migrating to json
update System.Text.Json dependency


PR Checklist

 Applies to #1295


Validation Steps Performed
Played with the editor from MSIX",3,0
1299,2020-02-13T23:05:06Z,2020-02-14T20:08:33Z,2020-02-14T20:08:33Z,8,193,38,"Summary of the Pull Request
Added Telemetry base class to use in preview pane C# project and added telemetry events in preview pane.

PR Checklist

 Applies to #914


Detailed Description of the Pull Request / Additional comments

Added telemetry event when markdown is previewed and if markdown preview has errors.
Added error bar on top of preview window when preview fails.",3,0
1302,2020-02-14T18:59:54Z,2020-02-14T21:49:32Z,2020-02-14T21:49:32Z,33,0,418,https://github.com/microsoft/PowerToys/wiki/Launcher,2,0
1303,2020-02-14T20:22:58Z,2020-02-14T23:34:06Z,2020-02-14T23:34:06Z,2,12,13,"Summary of the Pull Request

Fixed bug with html display going out of screen.
Replaced XDocument with HTMLAgilityPack since XDocument wasn't able to process uncompleted html tags.


PR Checklist

 Applies to #914",2,0
1308,2020-02-17T10:11:56Z,2020-03-10T22:23:36Z,2020-03-10T22:23:36Z,1,16,49,"Summary of the Pull Request
This pull request fixes the bug described in #1307
 
References

PR Checklist

[] Applies to #1307
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place:


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Tested manually in several tricky scenarios.",6,10
1309,2020-02-17T12:38:08Z,2020-03-05T15:00:19Z,2020-03-05T15:00:19Z,1,1,0,"Summary of the Pull Request
Fixed issue #857
It's just one line of code
 
References

PR Checklist

[] Applies to #857
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place


Detailed Description of the Pull Request / Additional comments
Nothing too smart going on here

Validation Steps Performed
Tested on scenarios where the previous version did not work, now it works as one might expect.",3,0
1313,2020-02-18T15:21:15Z,2020-02-18T21:02:40Z,2020-02-18T21:02:40Z,1,1,0,"Summary of the Pull Request
PowerRenameExt.dll was not signed during the release build.

PR Checklist

 Applies to #826


Validation Steps Performed
Built on the internal pipeline (pending).",2,0
1314,2020-02-18T16:41:43Z,2020-02-19T02:48:26Z,2020-02-19T02:48:26Z,6,140,18,"Summary of the Pull Request
Added telemetry events for Svg Preview Handler by using the TelemetryBase added in the PR #1299

PR Checklist

[ x ] Applies to #963


Detailed Description of the Pull Request / Additional comments

Added telemetry events for successfully Svg Preview and error message in case of failed preview.
Added a textbox to show the error message in case of preview failed.


Validation Steps Performed

Validate the events using Wpr and Wpa as mentioned here.",1,0
1317,2020-02-18T18:53:03Z,,2020-02-20T01:03:10Z,208,25169,3085,"Summary of the Pull Request
 
References
Merging the PowerToys Master into dev/previewPane for latest changes. Which are required for enabling MSIX installation for Preview Handlers.

PR Checklist

[ x ] Applies to #963 and #914

Validation Steps

Build and run the Solution. Install powertoys with MSIX.
Validate the preview handlers are working without MSIX",18,3
1319,2020-02-18T19:42:35Z,2020-02-21T01:02:29Z,2020-02-21T01:02:29Z,14,301,544,"Summary of the Pull Request
Currently adding a preview hanlder requires making changes to alot of places in the codebase. This task is intended to reduce the number of tasks needed to be done to add a preview handler.
 
References

PR Checklist

 Applies to #963 and #914
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #963 and #914


Validation Steps Performed

Ran tests and verified output on the UI.",3,0
1321,2020-02-19T00:52:29Z,,2020-02-20T16:13:13Z,224,25257,3338,"Summary of the Pull Request
Adding MSIX installation for Preview Handlers.
Known Issue:

Current change is not working for .svg file type. It works perfectly fine by changing the file extension of Svg file to .svk(Made up extension type).

Additional commit changes from Syncing the master will be removed after completing this PR.

PR Checklist

 Applies to #963 and #914


Detailed Description of the Pull Request / Additional comments
Changes Included:

Updated appxmanifest.xml to include Preview Handler for Svg and Markdown.
Added logic to to shim the activation of .Net Assembly from native dll in powerpreview.dll.
Added a registry.dat file to Installer for having HKLM/Software/Classes/CLSID/{} key entry for both handlers and key for using IE11 for prevhost.exe.
Updated the PackageLayout.xml to output the managed dll's in VFS path equivalent to Global assembly cache.


Validation Steps Performed

Install Powertoys with MSIX and use the Markdown Handler.",17,7
1328,2020-02-19T14:50:18Z,2020-02-19T15:51:25Z,2020-02-19T15:51:25Z,2,4,8,"Summary of the Pull Request

do not show ""Restart as user"" button, only the ""Restart as administrator"" one


PR Checklist

 Applies to #1325


Validation Steps Performed

restart PT as elevated and verified that the button is not there.",2,0
1335,2020-02-20T06:53:44Z,,2020-03-04T10:19:15Z,8,151,62,"Summary of the Pull Request
 
References

PR Checklist

 Applies to #607


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,2
1339,2020-02-20T16:07:12Z,2020-02-26T20:10:13Z,2020-02-26T20:10:13Z,22,114,248,"Summary of the Pull Request
Adding MSIX installation for Preview Handlers.
Known Issue:

Current change is not working for .svg file type. Preview for Svg works by settings the PowerToys as default application for svg file type.


PR Checklist

 Applies to #963 and #914


Detailed Description of the Pull Request / Additional comments
Changes Included:

Updated appxmanifest.xml to include Preview Handler for Svg and Markdown.
Added logic to to shim the activation of .Net Assembly from native dll in powerpreview.dll.
Added a registry.dat file to Installer for having HKLM/Software/Classes/CLSID/{} key entry for both handlers and key for using IE11 for prevhost.exe.
Updated the PackageLayout.xml to output the managed dll's in VFS path equivalent to Global assembly cache.


Validation Steps Performed

Install Powertoys with MSIX and use the Markdown Handler.",3,6
1350,2020-02-21T15:51:35Z,2020-02-26T20:06:45Z,2020-02-26T20:06:45Z,29,754,43,"Summary of the Pull Request

add a worker thread which periodically (currently once per 24h) checks if there's a new release available on GitHub
it checks if the current version string, obtained with get_product_version(), isn't equal to the tag_name (the actual git tag) from the latest release obtained using GitHub API, so we must be VERY CAREFUL when submitting stuff on /releases pages, because users will always be getting a notification if the tag doesn't match
if a new version is found, we offer a user to go to its download page, e.g. for v0.14.1
the last time we've checked for updates or showed a user the update dialog is tracked in a separate file at %localappdata%\Microsoft\PowerToys\update_state.json to not mix it with general settings and be able to save/load it safely anytime
VERSION_BUILD isn't used in get_product_version anymore, also it now returns a version prepended with 'v' to much with git tags notation we have so far (e.g. v0.14.1). We still have another zero in PRODUCTVERSION/FILEVERSION macros to make WinAPI happy

Once we've added support for toast notifications in non-packaged applications, we can use a toast instead.

PR Checklist

 Applies to #696

Validation Steps Performed

launched (non-)packaged PTs and played w/ values from update_state.json file

Screenshot",5,11
1358,2020-02-24T16:29:26Z,2020-02-24T22:49:29Z,2020-02-24T22:49:29Z,12,155,20,"Summary of the Pull Request
Update the config files for the CDPx pipeline to:

use the latest Windows 10 SDK
restore telemetry without requiring the projects to reference the nuget package
build and sign the MSIX bundle

 
References
Part of the work for #413

PR Checklist

 Applies to #1356 & #1357


Validation Steps Performed
Tested individual scripts locally.",3,11
1361,2020-02-25T17:18:38Z,2020-03-09T21:20:58Z,2020-03-09T21:20:58Z,3,10,11,For #1359 text adjustments before we start doing #1032,3,0
1362,2020-02-25T18:25:12Z,2020-02-25T20:03:15Z,2020-02-25T20:03:15Z,1,5,0,"Summary of the Pull Request
Don't pass SHIFT keyboard press to other applications in chain when dragging window (and shift+drag option enabled in PowerToys).

PR Checklist

 Applies to #1141


Validation Steps Performed

Turn on FancyZones setting: Hold Shift key or any non-primary mouse button to enable zones while dragging
Open Google Chrome.
Press shift key and drag on of the opened tabs outside of main window.

Expected result: Zone hints are displayed and tab can be taken out of the main window and put to certain zone.",3,4
1363,2020-02-25T23:31:44Z,2020-02-26T07:11:40Z,2020-02-26T07:11:40Z,1,0,5,Revert until 0.15 is released (applies to #1141),2,0
1364,2020-02-26T02:14:17Z,2020-02-26T03:38:48Z,2020-02-26T03:38:48Z,1,1,1,"Summary of the Pull Request
Update the internal nuget feed used to restore the telemetry header.

PR Checklist

 Applies to #1357


Validation Steps Performed
Manually tested the .pipelines/restore-telemetry.cmd script and verified that the packaged is downloaded and the header copied to its final destination.",2,0
1368,2020-02-26T16:35:56Z,2020-02-28T19:14:22Z,2020-02-28T19:14:22Z,11,333,256,"Summary of the Pull Request
Customize the Web Browser Control to handle DISPID_AMBIENT_DLCONTROL to block images, scripts and other external component.
More details:
https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770041(v=vs.85)?redirectedfrom=MSDN#controlling-download-and-execution
Current PR is build on top of an existing PR.
Changes:

Added an implementation of WebBrowserExt to set flags for securing the preview with Web Browser Control.
Removed the implementation of removing <image> and <script> tags. As it will be handle by the control itself.


PR Checklist

 Applies to #963
 Tests added/passed


Validation Steps Performed
Successfully run and validate the Svg Preview Handlers to block images and scripts.",2,0
1369,2020-02-26T16:53:45Z,2020-02-26T20:34:06Z,2020-02-26T20:34:06Z,1,2,2,"Summary of the Pull Request
The Windows Store was renamed to the Microsoft Store back in 2017, best to keep things up-to-date to avoid potential confusion.

PR Checklist

 CLA signed.",2,0
1371,2020-02-26T18:08:26Z,2020-03-17T15:03:03Z,2020-03-17T15:03:03Z,10,1519,17,"Summary of the Pull Request
initial project for WinAppDriver tests

PR Checklist

 Applies to #846",3,1
1372,2020-02-26T18:08:54Z,2020-02-26T20:21:19Z,2020-02-26T20:21:19Z,3,6,6,"bump the version for MSI and updating logic
MSIX uses 0.15 already",2,1
1374,2020-02-26T19:26:56Z,2020-03-08T00:28:54Z,2020-03-08T00:28:54Z,2,11,22,"Summary of the Pull Request
Does what the title says, really. This was the last C# project that still used packages.config. The remaining users of this file are all C++ projects (which don't support PackageReference), and the WiX custom action project (which I understand is deprecated and will be removed soon).
PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed (none required)
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan.

Validation Steps Performed
Built and ran WindowWalker, program launches and is functional.",2,3
1375,2020-02-26T20:19:23Z,2020-02-27T08:52:15Z,2020-02-27T08:52:15Z,1,1,0,Improvement: We were missing mutex guard inside RemoveDevicesByVirtualDesktopId.,3,1
1378,2020-02-26T22:52:16Z,2020-02-27T00:33:51Z,2020-02-27T00:33:51Z,1,1,1,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
1381,2020-02-27T00:55:29Z,,2020-03-17T11:52:43Z,6,79,39,"Summary of the Pull Request
Enhancement: FancyZones - Display zone numbers #1085 and Fixed: Design Change: Default Enter Action #1218
 
References

PR Checklist

 Applies to #1085 and #1218
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",5,10
1384,2020-02-27T05:01:03Z,2020-02-27T12:10:09Z,2020-02-27T12:10:09Z,1,2,2,Adding preview tag from #1383,2,0
1385,2020-02-27T05:01:47Z,2020-03-04T20:37:33Z,2020-03-04T20:37:33Z,2,7,3,"couldn't get it to load, based on an email from @enricogior and @betsegaw this seemed to fix it
note this is for 0.16",2,0
1387,2020-02-27T07:15:48Z,2020-02-27T08:28:00Z,2020-02-27T08:28:00Z,1,10,0,"PR Checklist

 Applies to #1379


Validation Steps Performed
Launched the FZ editor on a clean win10 VM after installing the msi",2,0
1388,2020-02-27T10:22:26Z,2020-04-10T09:16:00Z,2020-04-10T09:16:00Z,2,6,0,"Summary of the Pull Request
Added icon for FZeditor

PR Checklist

 Applies to #928


Validation Steps Performed
Manually tested",4,3
1397,2020-02-27T19:53:37Z,,2020-02-27T21:30:18Z,1,5,2,"Trying to force signing for MSIX

Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,1
1405,2020-02-28T17:46:07Z,2020-03-07T09:59:01Z,2020-03-07T09:59:01Z,2,13,13,"PR Checklist

[] Applies to #693",2,0
1407,2020-02-28T19:53:09Z,2020-02-28T21:44:37Z,2020-02-28T21:44:38Z,1,15,1,"Summary of the Pull Request
Archive symbols to Microsoft Symbol Server.
Need to verify if it's ok to have the name: 'Archive symbols to Symbol Server' tag since in the documentation example it's not present.

PR Checklist

 Applies to #1406",2,0
1408,2020-02-28T22:32:41Z,2020-03-03T19:14:31Z,2020-03-03T19:14:31Z,2,144,93,update for 0.15.  Readme and update to the devdocs main readme.,3,2
1412,2020-03-02T16:40:47Z,2020-03-03T00:21:52Z,2020-03-03T00:21:52Z,1,16,13,"Docs say MSI is deprecated, not true currently.",2,0
1419,2020-03-03T15:54:29Z,2020-03-08T00:25:13Z,2020-03-08T00:25:13Z,1,7,14,"Summary of the Pull Request
pClassFactory is always created as per the ""new"" statement in C++. Why are we checking for the object then?
 
References

PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
Removed unneeded check

Validation Steps Performed
Manual
Automated",2,2
1421,2020-03-03T18:15:41Z,2020-03-03T23:57:05Z,2020-03-03T23:57:05Z,216,26994,3014,"Summary of the Pull Request
This PR pulls the latest changes from master to the dev/imageResizer branch.

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed

Built release x64 and installed with MSIX to verify all PowerToys were working. Also ran tests.

Note: After installing with MSIX explorer.exe will have to be restarted from Task Manager or you have to reboot/sign out for the shell extensions to get loaded. This is because of the change to the MSIX installer in master and this is tracked in #1326",19,5
1423,2020-03-03T19:58:43Z,2020-03-05T07:01:58Z,2020-03-05T07:01:58Z,1,5,0,"Summary of the Pull Request
Don't pass SHIFT keyboard press to other applications in chain when dragging window (and shift+drag option enabled in PowerToys).

PR Checklist

 Applies to #1141


Validation Steps Performed

Turn on FancyZones setting: Hold Shift key or any non-primary mouse button to enable zones while dragging
Open Google Chrome.
Press shift key and drag on of the opened tabs outside of main window.

Expected result: Zone hints are displayed and tab can be taken out of the main window and put to certain zone.",2,0
1424,2020-03-03T20:03:58Z,2020-03-05T09:21:26Z,2020-03-05T09:21:27Z,7,127,46,"This fixes PowerRename not handling DPI changes (either moving it from one monitor to another - with different DPI, or live DPI change on single monitor while PowerRename is opened)

PR Checklist

[] Applies to #775",5,1
1432,2020-03-03T23:51:03Z,2020-03-04T04:52:17Z,2020-03-04T04:52:17Z,4,5,5,"Summary of the Pull Request
Updating the version to start the work towards 0.16.0",2,0
1434,2020-03-04T00:29:31Z,2020-03-05T17:19:53Z,2020-03-05T17:19:53Z,3,288,193,"Summary of the Pull Request
Implemented the fix for the foreground issue (#1273) using the same approach that @yuyoyuppe used in #1282, however in case of ImageResizer the UI is in WPF so it required using the Win32 functions from user32.dll. For this a Win32Helpers.cs file was added which contains the win32 functions required for this fix.
Also added a comment to cross reference the code with this issue so that it can be removed later once resolved externally.

PR Checklist

 Applies to #1273
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed

Build Release x64 and install the MSIX build.
It was harder to verify that the fix works for ImageResizer as earlier the issue what happen sometimes but not always like how PowerRename did. This was probably because ImageResizer was launched in a separate process using its executable from the Shell Extension.
I tried right-click launching resize pictures >10 times and all those times it was in the foreground. The best case which can be used to reproduce the issue in the original code is to open a file explorer window across two monitors with a larger part in the second monitor (so it appears in the taskbar of the second monitor) and then open the context menu. This had a higher chance of replicating the issue.",2,0
1436,2020-03-04T01:01:03Z,2020-03-04T23:48:25Z,2020-03-04T23:48:25Z,1,76,0,"Summary of the Pull Request
Adding MSI installation support for Preview Handlers. Added all the registry changes required under HKEY_CURRENT_USER.  Used two separate Component for Preview Handler one for copying the dll and one for updating Registry under Current_User. Unable to do that in a single component because of ICE57 error.

PR Checklist

 Applies to #963


Validation Steps Performed

Installed and validated Preview Handlers with MSI.",4,4
1439,2020-03-04T09:28:30Z,2020-03-05T14:52:22Z,2020-03-05T14:52:22Z,10,89,67,"Summary of the Pull Request

introduce Version.props so we don't have to specify version in so many places
rename PowerToys-x64.msix to PowerToys-<VERSION>-x64.msix on CI. this won't be required once #1021 is resolved
generate assemblyinfo.cs for FZ Editor

Using a update_appxmanifest_version.ps1 will be required also until #1021 is resolved, because appxmanifest.xml schema doesn't have usual msbuild capabilities

PR Checklist

 Applies to #870 #1040


Validation Steps Performed

rebuilt msi/msix artifacts locally",2,2
1441,2020-03-04T10:08:06Z,2020-03-05T10:07:07Z,2020-03-05T10:07:07Z,42,2569,2187,"Summary of the Pull Request

format common folder
move source formatting-related files according to #939
format leftovers in runner & settings projects
format_sources: exclude 3rd party sources

 
References

PR Checklist

 Applies to #939",2,0
1443,2020-03-04T10:43:14Z,2020-03-05T07:41:38Z,2020-03-05T07:41:38Z,1,2,64,"Summary of the Pull Request
remove code duplication

PR Checklist

 Applies to #1367

Validation Steps Performed

launched powerrename from MSIX context",2,0
1448,2020-03-04T21:37:24Z,2020-03-05T17:16:31Z,2020-03-05T17:16:31Z,1,86,41,"Summary of the Pull Request
This PR adds the resources.dll files for each language in the MSI installer. For example the Imageresizer.resources.dll for french is stored in modules\fr\ImageResizer.resources.dll as this is the location recognized by the C# executable. A similar step will have to be done for FancyZonesEditor when it is translated (@crutkas note this would be needed later on for #199 for any C# projects. ImageResizer already has almost all the strings translated).

This PR also changes the ImageResizer registry entries to HKCU so that they are installed per user instead of per machine.


PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Build Release x64 of PowerToys and PowerToysSetup and install using MSI.
After verifying the ImageResizer works by right-clicking an image in file explorer, switch the OS language to another language in this list (ar;bg;ca;cs;de;es;eu-ES;fr;he;hu;it;nb-NO;nl;pl;pt-BR;ru;sk;tr;zh-Hans) and sign out and back in. ImageResizer should now show the translated UI.",4,6
1452,2020-03-04T22:53:22Z,2020-03-05T17:14:17Z,2020-03-05T17:14:17Z,2,4,2,"Summary of the Pull Request
Set the WindowStartupLocation flag for both the Main Window and the settings window to CenterScreen. This also fixed the MSIX issue of launching only on the primary monitor (#1096) as CenterScreen sets the location to center of the screen which contains the mouse cursor.
 
References

https://stackoverflow.com/questions/1545258/changing-the-start-up-location-of-a-wpf-window


PR Checklist

 Applies to #1435
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed

Installed and verified with MSIX and MSI.",3,1
1455,2020-03-05T01:35:36Z,2020-03-05T23:53:00Z,2020-03-05T23:53:00Z,20,1475,2,"Summary of the Pull Request
Contains code for remap keyboard, two key shortcuts at os level and app specific shortcuts.
Also contains basic WinUI with Cpp/winrt code

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA
 Tests passed",2,1
1456,2020-03-05T01:41:29Z,2020-03-05T18:21:51Z,2020-03-05T18:21:51Z,1,6,0,"Summary of the Pull Request
Updated logic to call Garbage Collection on unloading of the preview to mitigate the issue with Web browser control not disposing properly and the prevhost.exe is not exiting on closing the File explorer.

PR Checklist

 Applies to #963
 Applies to #1468


Validation Steps Performed
Validated the PreviewHandlers with MSI installation. There are no significant effect on performance of loading a new preview.",2,0
1458,2020-03-05T10:54:43Z,2020-03-05T14:54:06Z,2020-03-05T14:54:07Z,2,44,32,"Summary of the Pull Request
This fixes #1453 and also #286.
 
References

PR Checklist

 Applies to #1453
 CLA signed.
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
The code no longer assumes even divisibility and also no longer assumes that all zones must have equal width/height.

Validation Steps Performed
Tested manually in scenarios where effective screen width/height is not evenly divisible by the number of columns/rows.",5,2
1464,2020-03-05T16:25:51Z,2020-03-05T18:22:49Z,2020-03-05T18:22:49Z,4,25,50,"Summary of the Pull Request
Update the Markdown previewer to use WebBrowserExt which is implementing in this PR. To block external content to load and run on the WebBrowser Control itself.
Additional Changes:

Disabled AllowNavigation option to prevent user to navigate to other pages within the Preview Pane for Markdown and Svg Previewer.
Removed the logic to launch default browser on clicking on the link. It's failing with Access Denied for the prevhost.exe to launch browser Application which is causing the web browser control to open the web page inside the preview pane itself.


PR Checklist

 Applies to #914


Validation Steps Performed
Validated Unit tests and test the preview handlers on dev machine to block external content and not opening the urls.",2,0
1469,2020-03-05T18:22:41Z,2020-03-12T16:02:35Z,2020-03-12T16:02:35Z,114,13436,10,"Summary of the Pull Request
This PR moves the ImageResizer power toy to master.

PR Checklist

 Applies to #53
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated


Validation Steps Performed
Build and installed with both MSI and MSIX.",11,5
1479,2020-03-06T14:37:31Z,,2020-03-09T08:38:10Z,11,91,37,"Before fancyzones showed only on one monitor while dragging window.
Added support for showing on all monitos",5,2
1481,2020-03-06T21:11:40Z,2020-03-07T01:46:52Z,2020-03-07T01:46:52Z,20,470,0,"Summary of the Pull Request

This PR adds a base XALM Islands and WPF project.
Included in this are:
XamlApplication class in a UWP app project.
WPF app.
Unit test project.

 
References

https://docs.microsoft.com/en-us/windows/apps/desktop/modernize/host-standard-control-with-xaml-islands.


PR Checklist

 Applies to  #889,  #891, and #243
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favour of a different grand plan. Issue number where a discussion took place: #889,  #891, and #243",1,1
1491,2020-03-07T16:54:43Z,2020-03-09T09:41:06Z,2020-03-09T09:41:07Z,6,261,219,"Show MessageBox with exception message
Remove unused arguments
Guard all of the Editor input/output code parts and show MessageBox
with appropriate message and issue reporting link

Summary of the Pull Request
 
References

PR Checklist

 Applies to #1472 #1462 #1451
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,7
1492,2020-03-07T17:21:09Z,2020-03-09T22:21:34Z,2020-03-09T22:21:34Z,2,3,3,"Summary of the Pull Request
 
References

PR Checklist

 Applies to #1495
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,3
1496,2020-03-08T11:28:46Z,2020-03-09T18:22:54Z,2020-03-09T18:22:54Z,5,237,2,"Summary of the Pull Request
Document main interfaces of FancyZones module.

 Applies to #1498",2,1
1497,2020-03-08T13:41:37Z,2020-03-09T22:28:43Z,2020-03-09T22:28:43Z,1,1,5,"Summary of the Pull Request
 
References

PR Checklist

 Applies to #1499
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
1502,2020-03-08T23:10:47Z,2020-03-09T07:26:37Z,2020-03-09T07:26:37Z,3,9,9,"Summary of the Pull Request
Update the settings files to pick up this spelling fix https://github.com/microsoft/PowerToys/pull/1476/files

PR Checklist

 Applies to #1501


Validation Steps Performed
Manually tested.",2,2
1503,2020-03-09T10:37:52Z,2020-03-10T14:50:45Z,2020-03-10T14:50:45Z,3,253,111,"Implemented a solution to Issue #585: FancyZones: Alignment/Snapping/Ruler

Summary of the Pull Request
This PR implements one aspect of Issue #585. Now, windows in the Canvas zone editor will snap to each other when being moved and resized.
 
References

PR Checklist

 Applies to #585
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
Closed #1277 in favor of this PR, because I messed up the history on the other branch.

Validation Steps Performed
Manually tested the Canvas zone editor in various scenarios.",4,0
1508,2020-03-09T16:45:01Z,2020-03-09T20:21:10Z,2020-03-09T20:21:10Z,11,448,301,"Summary of the Pull Request
Updated PowerPreview Settings unit tests to used mock registry implementation instead of changing the registry in Unit tests.

PR Checklist

[ x ] Applies to #963
[ x ] Tests added/passed


Detailed Description of the Pull Request / Additional comments

Updated the logic of FileExplorerSettings to able to insert mock RegistryWrapper for unit testing. Moved the logic for registry interaction in a separate class RegistryWrapper.
Updated the .rc file to match the registry value with installation value.


Validation Steps Performed

Validated and added new Unit tests.
Validated PowerToys run locally.",2,0
1511,2020-03-09T18:51:42Z,2020-03-10T08:59:34Z,2020-03-10T08:59:34Z,1,20,24,"Summary of the Pull Request
Move to last known zone is currently only checking if window has known zone on the monitor where it is reopened, if not, than no zone assignment will happen. Go through all monitors and check if that window has last known zone on any of them, if yes, assign it to the zone.

PR Checklist

 Applies to #1234


Validation Steps Performed

Make sure Move newly created windows to their last known zone option is ON.
Select a layout/zoneset on a secondary monitor.
Move the window to a zone in the secondary monitor.
Close the window.
Relaunch window.

Expected result: Window is opened on the secondary monitor in last known zone.",4,1
1512,2020-03-09T19:23:25Z,2020-03-09T22:06:39Z,2020-03-09T22:06:39Z,1,2,0,"Summary of the Pull Request
 
References
Deleted custom layouts were not serialized to tmp JSON file when Editor was closed via Save and Apply button form EditorWidnow

PR Checklist

[] Applies to #1509",3,0
1515,2020-03-09T22:38:53Z,2020-03-11T15:38:14Z,2020-03-11T15:38:14Z,1,4,5,"Summary of the Pull Request
 
References

PR Checklist

 Applies to #1518
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,0
1516,2020-03-10T03:04:38Z,2020-03-11T22:53:50Z,2020-03-11T22:53:50Z,107,8790,1853,"Summary of the Pull Request
Merging Preview Handler for Svg and Markdown in master.
Merging the changes from dev/previewPane into master. Created another branch on my fork with rebasing the commits from dev/previewPane on master as the direct PR from dev/previewPane showing duplicate commits.

PR Checklist

 Applies to #914  and #963
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed

 Validated the preview handlers from the rebased branch. This is required before completing the PR.",6,17
1521,2020-03-10T13:33:12Z,2020-03-16T12:25:31Z,2020-03-16T12:25:31Z,6,85,6,"Summary of the Pull Request
Some refactoring of FancyZones::IsInterestingWindow and added Unit Tests

PR Checklist

 Applies to #1158
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Refactored FancyZones::IsInterestingWindow method (moved part of method to common.cpp). Added Unit Tests for find_substr_from_vec inside common.cpp

Validation Steps Performed
Manually tested, checked unit tests",5,0
1537,2020-03-11T15:19:37Z,2020-03-12T07:59:11Z,2020-03-12T07:59:11Z,2,12,11,"We now only launch update threads when we know we won't be elevated (so we don't blink if we're gonna be relaunched) and show windows for the child process by using correct flags for  ShellExecuteExW.

PR Checklist

 Applies to #1401

Validation Steps Performed

restarted as admin w/o a version check logic",2,0
1538,2020-03-11T16:44:15Z,2020-03-17T10:04:45Z,2020-03-17T10:04:46Z,8,93,97,"PR Checklist

 Applies to #1524

Also fixes problem with:

run as administrator
change value of run at startup to on
close
run as user
change value of run at startup and save - value of run at startup wont change",4,9
1542,2020-03-11T18:54:45Z,2020-03-12T00:35:31Z,2020-03-12T00:35:31Z,1,1,1,"Summary of the Pull Request
Updated the broken link for build definition in README.md",3,3
1543,2020-03-11T20:03:03Z,,2020-03-16T18:28:25Z,3,16,3,"Summary of the Pull Request
Support UTF-8 characters for custom layout name.

PR Checklist

 Applies to #1533


Validation Steps Performed
Use some non-ASCII characters inside custom layout name.",4,7
1546,2020-03-11T22:20:15Z,2020-03-12T06:25:25Z,2020-03-12T06:25:25Z,6,105,1,"Created a proof of concept General settings tab page with XAML layout. Fontsizes, margins and paddings are a 1:1 copy of the official Windows 10 settings app.
Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,5
1549,2020-03-12T00:51:56Z,2020-03-12T15:18:57Z,2020-03-12T15:18:57Z,1,0,1,"Summary of the Pull Request
PowerToysSetup.wixproj is failing to build in Debug configuration. With error: Undefined preprocessor variable $(var.Version)
The error is in importing the version.props it's not able to override DefineConstants if there are already DefaultConstants present.
Removed the DefaultConstants from the Debug configuration.

PR Checklist

[ x ] Applies to #1548


Validation Steps Performed
Build the project in Debug configuration and validate the output msi.",3,0
1553,2020-03-12T09:18:25Z,2020-03-13T14:56:23Z,2020-03-13T14:56:23Z,11,94,40,Applies to #1552,5,3
1558,2020-03-12T16:28:13Z,2020-03-16T21:29:14Z,2020-03-16T21:29:14Z,7,2328,1951,"Summary of the Pull Request

Added unit test for invalid jsons
Added validation for guid and device id string to prevent possible errors on parsing step.


PR Checklist

 Applies to #1459",6,2
1560,2020-03-12T17:29:57Z,2020-03-13T09:55:16Z,2020-03-13T09:55:16Z,10,62,106,"simplify powertoy_module interface
faster compilation for settings project


PR Checklist

 Applies to #823


Validation Steps Performed

launched PT
tests passed",5,0
1561,2020-03-12T18:15:54Z,2020-03-12T21:37:31Z,2020-03-12T21:37:31Z,1,13,1,"MSIX: add debug configuration option for package building

Use like this:
.\build_msix.ps1 -debug 1

PR Checklist

 Applies to #1292


Validation Steps Performed

installed debug version of MSIX",2,0
1565,2020-03-12T22:03:49Z,2020-03-13T15:48:24Z,2020-03-13T15:48:25Z,3,3,3,"compiled both MSIX and WiX project, both compiled.",2,0
1574,2020-03-13T22:34:02Z,,2020-03-15T20:08:41Z,33,765,216,"Summary of the Pull Request

Added Shortcuts Guide and PowerRename settings pages
Stylized textstyles and margins
Added VisualState logic for sidepanel containing e.g. learn more buttons and contributors list

References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,2
1577,2020-03-14T11:23:18Z,2020-03-16T16:54:31Z,2020-03-16T16:54:31Z,2,3,2,"Summary of the Pull Request
This PR partially fixes #1495, there are no more compiler warnings related to FancyZones.
 
References

PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,1
1583,2020-03-15T01:32:36Z,2020-03-16T12:34:17Z,2020-03-16T12:34:17Z,4,16,20,"Summary of the Pull Request
Removed out the failing unit tests projects of SvgPreviewHandler and PreviewHandlerCommon from the Solution. These will be add back after fixing the tests.
Changed the output directories of Unit Tests project to not interfere with product dlls.

PR Checklist

 Applies to #1567


Validation Steps Performed

Validated both Debug And Release config.
Validate MSI and MSIX by launching FanzyZoneEditor",3,4
1589,2020-03-15T20:15:31Z,2020-03-16T01:17:21Z,2020-03-16T01:17:21Z,31,846,486,"Summary of the Pull Request

Added Shortcuts Guide and PowerRename settings pages
Stylized textstyles and margins
Added VisualState logic for sidepanel containing e.g. learn more buttons and contributors list

References
#889 #1484 #1482 #1579

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",8,1
1591,2020-03-16T09:30:08Z,2020-03-16T12:18:20Z,2020-03-16T12:18:20Z,1,2,0,"Summary of the Pull Request
See issue #1590.
 
References

PR Checklist

 Applies to #1590
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
1597,2020-03-16T20:19:29Z,2020-03-17T23:07:45Z,2020-03-17T23:07:45Z,294,27952,4763,"Summary of the Pull Request

I added a wrapper around the existing C++ IPC library using ATL to re-use the same methods and workflow in C#.
Other Attempts made were C++/CLI CLR but could not continue with it as the dependant library uses mutex (and other libraries) which is not supported in CLR which I would have had to implement IPC messaging for myself.

For future proposals:

Deprecating the two_way_pipe_message_ipc.h implemented in win32 and use the .NET Core IPC Interop library which can be used both in C# and C++.
Here is a link with reasons why we should use C++/CLI CLR: https://stackoverflow.com/questions/1874783/what-are-the-situations-or-pros-and-cons-to-use-of-c-cli-over-c-sharp

 
References

PR Checklist

 Applies to #243
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where a discussion took place: #243


Validation Steps Performed

Created a cmd project to send IPC messages using the ATL wrapper and verified the output in the settings-web UI.
-ran unit tests to verify that there are no breaking changes.",13,5
1603,2020-03-17T10:57:58Z,2020-03-24T17:50:27Z,2020-03-24T17:50:27Z,11,1228,813,"Summary of the Pull Request
We currently support using WIN + ARROW key to move window through zones inside zone layout on one monitor. This pull requests improves that functionality, allowing movement to be performed in multi monitor scenario.

Sort monitors based on their top-left coordinate.
Once we reach last zone (or first, depending on direction) we switch to the layout on the different monitor and iterate through zones there.


PR Checklist

 Applies to #629",9,10
1604,2020-03-17T15:06:33Z,2020-03-17T17:12:33Z,2020-03-17T17:12:33Z,1,3,3,"PR Checklist

[] Applies to #1531",3,0
1608,2020-03-17T17:04:49Z,2020-03-18T16:52:09Z,2020-03-18T16:52:09Z,2,651,479,Updating few dependencies,2,0
1610,2020-03-17T20:29:02Z,2020-03-18T13:13:26Z,2020-03-18T13:13:27Z,6,52,4,"Summary of the Pull Request
This PR fixes #1519 and also fixes #751.
 
References

PR Checklist

 Applies to #1519 and  #751
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
The reason for these crashes is finally known and has been mitigated in this PR. It comes down to instances of GridEditor and CanvasEditor persisting after the editor window is closed when clicking Cancel. They stay alive and are still subscribed to events happening to the currently active Model. This PR adds checks which prevents these old instances of becoming awake and crashing.

Validation Steps Performed",3,0
1618,2020-03-18T14:39:07Z,2020-03-19T16:10:26Z,2020-03-19T16:10:26Z,1,10,5,"Summary of the Pull Request
Added details on the workflow process.

PR Checklist

 Applies to #1617",2,0
1620,2020-03-18T18:22:21Z,2020-03-20T15:28:48Z,2020-03-20T15:28:48Z,7,251,7,"Summary of the Pull Request
Adds a information bar in case of blocked element is present in Svg. Fix warning from Msi solution because of element referencing variable from other component.
Unit tests have been tested locally by adding the unit tests project to the solution. Unit tests project will be added in the solution file as part of different issue.
Image how the info bar looks like on top of preview.


PR Checklist

 Applies to #963
 Tests added/passed


Validation Steps Performed

 Validate with both MSI and MSIX installation.",3,1
1629,2020-03-18T21:35:41Z,2020-03-20T18:32:00Z,2020-03-20T18:32:00Z,4,8,8,"Summary of the Pull Request
 
References

PR Checklist

 Applies to #1274",4,12
1632,2020-03-18T22:29:57Z,2020-03-19T08:21:11Z,2020-03-19T08:21:11Z,1,9,9,Applies to #1611,3,2
1633,2020-03-19T08:59:23Z,2020-03-19T16:25:51Z,2020-03-19T16:25:51Z,5,446,101,"Summary of the Pull Request
Open editor by clicking button or by hotkey with different zone-settings

PR Checklist

 Applies to #846",3,0
1639,2020-03-19T16:35:00Z,2020-03-21T13:35:24Z,2020-03-21T13:35:24Z,3,329,114,"Summary of the Pull Request
Tests for editing template layouts in editor

PR Checklist

 Applies to #846",3,0
1640,2020-03-19T18:45:32Z,2020-03-20T18:41:49Z,2020-03-20T18:41:49Z,34,123,110,"Summary of the Pull Request

set separate intermediate dir for vcxprojs
set separate intermediate dir for csprojs
CopyToOutputDirectory only when necessary, so we don't rebuild stuff every time
set output dir prefix to ""modules"" for all modules


PR Checklist

 Applies to #1612

Detailed description

this reorganization helps to keep all build artifacts in one place out of src folder
it's also easier to see what files each project produces and remove all build artifacts manually in one move

We still observe some .lib/.pdb/.../ stuff in the output folder and can't just tell the installer to simply package everything (*) in a x64\Release folder, because that would require introducing too many custom rules for each new project and is kinda error-prone anyway (e.g. including unwanted build artifacts to the installer by accident)
Validation Steps Performed

Built MSI, installed it and used ImageResizer + FZ
Built MSIX",3,13
1641,2020-03-19T20:37:20Z,2020-03-20T12:48:25Z,2020-03-20T12:48:25Z,1,4,4,"Summary of the Pull Request
Modifying same variable in an expression twice can cause undefined behavior. Performing post increment to counter twice in single expression here causes faulty behavior, we are reading same value twice, and only after that we have counter incremented twice.

PR Checklist

 Applies to #1526",3,2
1647,2020-03-20T22:34:54Z,2020-03-23T17:44:03Z,2020-03-23T17:44:03Z,31,1060,212,"Summary of the Pull Request
Added the Edit Shortcuts UI and reformatted the code to include a common library which has a state class that can be used to share information between the UI and the back-end.
Details of the Pull Request

Added a common library with Helper functions and KeyboardManagerState class. This class will be used to share information between the hook and the UI. The object of this class is created in dllmain.cpp.
Refactored the code base to constrain all code which involves UI and back-end information to wrapper functions in the state class.
Added a shortcutControl class which creates a custom control for each element in the shortcut table.

Follow up To-Dos

Add thread safety
Add tests
Add support to save the shortcuts to a file
Add UI for app specific shortcuts and configurations
Display key names instead of codes


PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed

Run PowerToys.exe. The Keyboard Manager window should pop up if PowerKeys is enabled.
Click Edit Shortcuts. Clicking the + Sign will allow you to add a new shortcut. The shortcut can be removed by clicking the delete button.
Press Type shortcut to detect your shortcut. As of now the key name will not be displayed, only the code.
In the current version, only 2 key shortcuts will be applied. A check has not been added for the order of the keys in the UI, so while testing it make sure the modifier key is clicked first. Example: Ctrl+A and not A+Ctrl.
Clicking Apply will save the settings and your shortcuts will be remapped. If any of remaps were invalid, the valid ones will still apply, however a warning will be displayed on the top right corner.
Clicking Cancel will simply exit the window. If Apply was not clicked prior to clicking cancel then those shortcuts will not be saved.
If you reopen the Edit Shortcuts Window your shortcuts will still be visible. However if you terminate PowerToys.exe and relaunch it your saved shortcuts will be lost.",3,3
1648,2020-03-21T14:52:20Z,2020-03-24T08:32:13Z,2020-03-24T08:32:13Z,4,163,22,"Summary of the Pull Request
Open editor, apply template layout, check if zones-settings were changed

PR Checklist

 Applies to #846",2,0
1651,2020-03-23T14:30:30Z,2020-03-24T23:23:28Z,2020-03-24T23:23:28Z,9,221,217,"Summary of the Pull Request
Update the logic of File explorer settings. Updated the logic to pick up default value as true in case of no previous settings is present and make the settings persistent in case of restarting the PowerToys.
Settings logic behaviour:

On startup of PowerToys if previous settings config present used it otherwise default to enable.
On exit of PowerToys disable all the active previews handlers.
If the global setting File Explorer is disabled all the enable and disable update operation on individual Preview Handler will only be reflected on Settings UI and applied once the global settings is set to enabled.
If the global setting File Explorer is enabled all the enable and disable update operation on individual Preview Handler will be reflected on Settings UI and applied.


PR Checklist

 Applies to #1630, #1652
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Validated settings with MSI installation of PowerToys.",4,0
1654,2020-03-23T16:42:55Z,2020-03-23T22:45:17Z,2020-03-23T22:45:17Z,1,86,2,"Summary of the Pull Request
Updated the Readme.md for Preview Handlers to add instructions for Installation changes required for MSI and MSIX for adding a new Preview Handler.

PR Checklist

 Applies to #963
 CLA signed. If not, go over here and sign the CLA",2,0
1655,2020-03-23T17:32:16Z,2020-03-23T19:14:04Z,2020-03-23T19:14:04Z,1,1,1,"Summary of the Pull Request
Fix for #1566. A free was being used for a string created by IShellItem::GetDisplayName instead of CoTaskMemFree.

PR Checklist

 Applies to #1566
 CLA signed. If not, go over here and sign the CLA",3,4
1660,2020-03-23T20:44:44Z,2020-03-24T07:51:24Z,2020-03-24T07:51:24Z,4,6,6,"Summary of the Pull Request
Replaced Deprecated headers
 
References

PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
I replaced the deprecated STL headers and replaced them with the equivalent ones.

Validation Steps Performed

Unit tests",4,1
1661,2020-03-23T22:03:46Z,2020-03-24T00:13:48Z,2020-03-24T00:13:48Z,7,33,0,"Summary of the Pull Request
This PR updates the Readme information for Image Resizer. It can be viewed here. It contains demos for how to use the tool and a demo for showing the configurable settings.
This PR also adds verbiage to the Settings screen to indicate the settings can be accessed from within Image Resizer. A module overview link has also been added which links back to the Readme (as done for other PowerToys).


PR Checklist

 Applies to #1628, #53, #1657
 CLA signed. If not, go over here and sign the CLA",3,0
1662,2020-03-24T00:39:17Z,2020-03-24T18:32:02Z,2020-03-24T18:32:02Z,4,7,1,"Summary of the Pull Request
This PR adds the PictureStretch icon as the Image Resizer icon in the PowerToys settings.


PR Checklist

 Applies to #1659
 CLA signed. If not, go over here and sign the CLA",4,0
1664,2020-03-24T06:54:23Z,2020-03-25T02:55:02Z,2020-03-25T02:55:02Z,33,437,311,"Summary of the Pull Request


Added functionality for General Settings Page


Settings Include: Run on startup, change the theme, links to issues and bug reports and restart as admin.


I would like feedback on the architecture, implementation, and design. I will enforce more good practices on the upcoming PRs.


 
References

PR Checklist

 Applies to #1482
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where a discussion took place: #1482


Detailed Description of the Pull Request / Additional comments

To test the code, re-add refference to the IPCLib dll found in x64/ directory to the Runner.


Validation Steps Performed

Validdated output on the UI and the json settings file found in AppData/Local/Microsoft/PowerToys/settings.json",3,6
1666,2020-03-24T08:41:44Z,2020-03-25T14:38:44Z,2020-03-25T14:38:44Z,13,803,609,"PR Checklist

 Applies to #1606
 Applies to #1085


Detailed Description of the Pull Request / Additional comments

When draging window. If window is large it can cover whole zone, making it impossible to see. It would be good if draged window would be transparet to some degree.
Instead of couple colors of zones, it would be good if all were in same shade of grey. Color of zone and color of zone border would be configurable
Zone number will now be shown as digit in center of zone",5,1
1667,2020-03-24T09:07:53Z,2020-03-24T14:27:23Z,2020-03-24T14:27:23Z,2,51,3,"Summary of the Pull Request
added checks for zones count and type in Editor templates edit tests

PR Checklist

 Applies to #846",2,0
1669,2020-03-24T13:43:31Z,2020-03-25T10:11:27Z,2020-03-25T10:11:27Z,1,6,4,"Summary of the Pull Request
Enables serializing utf8 characters to file. This was not working before out of the box and was ending up with messing with both temporary json files (causing Editor to crash) and zones-settings.json file.

PR Checklist

 Applies to #1322, #1533, #1555",4,1
1670,2020-03-24T13:58:24Z,2020-03-25T10:11:18Z,2020-03-25T10:11:18Z,6,233,130,"Summary of the Pull Request
Replace Utf8Writer and manual serilalization from Editor with JsonSerializer. This makes this part of code easier to maintain and less error prone if possible changes are made in this area

PR Checklist

 Applies to #1672",5,4
1671,2020-03-24T14:44:49Z,2020-03-27T10:23:39Z,2020-03-27T10:23:39Z,16,358,47,"Summary of the Pull Request

FZ: warn with a toast if an elevated window cannot be dragged. Warns once per PowerToys.exe launch, can be disabled for good using ""Don't show again"" button
MSIX: update PowerRenameUWPUI path, so PowerRename works in MSIX again
minor control-flow clean up


PR Checklist

 Applies to #1015


Detailed Description of the Pull Request / Additional comments

As described in that comment, we cannot detect if the Shift key is being held while an elevated window is active due to UIPI Windows security feature, so the toast notification is shown as soon as we drag an elevated window even w/o actually holding the Shift key.
We need to store ""Don't show again"" flag state somewhere. UWP API offers a convenient key-value storage, but unfortunately it's not usable for unpackaged apps (throws ""The process has no package identity.""), so we use the same mechanism as SHMessageBoxCheck - the registry.
Since we use the registry, we must introduce a custom URI scheme protocol which will be handled by a PowerToys.exe, because notifications library, being C++/WinRT project, doesn't support any legacy APIs such registry manipulation, so we can't use a background handler to update the flag state.


Validation Steps Performed

MSI works as admin/nonadmin (i.e. toast isn't shown when the window is draggable)
MSIX works (via virtualized registry)

Screenshot",3,12
1673,2020-03-24T19:55:35Z,2020-03-25T10:12:38Z,2020-03-25T10:12:38Z,4,10,9,"Summary of the Pull Request
Change PowerRename context-menu hotkey to 'w' as 'p' is commonly used for print.

PR Checklist

[] Applies to #1034
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Validation Steps Performed

Reinstall PowerToys
Restart explorer manually
Select some files and right-click
While context menu is open press 'w'",2,0
1682,2020-03-25T09:10:53Z,2020-04-08T13:33:06Z,2020-04-08T13:33:06Z,1,139,32,"Summary of the Pull Request
Editor settings tests

PR Checklist

[] Applies to #846


Detailed Description of the Pull Request / Additional comments
Added tests for ""Show space around zones"" checkbox and ""Space around zones"" field",4,1
1695,2020-03-25T20:37:20Z,2020-03-26T22:17:29Z,2020-03-26T22:17:29Z,6,114,132,"Summary of the Pull Request
Updated HTML parsing extension in markdown preview pane to display infobar for blocked relative image URL's.

PR Checklist

 Applies to #1677
 Tests added/passed


Validation Steps Performed
Manually validated desired functionality and ensured that tests are passing",3,0
1697,2020-03-25T23:20:55Z,2020-03-26T18:22:26Z,2020-03-26T18:22:26Z,2,320,80,"Summary of the Pull Request
This PR adds support for shortcut remapping when shortcuts have more than 2 keys. The shortcut remapping will now also work with the On-Screen Keyboard.

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Detailed Description of the Pull Request / Additional comments

Generalized the shortcut code to work for shortcuts greater than 2 keys
Removed the ""Shortcut must be exactly 2 keys"" constraint on the Edit Shortcuts UI. The only constraint as of now is that the shortcut must be atleast 2 keys.
Added a function in the shortcut code to check if any other keys are pressed apart from the shortcut. This was required because in the previous version of the code, if the user remaps Ctrl+C to Ctrl+V and the user pressed Ctrl+Shift+C the system would get Ctrl+Shift+V, whereas Ctrl+Shift+C is actually a different shortcut. By checking that no other keys are pressed when Ctrl+C is pressed we can ensure to remap the exact shortcut instead of all shortcuts which contain it.
Summary of the remap algorithm (also present in comments across the code):

Check for the last key in the original shortcut. If all the modifier keys are also pressed down and no other keys are pressed, then clear out all the original shortcut keys and set the new shortcut keys as pressed down.
There are 4 cases to be handled if the shortcut has been pressed down

The user lets go of one of the modifier keys - reset the keyboard back to the state of the keys actually being pressed down (original shortcut keys except the one which was released)
The user keeps the shortcut pressed - the shortcut is repeated (for example you could hold down Ctrl+V and it will keep pasting)
The user lets go of the last key - reset the keyboard back to the state of the keys actually being pressed down (original shortcut except the last key)
The user presses another key while holding the shortcut down - the system now sees all the new shortcut keys and this extra key pressed at the end. Not handled as resetting the state would trigger the original shortcut once more




Note: In all the steps above, an extra check has been added to avoid resetting the state and resending key events for keys which are common between the two shortcuts. The code would still work fine without this, but to minimize latency the lesser the number of SendInput events the better.


Validation Steps Performed

Build and run the project. At the Edit Shortcuts UI type any shortcut with any number of keys, but ensure the non-modifier key is the last one to be pressed. Apply the shortcut remap and it will work on any application.",2,0
1698,2020-03-26T00:21:30Z,2020-03-27T15:38:58Z,2020-03-27T15:38:59Z,8,392,14,"Summary of the Pull Request
Adding Poc UI for the remap Keyboard window. Implementation is very similar and using the logic used with the  Shortcut Remap window added in PR - 1647

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed

Validated the Remap logic working correctly locally and in parity with Shortcut remap.",3,3
1699,2020-03-26T01:31:04Z,2020-03-26T20:43:02Z,2020-03-26T20:43:02Z,1,5,0,"Summary of the Pull Request
Stop the Window Walker process on exit of PowerToys
Before this change, the launched Window walker keeps sitting in the background when PowerToys exits. This makes sure that the module stops the process on PowerToys exit.

PR Checklist

 Applies to #1625
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Validation Steps Performed
Ran it and verified that when exiting PowerToys using the exit menu, Window Walker is also stopped.",4,0
1702,2020-03-26T03:23:02Z,2020-03-30T09:02:26Z,2020-03-30T09:02:26Z,14,420,130,"Summary of the Pull Request

added  page and functionality fo

 
References

PR Checklist

 Applies to #1482
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1482


Validation Steps Performed

Verified updates the settings JSON file.
Verified that the changes in the UI were propagated to the module to configuration updates.",3,7
1705,2020-03-26T09:13:48Z,2020-03-26T10:54:13Z,2020-03-26T10:54:13Z,3,12,0,"Summary of the Pull Request
Added telemetry method and its call after FancyZones editor launch.

PR Checklist

 Applies to #1696",2,0
1708,2020-03-26T11:22:03Z,2020-03-26T12:25:20Z,2020-03-26T12:25:20Z,1,1,1,"Summary of the Pull Request

fix the artifact path in MSIX packaging layout file


PR Checklist

 Applies to #1707
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed

Validation Steps Performed

installed MSIX and verified that it works",2,0
1709,2020-03-26T12:30:38Z,2020-03-26T16:48:02Z,2020-03-26T16:48:02Z,1,5,2,"Summary of the Pull Request
PR Checklist

 Applies to #1704

Steps to reproduce fixed bug

turn off ""show spaces around zones"" on two monitors and have grids or other configuration on both
drag window from one monitor to another

Expected behavior

zone on new monitor is marked as active
all zones on previous are marked as inactive

Actual behavior

zone on new monitor is marked as active
zone on previous is marked as active",4,0
1721,2020-03-27T09:04:41Z,2020-03-27T10:24:27Z,2020-03-27T10:24:27Z,3,9,3,"Summary of the Pull Request
The option is no longer there and will be removed from settings.json as soon as there's a need to update it. Once the option is restored and turned off, it'll appear in the settings.json again (switched off by default).

PR Checklist

 Applies to #1720
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

launched FZ, opened settings, opened settings.json",2,2
1729,2020-03-27T12:27:02Z,2020-03-27T14:24:28Z,2020-03-27T14:24:28Z,1,14,0,"Summary of the Pull Request
This PR implements a check in Window Walker which should prevent it from having multiple running instances - #1691. This is done at C#/App level, so it should even work when users start the module manually.
 
References

PR Checklist

 Applies to #1691
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Manually tested by running multiple instances from Explorer, and also by quitting/restarting PowerToys. There's still going to be an issue with Window Walker persisting after quitting PowerToys.",3,1
1731,2020-03-27T12:50:36Z,2020-03-27T14:17:37Z,2020-03-27T14:17:37Z,4,8,2,"Summary of the Pull Request
Not the best looking icon but for 0.16 this is what we have.

PR Checklist

 Applies to #1730


Validation Steps Performed",2,0
1735,2020-03-27T14:53:03Z,2020-03-27T15:58:53Z,2020-03-27T15:58:53Z,17,456,41,"Summary of the Pull Request

Added styles for common margins + textblocks
Added ShortcutGuide page
Added PowerRename page
Added PowerLauncher page
Added a sidepanel that could include links about the feature and contributors (in Shellpage)
Minor styling updates to ShellPage

 
References
#889 #1484 #1482 #1579

PR Checklist

 Applies to #889 #1484 #1482 #1579
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Detailed Description of the Pull Request / Additional comments

Not sure if the sidepanel should live in the ShellPage or on the separate pages. Makes it easier for the VisualState/resizing stuff.
Do we have a control that we can re-use across settings / editor that take in hot-keys? Would be nice to have something that is in terms of visual style and behavior the same across all apps.
@laviusmotileng-ms @crutkas Thoughts?

Validation Steps Performed",3,3
1748,2020-03-27T19:49:44Z,2020-03-27T20:52:55Z,2020-03-27T20:52:55Z,1,0,12,"Summary of the Pull Request
Removed the part of the code in Window Walker which added a registry entry in HKCU to set it as a startup application.

PR Checklist

 Applies to #1747
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Built Debugx64 and installed with MSI to verify that functionality is working.",2,1
1755,2020-03-27T20:29:01Z,2020-03-27T22:12:42Z,2020-03-27T22:12:42Z,1,4,4,"Summary of the Pull Request
Bug fix for FZ crash when trying to migrate custom layouts from Windows Registry.

PR Checklist

[] Applies to #1760
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx",4,4
1756,2020-03-27T20:30:59Z,2020-03-27T21:35:42Z,2020-03-27T21:35:43Z,1,1,1,"Summary of the Pull Request
The m_enabled variable was defaulted to true instead of false. This resulted in the settings window showing enabled irrespective of the value in settings.json after every relaunch.

PR Checklist

 Applies to #1749
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Built Debugx64 and installed with MSI. Checked both cases were settings.json does not exist - Window Walker should be enabled by default, and once it exists then it should follow the value in the json on every launch.",2,0
1757,2020-03-27T20:35:22Z,2020-03-31T12:15:51Z,2020-03-31T12:15:51Z,9,1125,118,"Summary of the Pull Request
Creation, deletion, edit custom layouts tests
 
References
Tests were revealed problems related to issues #1712, #1754

PR Checklist

 Applies to #846
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Tests done:

Create custom layout

layout with zones
layout without zones
layout with empty name
name with unicode characters
several layouts with same names


Edit custom layouts:

Add/remove canvas zones
Move borders of canvas zones
Move splitters of grid zones
Create new splitters
Merge grid zones


Delete custom layout

Delete layout and close editor
Delete and add new layout",2,0
1778,2020-03-29T19:55:13Z,2020-04-08T12:46:06Z,2020-04-08T12:46:06Z,5,122,50,"Summary of the Pull Request

Adapted the visual style of the CanvasZone UC to better integrate with the W10 look and feel.
Using Segoe MDL2 Assets icon font for the close button.
A CanvasZone can now be dragged by clicking anywhere on the zone (not just the topbar)
Thumbs will light up to indicate what can be resized.


References
#1774
PR Checklist

 Applies to #1774
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx",4,12
1780,2020-03-30T02:25:45Z,2020-04-01T15:26:19Z,2020-04-01T15:26:19Z,4,85,57,"Summary of the Pull Request
Updating the File Explorer module readme with updated module name, demo gif and step to enable Preview Pane in File Explorer.
Readme link in Fork repo branch: https://github.com/udit3333/PowerToys/blob/user/udit3333/Update-File-Explorer-Readme/src/modules/previewpane/README.md

PR Checklist

 Applies to #1763
 CLA signed. If not, go over here and sign the CLA",4,4
1787,2020-03-30T18:39:58Z,2020-03-31T20:41:20Z,2020-03-31T20:41:20Z,402,35845,9058,"Summary of the Pull Request
Sync changes from master on the keyboard manager feature branch.

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA",16,0
1788,2020-03-30T20:41:16Z,2020-03-30T22:35:44Z,2020-03-30T22:35:44Z,1,2,2,,3,0
1789,2020-03-30T22:39:59Z,2020-04-03T17:57:46Z,2020-04-03T17:57:46Z,6,132,23,"Summary of the Pull Request
This PR adds thread safety to the shared variables between the Keyboard Manager backend and the UI. For most of the shared variables, the locks have been accessed in the member functions itself, to ensure each member function is thread safe. For the maps which store the remapping of keys/shortcuts, the mutexes were made public since the code in dllmain uses the maps in many lines of code, thus refactoring them into member functions would be worse in this situation.
Also fixed a bug in the detect key window, where key up strokes were also being detected.

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA
 Tests passed

Validation Steps

Build and run in Debug/Release
Performed remapping keys tasks as well as remapping shortcuts, could not find any deadlock",4,4
1790,2020-03-31T00:08:33Z,2020-03-31T17:33:11Z,2020-03-31T17:33:11Z,3,50,0,"Summary of the Pull Request
This doc is to better educate and document what and when we need to run elevated.
https://github.com/microsoft/PowerToys/blob/dev/crutkas/RunAsAdminDocs/doc/devdocs/run-as-admin-detection.md to have the pretty view.
 
References

PR Checklist

[] Applies to #938, #1015
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,4
1792,2020-03-31T09:36:57Z,2020-03-31T12:32:23Z,2020-03-31T12:32:23Z,20,813,184,"Summary of the Pull Request

Added a FancyZones XAML page.
Added a ImageResizer XAML page.
Replaced various ToggleSwitches with CheckBoxes based on industry standard UX guidelines (https://uxmovement.com/buttons/when-to-use-a-switch-or-checkbox/)
Added sidepanel with module info and contributors list to all separate pages including visual state management. (And removed the fixed one from ShellPage)


 
References
#889

PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1373",2,4
1793,2020-03-31T10:45:15Z,2020-04-01T14:05:02Z,2020-04-01T14:05:02Z,4,817,790,"Summary of the Pull Request

Updated names for visual elements
Updated elements search in tray tests
Changed PowerToys launch
Updated FancyZones Settings tests for toggles and color sliders

 
References

PR Checklist

 Applies to #846
 Tests added/passed",2,0
1794,2020-03-31T16:10:18Z,,2020-04-14T08:26:18Z,1,15,7,"Summary of the Pull Request

can't drag elevated warning is shown every hour instead of of  once per launch
reorder some checks to improve performance


PR Checklist

 Applies to #1015
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

checked that it works using MSIX",4,2
1813,2020-04-01T02:38:55Z,2020-04-02T13:08:56Z,2020-04-02T13:08:56Z,17,346,126,"Summary of the Pull Request

Added functionality for PowerRename Settings Page.


PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Validation Steps Performed
Verfied updates to JSON settings.",3,6
1814,2020-04-01T02:46:30Z,2020-04-01T13:09:38Z,2020-04-01T13:09:38Z,2,3,3,"Summary of the Pull Request
Allow scrolling the list of windows in Window Walker using the tab key
PR Checklist

 Applies to #1806
 CLA signed. If not, go over here and sign the CLA
[]Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Validation Steps Performed
Ran it and tried tabbing through a list of windows and it works fine.",2,1
1817,2020-04-01T05:15:33Z,,2020-05-07T08:34:14Z,3,237,113,"FancyZones editor remains open after PowerToys is closed

Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,4
1820,2020-04-01T08:28:26Z,2020-04-01T10:12:30Z,2020-04-01T10:12:30Z,1,0,82,"Summary of the Pull Request
Removed unit tests with scenario that never happens and which cause CI slowdown.
 
References

PR Checklist

 Applies to #1784
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
1824,2020-04-01T09:29:17Z,2020-04-01T11:30:22Z,2020-04-01T11:30:22Z,3,16,40,"Applies to #1770

To test change:

main.cpp:144 to
std::this_thread::sleep_for(std::chrono::seconds(1));
msi_to_msix_upgrade.cpp:114
VersionHelper current_version(VERSION_MAJOR , VERSION_MINOR, VERSION_REVISION);
Set different major, minor and revision",3,2
1826,2020-04-01T10:23:39Z,2020-04-02T16:51:37Z,2020-04-02T16:51:37Z,2,43,0,"Summary of the Pull Request
Fixes #1821
 
References
I think this could be related to #1807

PR Checklist

 Applies to #1821
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1821


Detailed Description of the Pull Request / Additional comments
Fixes the JSONHelper::isValidDeviceId by splitting the first section on the '#' instead of by '_'. This allows to use underscores in monitor device names.

Validation Steps Performed",4,6
1831,2020-04-01T11:37:07Z,,2020-04-02T07:49:29Z,1,1,0,"Summary of the Pull Request
Saving data right after user clicks delete button
 
References

PR Checklist

 Applies to #1754
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
Fixed scenarios:

Delete Custom layout A. create and apply Custom layout B.
Delete Custom layout A, select custom Layout B, click ""edit selected Layout"", click ""Save and Apply"".

Both layout were saved in settings file in these scenarios, though only layout A expected to be saved.

Validation Steps Performed
Tests now pass:

  
    
      PowerToys/src/tests/win-app-driver/FancyZonesTests/EditorCustomLayoutsTests.cs
    
    
         Line 228
      in
      90a2286
    
  
  
    

        
          
           public void AddRemoveDifferentLayoutNames() 
        
    
  



  
    
      PowerToys/src/tests/win-app-driver/FancyZonesTests/EditorCustomLayoutsTests.cs
    
    
         Line 198
      in
      90a2286
    
  
  
    

        
          
           public void AddRemoveSameLayoutNames()",4,2
1835,2020-04-01T13:21:09Z,2020-04-01T15:27:14Z,2020-04-01T15:27:14Z,1,1,1,"Summary of the Pull Request
Increase version number to 0.16.1.
Validation Steps Performed
Manually tested.",2,0
1838,2020-04-01T13:24:04Z,,2020-05-07T08:22:08Z,4,222,114,"[FancyZones Settings] Fancy Zones Editor was closed when clicking on Edit zones button

Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,2
1842,2020-04-01T15:59:57Z,2020-04-01T17:30:28Z,2020-04-01T17:30:28Z,1,3,3,"Summary of the Pull Request
Language pedantry. Corrects use of the always incorrect ""off of"" with ""on"" in the Readme.
I've not looked for anything beyond the root readme, which I probably should've done. Feel free to tell me if there's anything else.
 
References
N/A

PR Checklist

[N/A] Applies to #xxx
 CLA signed. If not, go over here and sign the CLA
[N/A] Tests added/passed
[N/A] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
1844,2020-04-01T17:36:15Z,2020-04-01T18:44:16Z,2020-04-01T18:44:16Z,1,0,0,"Summary of the Pull Request
The current fix is to just add all the unlocalized English strings (in this case the strings that we added), to all the string tables of different languages as well. Based on my investigation there is no way to have some global strings which are in English while also have a string table with some localized strings (in case of IR the ""Resize pictures"" is already localized in the rc file). The only solutions until we have translated versions are either add the english version to all the string tables or comment out the translated string tables so only english is supported
Changes
Since the diff view for the rc file is not visible, the changes made in the file are like this.

For each language's string table (Chinese in the above image for example) I added the last 4 english strings (since we don't have translated versions of them).

PR Checklist

 Applies to #1795
 CLA signed. If not, go over here and sign the CLA
 Tests passed


Validation Steps Performed
Build and installed with MSI. Changed OS language to French to verify that those strings appear correctly.",2,0
1850,2020-04-01T22:27:14Z,2020-04-08T13:43:20Z,2020-04-08T13:43:20Z,2,9,75,"Summary of the Pull Request
This was needed while we were still migrating device-info, so active layout could be migrated as well. At some point we dropped migration of device-info. Therefore, this has no valid purpose anymore.

PR Checklist

[] Applies to #1761
[] CLA signed. If not, go over here and sign the CLA
[] No automatic tests needed. Manually tested migration of custom layouts.


Validation Steps Performed
Tested migration of custom layouts from Windows Registry, as this removal was part of MigrateCustomZoneSets() method. Migration works as expected.",4,2
1856,2020-04-02T02:22:51Z,2020-04-03T15:12:12Z,2020-04-03T15:12:12Z,9,343,276,"Summary of the Pull Request
Re-add  UnitTests-SvgPreviewHandler and UnitTests-PreviewHandlerCommon unit tests projects back to the solution since they were failing in CI pipeline. Added all the preview pane unit tests as part of the CI.
The issue is with the Window Handle created by UI controls being destroyed after the test assembly App Domain unloaded. Updated all the tests which are using UI Controls to dispose it in the tests itself. Also updated test framework and adaptors to latest.

PR Checklist

 Applies to #1622
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Validated the tests projects in CI from a separate branch and validate Powertoys with MSI locally.",4,0
1858,2020-04-02T04:14:19Z,2020-04-07T22:22:17Z,2020-04-07T22:22:17Z,2,62,4,"Summary of the Pull Request
UWP apps only showed the hosting process ApplicationFrameHost.exe for the process name. Following the code sample referenced in #1766, this should now correctly show the process names.
PR Checklist

 Applies to #1766
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1766

Detailed Description of the Pull Request / Additional comments
There were 3 options that were helpfully outlined by @arjunbalgovind and @enricogior provided a working C++ code sample I was able to translate. Its worth mentioning that @arjunbalgovind suggested using method 3 as more reliable and better documented but for now, this solution should be fine.
Validation Steps Performed
Searching for UWP apps works as expected (both title and process names are reasonable). Performance also seems fine since the child enumeration happens on a child thread.",3,2
1859,2020-04-02T04:32:39Z,2020-04-02T17:24:45Z,2020-04-02T17:24:45Z,2,7,1,"Summary of the Pull Request
If the user selects an item from the result windows in Window Walker using the mouse, the next invocation does not have the text box selected by default. This change sets the focus on the text box every time the window gets focus.
While this fixes a specific issue, it will also hopefully fix the general bug reported in #1800.
PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1800

Validation Steps Performed
Tried out the scenario of mouse clicking and checking for focus and it works fine.",2,1
1876,2020-04-02T15:08:46Z,2020-04-07T09:03:58Z,2020-04-07T09:03:58Z,1,2,15,"Summary of the Pull Request
Removed offset scaling on editor opening.
 
References

PR Checklist

 Applies to #1649
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
Editor window coordinates depended on DPI unaware coordinates with scaled offsets. Removing offset scaling solved the problem.
Editor with scaled offsets:

Editor with not scaled offsets:


Validation Steps Performed
Also checked different combinations of taskbar positions with different monitor scalings on primary and secondary monitors",4,1
1884,2020-04-02T17:27:09Z,2020-04-07T08:24:00Z,2020-04-07T08:24:00Z,1,1,1,"Summary of the Pull Request
Simple fix for #1849
Prevents windows in the last zone being placed in the first zone when the zone count is decreased. Tested manually.

PR Checklist

 Applies to #1849
 CLA signed. If not, go over here and sign the CLA
 Tests passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1849


Validation Steps Performed
Tested each template layout from 9 zones, placed a window into each zone. Decreased the number of zones one at a time and checked that the window in the last zone maintained its size and position, and was not sized and placed so as to be in the first zone.",2,3
1902,2020-04-02T23:14:18Z,,2020-04-17T22:39:08Z,10,429,117,"tem Tray Icon
Windows System Tray Icon - check for updates and show common features

Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,10
1903,2020-04-02T23:47:46Z,,2020-04-09T19:24:35Z,1,4,1,"Summary of the Pull Request
When two windows have the same name, they are considered ""duplicates"" and one of them is thrown out. The proper behavior that this PR implements is to check their window handles as well to see if they are the same windows.
PR Checklist

 Applies to #1887
 CLA signed. If not, go over here and sign the CLA
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1887

Validation Steps Performed
Duplicate window title show up as expected.",2,2
1904,2020-04-03T01:09:29Z,2020-04-10T14:29:19Z,2020-04-10T14:29:19Z,5,99,33,"Summary of the Pull Request
When creating virtual desktop, FZ clones layout from it's parent desktop.
This fixes the bug where cloning also happened on switching (to already existing) VD and that switched-to-VD had no layout applied. So if there was NO layout applied on purpose, we don't want cloning to occur, but leave that VD with NO layout applied.
 
References

PR Checklist

 Applies to #1343
 Unit Tests are added


Validation Steps Performed
Following scenario is fixed:

Clean zones-settings - so there is no layout applied on primary desktop
Run PT and without applying any layout create new VD
Apply any layout to VD (e.g. PriorityGrid with 5 zones)
Go back to primary desktop

Previous behavior:
Primary desktop inherits 5-zones PriorityGrid from VD
New behavior:
Primary desktop has no layout applied as before",6,7
1909,2020-04-03T09:36:45Z,2020-04-08T17:12:47Z,2020-04-08T17:12:47Z,8,312,222,"Summary of the Pull Request
Use persistent json data file for storing PowerRename settings instead of registry. Currently whenever we call settings object to get / set certain setting we read / write from registry. Getting settings with new implementation won't require any IO operation, data is loaded from json formatted file on the startup. Settings are saved to file when certain settings change and when disabling PowerRenam / closing PowerToys. Migration of settings from registry is supported.
Most recently used list of search and replace strings will be implemented using json storage in follow up pull request.
Example json file:
{
    ""ShowIcon"": true,
    ""ExtendedContextMenuOnly"": false,
    ""PersistState"": true,
    ""MRUEnabled"": true,
    ""MaxMRUSize"": 10,
    ""Flags"": 0,
    ""SearchText"": """",
    ""ReplaceText"": """"
}


PR Checklist

 Applies to #1206",4,4
1914,2020-04-03T11:10:50Z,2020-04-03T18:17:13Z,2020-04-03T18:17:13Z,1,23,13,"PR Checklist

 Applies to #1873

PR description
Option ""make dragged window transparent"" didn't full restored dragged window properties that causes some specific application eg. Unity3d to crash while moving them.
Changes were made to ensure all properties were restored to dragged window once it is dropped.
Validation Steps Performed
Tested on unity3D
Note
Unity3D still will crush if you grab it by 2 pixels thick application bar that is vertical resize and powertoys treats as move.
It will be fixed with #1420",7,1
1917,2020-04-03T14:46:45Z,2020-04-03T18:07:35Z,2020-04-03T18:07:35Z,1,1,1,"Summary of the Pull Request
I have changed the info text in search box to indicate the user also can search for windows.
 
References

nothing


PR Checklist

 Applies to #1916
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1916


Detailed Description of the Pull Request / Additional comments
At the moment users see the text Search for running processes... which indicates the user to enter a process name. We coul add the string or windows so the user knows that he also can search for window titles.

Validation Steps Performed

nothing",2,0
1924,2020-04-03T19:00:33Z,2020-04-03T20:33:51Z,2020-04-03T20:33:51Z,1,1,0,"This allows developers to F5 with the runner as startup and have all the dependencies for the keyboard manager properly build, and thus make the PowerManager UI functional.

Validation Steps Performed
Pressing ""F5"" on a clean solution and verifying that the proper dlls are built and the keyboard manager settings screen launches:",2,0
1927,2020-04-03T20:52:59Z,2020-04-08T16:11:58Z,2020-04-08T16:11:58Z,14,1261,304,"Summary of the Pull Request
This PR refactors the data structures used for Shortcut remaps. Earlier a vector of keys was used, however this had many issues w.r.t constraining the order of keys in the UI, constraining the type of keys used in the shortcut and supporting left/right versions of modifiers.
This PR adds a Shortcut class instead which contains function wrappers for all shortcut key related logic, while maintaining most of the actual remap logic in dllmain.cpp

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Added a Shortcut class, which stores all the modifiers and the action key associated with the shortcut. It also contains member functions for converting to virtual key codes, converting to string, and other remapping logic functions.
Added a RemapShortcut class. Earlier the std::map used was std:map<vector, pair<vector, bool>>. To clean this up, it is now std:map<Shortcut, RemapShortcut> where RemapShortcut consists of a Shortcut (the target shortcut), a bool variable (for checking if the shortcut was invoked), and a ModifierKey value to check which Windows key was pressed. The last is required to handle shortcut remaps which can work for either win key (there is no virtual key code for a common win key like that which exists for Ctrl, Alt, Shift). This value is used to remember which Win key was pressed when the shortcut was invoked. It is kept in this RemapShortcut class and not in the shortcut class itself since the key object in an std::map must be const and cannot be modified.
The Shortcut class now allows all modifiers to have displayable name based on whether it was left or right (example LCtrl or RCtrl) and a common one as well (Ctrl).
Common versions of all modifiers have been implemented. A user can now use Ctrl+A rather than LCtrl+A specifically. This is however not yet accessible on the UI since the detect key window won't show that according to the spec. By making the common ctrl key work on the backend this allows the drop down UI work for shortcuts.
A DecodeKey function has been added in Shortcut class which converts the key code to the key name. This currently only shows a name for modifier keys since those are fixed. This function would have to be moved out later since it isn't specific for shortcuts. This will be done when the keyboard unicode mapping code is integrated.
RCtrl and RAlt have not yet been handled correctly (to be done in another PR).
The changes should improve performance a bit for remapping since fixed size objects are now used instead of dynamic vectors.


Validation Steps Performed
Build and run with different types of shortcuts. RCtrl, Ctrl, RAlt, and Alt have issues, all other cases are handled.",3,0
1933,2020-04-04T03:12:27Z,2020-04-07T17:19:15Z,2020-04-07T17:19:15Z,54,631,532,"Summary of the Pull Request
Added Stylecop to the projects.
 
References

PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where a discussion took place: #889


Validation Steps Performed
verified that the settings are working.",3,4
1938,2020-04-04T16:52:32Z,2020-04-07T16:30:12Z,2020-04-07T16:30:13Z,1,12,2,"Summary of the Pull Request
Wait for showCmd parameter change on moving window into zone.
 
References

PR Checklist

 Applies to #1685
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
At the moment when windows position is changed to be applied to zone, KeePass window has SW_SHOWMINIMIZED flag. For this reason it minimizes again as expected.

Validation Steps Performed

Configure KeePass to ""Minimize to tray""
Configure FancyZones as follows:

Apply layout (doesn't matter, custom or template, but the more zones it contains, the bigger chance to catch a bug)
Open KeePass
Apply KeePass to zone
Minimize KeePass winow
Restore KeePass from tray

KeePass window expected to be opened.",4,4
1953,2020-04-06T10:15:33Z,2020-04-08T13:12:04Z,2020-04-08T13:12:04Z,1,29,14,"Summary of the Pull Request

changed method of detecting if movSizeEvent is move or resize. Application now checks if cursor is set to resize type

PR Checklist

 Applies to #1420

Validation Steps Performed

tested manualy
tested on custom cursors and works as expected",5,1
1955,2020-04-06T10:38:25Z,2020-04-10T14:09:09Z,2020-04-10T14:09:09Z,11,326,126,"Summary of the Pull Request
This PR implements basic support for allowing to snap to multiple zones at once, while minimizing impact on other features. More functionality will be added in separate upcoming PRs.
 
References
Related to #335

PR Checklist

 Applies to #335
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Added a few unit tests, also, tested manually. All tests pass and the feature works as expected.",8,14
1956,2020-04-06T13:17:18Z,2020-04-07T22:02:14Z,2020-04-07T22:02:14Z,3,271,14,"ning in another virtual desktop just like Windows Alt-Tab

Summary of the Pull Request
 
References

PR Checklist

 Applies to #1886
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
OpenWindows.cs : bool WindowEnumerationCallBack(IntPtr hwnd, IntPtr lParam)
Listing apps was modified in order to detect Alt-Tab applications including UWP and also excluding cloaked UWP apps (running in background) which is also a condition that is assigned to Win32 applications running in another Virtual Desktop.
Window.cs
Added IsWindow to determine whether the window handle identifies an existing window.
Added IsWindowCloaked to detect a window has been suppressed from the screen by the shell.
InteropAndHelpers.cs
Added require DLLImports in order to changes work.
WinAPI added:

GetWindow, enum included GetWindowCmd for the relationship
GetWindowLong, included constants and enums for its parameters like GWL_EXSTYLE and the flags to test against in ExtendedWindowStyles. e.g. WS_EX_TOOLWINDOW and WS_EX_APPWINDOW are flags that determine the listing of windows in Alt-Tab
IsWindow, to determine if handle is a window
GetProp, to retrieve a property list of the window, specifically ITaskList_Deleted which many applications use when they hide temporarily like for systray or a hotkey show/hide.
DwmGetWindowAttribute, to detect cloaked windows, as mentioned by Mr. Raymond Chen about the correct way to detect suppressed windows from screen by the shell


Validation Steps Performed
Launched many applications of different window properties, including UWP apps, systray running apps, and checked manually all listed apps compared against the Windows Alt-Tab, since there is no official documentation from Microsoft Windows on how to detect like Alt-Tab, this was the only way.",2,5
1957,2020-04-06T14:41:29Z,2020-04-07T10:17:19Z,2020-04-07T10:17:19Z,1,8,9,"Opening settings when user is opening already running Powertoys

PR Checklist

 Applies to #1208
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manually tested",6,2
1964,2020-04-07T00:38:30Z,2020-04-08T17:21:41Z,2020-04-08T17:21:41Z,19,839,256,"Summary of the Pull Request
Power Launcher Settings page.
 
References

PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Added localization strings
JSON scheme might change when this branch is integrated with PowerLauncher
Solved issue with settings file creation when no PowerToy folder is present beforehand.
HotkeySettingsControl behaves the same as the old HotkeySettingsControl.js.
HotkeySettingsControl does not display punctuation characters properly, instead it shows the corresponding VirtualKey enum code. Could not figure out a MapVirtualKey equivalent in UWP.


Validation Steps Performed

Settings file is written and saved correctly. More through testing should be done after integrating with PowerLauncher.",1,4
1974,2020-04-07T13:41:59Z,2020-04-08T16:22:44Z,2020-04-08T16:22:44Z,1,19,13,"Summary of the Pull Request
Fancy zones is now taking into consideration that window could be non-resizable.
In that case it will place the window into zone without resizing it
PR Checklist

 Applies to #1883",4,9
1979,2020-04-07T16:23:02Z,2020-04-08T20:53:09Z,2020-04-08T20:53:09Z,14,434,385,"Summary of the Pull Request
Adding settings UI page of Keyboard Manager.  Added initial implementation of Keyboard Manager page on the settings. Logic to store and load the settings will be addressed in a separate PR after defining the schema of settings for Keyboard manager.
 
References

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Validate the UI locally.
Current Keyboard Manager Settings UI:",5,8
1983,2020-04-07T18:01:52Z,2020-04-07T22:19:23Z,2020-04-07T22:19:23Z,3,16,5,"Summary of the Pull Request
This PR removes the duplicate calls to Trace::InvokedRet. Now if the Invoke function is returns then Trace::Invoke and Trace::InvokeRet are called exactly once.
Also added Trace:QueryContextMenuError which gets called when InsertMenuItem fails.

PR Checklist

 Applies to #1981
 CLA signed. If not, go over here and sign the CLA",2,0
1992,2020-04-07T21:20:01Z,,2020-04-14T03:25:32Z,1,1,1,"Changed Shortcut location on the start menu
I can the shortcut directory to the ProgramMenuFolder which is the directory for the start menu
The change was tested by reinstalling powerToys and checking to see if the location was updated.
crutkas: xref #1494 for tracking issue",6,14
1996,2020-04-08T00:55:57Z,2020-04-08T21:31:31Z,2020-04-08T21:31:31Z,6,142,72,"Summary of the Pull Request
Change displayed text in Detect key/shortcut to appear like buttons
 
References

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Keys are displayed as TextBlocks inside Border blocks to appear like buttons.
This change is not theme ready, since the colors would not change in dark mode.
Applies both to the shorcut modal and the single key modal.


Validation Steps Performed
Manual testing, could set up shorcuts and single key mappings.",5,2
2000,2020-04-08T05:13:28Z,2020-04-08T13:59:18Z,2020-04-08T13:59:18Z,1,1,1,"Summary of the Pull Request
Shifted right and bottom borders for 1 pixel inside the zone. These borders are considered to be outside of zone rectangle and on fullscreen layouts they were outside of screen either. In addition to that there wasn't space between zones when space between zone was set to 1.
 
References

PR Checklist

 Applies to #1877
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Spacing set to 0:

Spacing set to 1:",2,0
2001,2020-04-08T08:43:04Z,2020-04-08T10:19:58Z,2020-04-08T10:19:58Z,1,4,4,"Summary of the Pull Request

PR Checklist

 Applies to #1801

Detailed Description of the Pull Request / Additional comments
See Icon description from wix manual

Validation Steps Performed

installed with this commit: icon works
installed w/o this commit: no icon",2,0
2006,2020-04-08T12:35:55Z,2020-04-10T15:52:16Z,2020-04-10T15:52:16Z,9,173,205,"Summary of the Pull Request
Changed behavior of element appear waiting: increased waiting time for settings reading and replaced fixed time interval to WaitElement method.
Also updated PowerToys launch: removed additional capabilities.
 
References

PR Checklist

 Applies to #1875
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
2014,2020-04-09T03:36:17Z,2020-04-10T13:41:19Z,2020-04-10T13:41:20Z,5,51,20,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #1495
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,2
2017,2020-04-09T10:26:50Z,2020-04-14T08:40:31Z,2020-04-14T08:40:31Z,1,24,0,Added unit test for Fancy zones preserve size of non-resizable windows #1974,3,0
2020,2020-04-09T12:46:03Z,2020-04-09T13:47:26Z,2020-04-09T13:47:26Z,1,10,1,"Summary of the Pull Request
Check ShowSpacing flag in SplitterThickness.
 
References

PR Checklist

 Applies to #2007
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
2021,2020-04-09T12:55:56Z,2020-04-09T15:20:18Z,2020-04-09T15:20:18Z,2,358,99,"Updates nested dependencies so that a vulnerable version of minimist is not being used.

Summary of the Pull Request
Updates some nested dependencies in the web settings so that a vulnerable version of minimist is not used.
npm audit finds 0 vulnerabilities after this change.
Fixes: #1921
 
References

PR Checklist

 Applies to #1921
 CLA signed. If not, go over here and sign the CLA
 Tests passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
As react-snap has received no updates yet for this vulnerability and it's locking down a version of mkdirp which is vulnerable, a preinstall npm hook is used to force mkdirp resolve a version which fixes this vulnerability.

Validation Steps Performed
The fact that these changes caused no unintended effects was tested by running npm run build and verifying that src/settings/settings-html/dist/bundle.js, src/settings/settings-html/index-dark.html and src/settings/settings-html/index.html remain unchanged, using git diff.",2,0
2029,2020-04-09T19:20:20Z,2020-04-13T18:41:33Z,2020-04-13T18:41:33Z,16,333,239,"Summary of the Pull Request
Keyboard Layout is detected by calling GetKeyboardLayout on every GetKeyName call to check if keyboard layout changed.
 
References

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

The initial approach of handling the WM_INPUTLANGUAGECHANGED message did not work as intended, because the windows would stop getting the message unexpectedly after having any sort of user input in them.
Calling GetKeyboardLayout repeatedly was not found to incur in a significant performance cost, after having profiled a stress test scenario (mashing keys at the Detect Key screen).


Validation Steps Performed
Manually added key mappings, the Keys were displayed as intended.",3,3
2031,2020-04-09T22:10:55Z,2020-04-10T19:11:22Z,2020-04-10T19:11:22Z,2,63,78,"Set the right styles and margins for all UI elements inline with the other pages.
Updated the visuals of the ListViews (emphasizing the new key stroke and changes to the width to represent the key shape).


References
PR Checklist

[] Applies to #889
 CLA signed.
[] Tests added/passed
[] Requires documentation to be updated",2,2
2073,2020-04-10T18:00:42Z,2020-04-11T08:24:34Z,2020-04-11T08:24:34Z,4,6,3,"Summary of the Pull Request

fix incremental linking
remove unused lib
suppress false-positive WW warning


PR Checklist

 Applies to #1495
 CLA signed. If not, go over here and sign the CLA",3,1
2080,2020-04-10T23:59:47Z,2020-04-14T15:41:24Z,2020-04-14T15:41:25Z,1,0,1,removing a dep that was updated on wox proj but looks like it wasn't ported over,2,0
2090,2020-04-11T13:59:50Z,2020-04-15T21:14:17Z,2020-04-15T21:14:18Z,5,305,259,"Summary of the Pull Request
For the autocomplete feature to work properly (while doing power-rename) we need to handle all previous search and replace items and also keep it as most recently used (MRU) list. Previously those items were kept in registry, and goal of this PR is to move them to persistent JSON data file.

Implemented MRU list handler with persistent JSON storage. Migration from registry is supported.
Support  on the run changes in MRU list size.
Always check if JSON data file has changed since we loaded it last time, and do reload if needed.
Enabled flag is also migrated from registry.


PR Checklist

 Applies to #2011",6,1
2093,2020-04-12T08:30:39Z,2020-04-17T23:43:35Z,2020-04-17T23:43:35Z,15,2081,0,"Summary of the Pull Request
Move Window Walker into the launcher as a plugin. Searching and switching to windows works though a bit shakily. Aero peek doesn't work yet since we need to figure out how to keep the launcher window from being hidden (it is composed of at least 2 window handles, which means the old Aero peek api can't handle not hiding it).

PR Checklist

 Applies to #1809
 CLA signed. If not, go over here and sign the CLA
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1809


Validation Steps Performed
Searching for windows works. However, I do see some intermittent non-results, which indicates there is some sort of race condition going on in there somewhere. Its a super obvious bug so will investigate later. For now, ensuring that Window walker is converted into a plugin is good since the launcher code and API are being actively being worked on.",4,8
2103,2020-04-13T08:27:29Z,2020-04-13T15:22:38Z,2020-04-13T15:22:38Z,4,23,21,"Summary of the Pull Request

PR Checklist

 Applies to #1722


Detailed Description of the Pull Request / Additional comments

we use is_process_elevated(false) at the start of settings main() function, because it's the only place where we try to drop_elevated_privileges before using is_process_elevated, so it must not be cached.


Validation Steps Performed

restarted as admin, checked that it works",4,0
2104,2020-04-13T09:56:04Z,2020-04-13T13:00:51Z,2020-04-13T13:00:51Z,1,498,438,"Summary of the Pull Request

formatted PowerToysSetup custom actions, since it'll have changes soon for #1995


PR Checklist

 Applies to #778",2,0
2107,2020-04-13T15:11:29Z,2020-04-14T16:24:12Z,2020-04-14T16:24:12Z,13,292,40,"Summary of the Pull Request
Adding Custom Actions to trigger Keyboard Manager module to launch Remap Keyboard and Edit Shortcuts windows.

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Added bindings to trigger on button click action on new settings UI.
Added logic to allow background runner to launch window on foreground.
Updated Keyboard Manager module to launch the Windows on valid Custom Actions.


Validation Steps Performed
Validated locally by launching both Remap Keyboard and Edit Shortcuts window from the settings UI.",3,3
2108,2020-04-13T15:20:26Z,2020-04-21T17:52:28Z,2020-04-21T17:52:29Z,5,106,20,"Summary of the Pull Request

set MSI ARPINSTALLLOCATION correctly, so the installer sets install path at Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\<PRODUCT_ID>\InstallLocation
set default INSTALLFOLDER via custom action after CostFinalize as part of InstallUISequence. For some reason, adding it to InstallExecuteSequence this early doesn't have any effect, so it won't work in no UI/basic UI installer mode
fix deprecation warning by removing Action=""createAndRemoveOnUninstall""
wix custom actions project: move headers to PCH and link libs via .vcxproj, treat warnings as errors
wix custom actions project: implement getMsiPackageInstalledPath, which checks aforementioned InstallLocation and uses PowerToys.exe component's GUID as a fallback method (for the previous versions). For details, see my StackOverflow answer


PR Checklist

 Applies to #1995


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed

installed PT 0.15, compiled the installer, launched it the usual way and with MsiInstallProductW, verified that it works.
same as above, but with a Version changed to 0.16.3 instead of 0.15.",6,1
2110,2020-04-13T18:37:52Z,2020-04-21T17:57:22Z,2020-04-21T17:57:22Z,6,80,1,"Summary of the Pull Request
Since handling of virtual desktop switch is asynchronous, event indicating that new window is created can appear in the meantime resulting in window being assigned to invalid zone. Compare virtual desktop id on which window is created with the currently active virtual desktop id, and continue handling window created event only in case these two match.

PR Checklist

 Applies to #1236


Validation Steps Performed

Make sure you have Move newly created windows to their last known zone on.
Create a custom layout with two zones and apply it to both virtual desktops.
On first virtual desktop snap Notepad on zone 1.
On second virtual desktop snap Notepad on zone 2.
Switch back and forth between virtual desktops.

Expected result: Both windows stay assigned to their zones on different virtual desktops.",5,3
2115,2020-04-13T22:25:38Z,,2020-04-17T19:35:28Z,2,67,89,"Summary of the Pull Request
This PR contains fixes for some issues such as -

Indexer throws out of bounds exception when search keyword starts with '*'
Unexpected search results when searching for folder/file.

It also adds a functionality for treating spaces as the logical AND operator - Reference to similar issue in WW (#1913)

PR Checklist

 Applies to #2042, #2039, #2048
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Changes made in this PR are as follows -

Fix for Indexer throws out of bounds exception when search keyword starts with '*'
Removed the reference to pattern which was adding regex search functionality and instead added an asterisk at the start of every keyword. This generates the correct SQL query programmatically using the GenerateSQLFromUserQuery.
Unexpected search results when searching for folder/file - Fixed this by using the System.FileName Windows Property instead of System.Title.
Spaces are treated as AND and search results quality is improved.



Validation Steps Performed

Added tests for validating the new functionality.
All Wox tests pass.
Manually validated it as shown in the above plugin. We no longer get an exception when we search for '*'.",3,0
2116,2020-04-14T00:29:12Z,2020-04-17T08:43:37Z,2020-04-17T08:43:37Z,1,4,7,"Creating a new pull request, implementing suggestions from #1992",4,5
2117,2020-04-14T00:37:21Z,2020-04-17T08:47:25Z,2020-04-17T08:47:25Z,1,2,1,"[PowerToys] Show version on tooltip

Summary of the Pull Request
 
References

PR Checklist

[] Applies to #1532
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,6
2118,2020-04-14T05:00:06Z,2020-04-14T17:42:28Z,2020-04-14T17:42:28Z,8,277,268,"Summary of the Pull Request
Adding in the attribution
 
References

PR Checklist

[] Applies to #862
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
2121,2020-04-14T09:14:05Z,2020-04-15T10:34:12Z,2020-04-15T10:34:12Z,3,17,7,"Summary of the Pull Request
Fix for bug when placing dpi unaware window such as Notepad++ in left of right part of monitor. In that application gap of about 7px was left or right.
This fixes only single-monitor scenario
It skips correction for dpi unaware window that leaves a gap
PR Checklist

 Applies to ##1967

Validation Steps Performed

manual testing ( notepad++, git extensions, emacs)
added unit test that passes",2,0
2124,2020-04-14T16:28:15Z,2020-04-16T18:01:39Z,2020-04-16T18:01:39Z,16,43,421,"Summary of the Pull Request
Display thumbnail for search results in Launcher

PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments

Changed from System.Windows.Media to Windows.UI.Xaml.Media namespace to render Image in format required by UWP.
Added code to convert WPF BitmapSource to UWP BitmapImage.
Removed Image plating code for UWP program to match spec.


Validation Steps Performed

All Wox tests pass.
Launcher displays Icons for search results.",4,1
2129,2020-04-14T20:36:39Z,2020-04-17T22:25:09Z,2020-04-17T22:25:09Z,37,1537,503,"Summary of the Pull Request

Added tests for the implemented settings.
Refactored code - move business logic to the ViewModels.

 
References

PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where a discussion took place: #889


Validation Steps Performed

Ran tests",3,0
2133,2020-04-15T04:09:44Z,2020-04-15T22:10:28Z,2020-04-15T22:10:28Z,10,14,26,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #2079
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,0
2135,2020-04-15T06:30:09Z,2020-04-16T16:16:48Z,2020-04-16T16:16:49Z,10,594,38,"Summary of the Pull Request
Apply/Discard changes on the Detect SingleKey/Shortcut ContentDialog by holding down Enter/Escape.
 
References

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

When the detect single key/shortcut content dialog is created, two KeyDelays objects are registered to track the Escape and Enter keys.
For each KeyDelay object, three callbacks are provided, one for Short Press, and two for Long Press (when pressed initially and when released).
Long Press triggers when the user holds the key for more that 0.9 seconds.
When the callback function needs to close the window, the UnregisterKeyDelay code should be run from a different thread, otherwise there would be a deadlock.
The Detect shortcut content dialog takes into account single key remapping when tracking Escape and Enter.


Validation Steps Performed

Holding down the Escape key has the same effect as clicking on Cancel on the content dialog.
Holding down the Enter key has the same effect as clicking (and holding) on OK on the content dialog.
Pressing and releasing early either the Enter or Escape key detects the key value.",3,1
2140,2020-04-15T15:52:07Z,2020-04-18T23:12:26Z,2020-04-18T23:12:26Z,18,684,245,"Summary of the Pull Request
This PR adds support for the user to select the keys from a drop down for the Edit Keyboard and Edit Shortcuts windows.

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Key list is arranged as Modifier keys, character keys, special keys (like Enter, Space, etc) and then unknown keys (which dont have a name just a virtual code). We can choose to not show the unknown keys in the future. In case of Edit shortcuts there is an additional ""None"" key at the start which is used to remove the drop down.
Since in the current key names some key representations could be repeated (for example there are two / keys on the keyboard), key selections are made with a second vector which has the corresponding virtual key code for each key name, rather than searching from the keyboard map. This way we ensure a one-to-one mapping since we search index to key code and not key name to key code.
KeyType helper functions added to categorize keys depending on the type of modifier or if it is an action key.
Flyout warnings have been added to manage all the scenarios in the drop down input for Edit Shortcuts. These include warnings for making sure that there is atleast 2 keys, there must be exactly one action key, there needs to be a modifier key, action key must be at the end, and a modifier cannot be repeated (example LCtrl and RCtrl).
Changed the logic for creating the custom controls to dynamic allocation using unique_ptr since there were cases where the objects were going out of scope and variables were being referenced to result in garbage values.


Validation Steps Performed
From the landing page try both the redefine a shortcut and remap keyboard options and use drop downs as well as detect UI.",3,0
2141,2020-04-15T16:22:29Z,2020-04-21T07:30:13Z,2020-04-21T07:30:13Z,37,733,324,"Summary of the Pull Request

implement autoupdate flow via action runner and ""Download Updates Automatically"" functionality/option
introduce ""updating"" lib and refactor stuff
do not show duplicate toast notifications


PR Checklist

 Applies to #1686, #2028


Validation Steps Performed

changed Version to 0.15 and installed update ""now"" and ""at next launch""
verified that only a single toast notification appears in action center",5,9
2144,2020-04-15T18:55:59Z,2020-04-16T21:12:16Z,2020-04-16T21:12:16Z,1,1,1,"Summary of the Pull Request

Set the MainWindow Visibility to hidden on startup.


PR Checklist

 Applies to #2033
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

Manually verified that the PowerLauncher Application is running in the task manager but doesn't pop up.
Pressing Alt+Space triggers it.",2,1
2145,2020-04-15T20:37:15Z,2020-04-16T22:17:58Z,2020-04-16T22:17:58Z,4,26,3,"Summary of the Pull Request

This PR adds a check for extended keys which include RAlt and RCtrl. For these keys an extended key flag is included during SendInput in order to work properly. If that wasn't added you would get weird behaviour if you remapped LShift to RCtrl, held down LShift and switch to another window and then release LShift, it would act as if RCtrl was still held down.
Another issue that was fixed was for shortcuts containing Ins, Home, Pg keys, Del, End and Arrow keys. It was observed that the shortcuts would not get remapped if Num lock was turned on. It turns out that this was because for shortcut remappings we ensure that no other key states are set to ""down"" but when num lock is pressed, an undocumented 0xFF is set to down. Now we don't check the 0xFF key code.

References

https://docs.microsoft.com/en-us/windows/win32/inputdev/virtual-key-codes
https://docs.microsoft.com/en-us/windows/win32/inputdev/about-keyboard-input#extended-key-flag


PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA",2,1
2154,2020-04-16T08:40:38Z,2020-04-20T14:32:50Z,2020-04-20T14:32:50Z,1,238,87,"Summary of the Pull Request
This PR resolves the issue described in #2105, i.e. adds a mutex to the ZoneWindow class and ensures no data races occur.
 
References

PR Checklist

 Applies to #2105
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
I used a std::shared_mutex, because, for example, std::recursive_mutex does not allow concurrent reading, which is required in the OnPaint function.

Validation Steps Performed
Manually tried some basic features of FancyZones and ensured no crashing or weird artifacts happen. Also all unit tests pass.",6,6
2156,2020-04-16T10:05:28Z,2020-04-20T16:09:11Z,2020-04-20T16:09:11Z,3,68,54,"Summary of the Pull Request
Fix for bug when placing dpi unaware window such as Notepad++ in left of right part of monitor. In that application gap of about 7px was left or right.
This fixes multi-monitor with same DPI settings scenario
It skips correction that is not needed in that scenario for dpi unaware window that leaves a gap
PR Checklist

 Applies to ##1967

Validation Steps Performed

manual testing ( notepad++, git extensions, emacs)",5,3
2158,2020-04-16T10:41:08Z,2020-04-20T08:54:25Z,2020-04-20T08:54:26Z,6,117,37,"Summary of the Pull Request
FancyZones Editor: fixed splitted zones positioning in grid layouts
 
References

PR Checklist

 Applies to #2023
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
In grid layouts zone size is represented in percentage of useful screen area (without splitters and borders). When we split zone useful area is reduced. Since it is expected that zone size shouldn't be changed, all zones percents have to be recalculated.

Validation Steps Performed

manually tested with different layouts and different display scaling
added WinAppDriver tests",5,6
2161,2020-04-16T15:54:46Z,2020-04-16T18:45:28Z,2020-04-16T18:45:28Z,20,908,131,"Summary of the Pull Request

Added ViewModel implementation of the FancyZones settings.
Move Text in XAML to a localized string resource.
Added Flag to disable UI controls when the PowerToy is disabled.

Demo: https://github.com/microsoft/PowerToys/blob/user/laius/temp/doc/images/FZ_Settings_V2_Demo_GIF.gif
 
References

PR Checklist

 Applies to #889, #2127
 CLA signed. If not, go over here and sign the CLA
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #889, #2127


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed

Verified changes in the JSON settings file and the UI itself.",2,0
2177,2020-04-16T21:31:50Z,2020-04-17T04:06:03Z,2020-04-17T04:06:03Z,1,1,1,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #2171
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
2179,2020-04-16T22:09:59Z,2020-04-18T01:06:37Z,2020-04-18T01:06:37Z,2,23,12,"Summary of the Pull Request
This PR tweaks the UI to fix the issues linked below. For #2162 the change is only on the Settings window and not the C++ side.


For the banded rows, the solution using ListViewExtensions as suggested by @niels9001 here was implemented.

PR Checklist

 Applies to #2162, #2163, #2164",3,0
2184,2020-04-17T16:20:17Z,2020-04-20T15:22:36Z,2020-04-20T15:22:36Z,29,640,145,"Summary of the Pull Request
Adding the logic to save the Keyboard Manager configuration to file, persist the configuration on restart and event trigger in Settings to fetch the updates in configuration.
Todo(In a separate PR ): Update the UI on settings list view to reflect the real data.

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Current Design is to save the configuration independent from the settings.json in a separate file config-name.json. This will be make the support of multiple configuration easier and configurations file can be shared or use templates.
Added a fake Key Code to represent equivalent to VK_WIN.
Current Design is updating a dummy settings-updated.json to communicate to Settings process that the config json have been successfully updated so settings process can read the file. The reason for using because FileSystemWatcher raises trigger events multiple time during a file update and the settings process have no knowledge if the runner process is still writing to the file. Alternatively, a polling approach can be used here as well to retry after sometime to see if file is free.
FileSystemWatcher fires multiple events on writing to a file. Added a logic to treat all the events fired with a Time threshold as one.


Validation Steps Performed
Validate the changes locally.",3,4
2192,2020-04-17T22:02:09Z,2020-04-18T00:24:17Z,2020-04-18T00:24:17Z,9,574,141,"Summary of the Pull Request
This PR removes autosuggestbox and adds a textbox and ListView to populate results. This was required because functionalities such as autocomplete and first item selected couldn't be integrated directly into autosuggestbox.

PR Checklist

 Applies to #2049
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments

Added ResultList.XAML which contains listview to populate search results.
Hooked keyevents (up/down/enter) and mouse click functionality (left click) to new launcher UI.

Issues not fixed :

List View resizing : If there are few results the list box doesn't reduce in height to accommodate only the required results. If MinHeight is not set, there a black background.",2,0
2201,2020-04-18T03:08:02Z,2020-04-18T07:10:17Z,2020-04-18T07:10:17Z,2,46,0,"Summary of the Pull Request

The text box now has the auto-complete feature.


PR Checklist

 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

The auto-completion text is set as soon as the selection is set to the first item.
The auto-completion is removed as soon as there is no more text in the Search box.

However, as there is a slight delay in the dropdown being produced and the first item to show up, the auto-complete text stays a bit longer when changing from one to another. The following GIF explains this scenario. However, that is the earliest point in which we get the event that the list has been modified.
We are artificially inducing a 200 ms delay in populating executing and obtaining the results. It seems like a high value and I can notice a visible change in the results showing up between 20 and 200 ms delay (on my system).
When there is a 200 ms delay -

When there is a 20 ms delay -


Validation Steps Performed

Manually tested its working.",2,0
2206,2020-04-18T09:05:17Z,,2020-05-02T10:20:40Z,4,94,6,"Summary of the Pull Request
Restore work areas on start. If virtual desktops were removed while PowerToys was off, settings would be updated.
 
References

PR Checklist

 Applies to #1312
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
manually tested",5,3
2211,2020-04-18T17:47:16Z,2020-04-18T21:46:02Z,2020-04-18T21:46:02Z,15,655,727,"Summary of the Pull Request
This PR converts the items that were formerly context menu commands into buttons that can be selected on the listviewitem of the suggestion box.

Detailed Description of the Pull Request / Additional comments

Manually handles tabs input to prevent the focus from shifting away from the selected item.
Loads the context menu items for each result on Selection or PointerEntered.

The following issues will need to be solved separately.

Manually handling tabbing breaks narrator support.   Need to manually add narrator support.
Tabbing should go to the next context menu item before going to the next row in the suggestlist.
Context buttons need to be styled.
Hotkey events need to be handled for context menu buttons.
Access is denied on opening the containing folder of a UWP application.
Window Walker doesn't have context menu items.
Windows Search Indexer plugin doesn't have context menu items.
Open in command prompt doesn't exist.
Need to add in functionality for 'Set As Topmost result for query' -- the code removed in e07e98a will need to be added back to the correct place.  I missed this functionality in the spec.  When I originally removed it:




Requirement
Description
Priority




29
Users can pin selected application/file/folder at the top of the search result which ties to the search term they input in the search box
2



Screen Shot


Validation Steps Performed
Validated manually",5,6
2214,2020-04-18T22:07:18Z,2020-04-19T00:43:20Z,2020-04-19T00:43:20Z,2,109,4,"Adding context buttons to Indexer plugin.  This allows for the following:

[Files] Open Containing folder
[Folders/Files] Copy Path


Summary of the Pull Request

This just adds open file location and copy path context buttons to the results specified by the windows search indexer plugin.


Detailed Description of the Pull Request / Additional comments


Validation Steps Performed
Ran manually",2,0
2217,2020-04-18T23:35:21Z,2020-04-21T20:40:32Z,2020-04-21T20:40:32Z,1,60,3,"Summary of the Pull Request
Remapping the common version of Ctrl/Alt/Shift behaves differently from other keys since clicking those keys those not actually result in a VK_CONTROL, VK_MENU and VK_SHIFT. Those key codes can be used in SendInput or GetAsyncKeyState but they are not naturally generated on key press (only the L or R version is generated). To solve this without modifying the remap logic, we tweak the remappings while saving and loading on the UI.
Example:
If user chooses to remap Alt -> A on the UI, we store LAlt -> A and RAlt -> B in the map.
While loading the existing maps into the UI, we check if LAlt and RAlt are both remapped, and if they are remapped to the same key then we combine them to Alt while showing them in the UI. This also makes it more consistent. However on the UI someone may still remap both LAlt and Alt, this has not been blocked. In this case whichever is first gets priority. If LAlt, is first then the LAlt remapping is applied and the RAlt is remapped to whatever Alt was remapped to. If Alt is first then both are remapped to the same value.

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA",2,0
2218,2020-04-18T23:46:48Z,2020-04-19T00:49:32Z,2020-04-19T00:49:32Z,2,17,1,"Summary of the Pull Request
The white background that was previously showing up when there were less than 4 results has been removed.

PR Checklist

 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

The size of 4 elements is set to 300, so 75 for each item.
Used the containerContentChanged event to trigger it.


Validation Steps Performed

Manually validated it.",2,0
2220,2020-04-19T00:27:06Z,2020-04-21T17:25:15Z,2020-04-21T17:25:15Z,5,19,3,"Summary of the Pull Request
This PR fixes the keyboard manager interaction with shortcut guide when Win key is swapped.
The KEYBOARDMANAGER_INJECTED_FLAG which is used to distinguish key events generated by KBM was moved to a shared_constants.h header file in the PowerToys common library so that it is accessible by all the projects. In Shortcut Guide at the step where SendInput Win key is done, we add the flag, so that those events are ignored by KBM and they don't get remapped.

PR Checklist

 Applies to #2219
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Tried remapping LCtrl to LWin, LWin to LCtrl and swapping them. Also tried LWin to LCtrl and LAlt to LWin.",2,0
2221,2020-04-19T01:07:27Z,2020-04-21T20:43:53Z,2020-04-21T20:43:53Z,1,4,3,"Summary of the Pull Request
This PR fixes an issue where the key name list would change depending on if Caps Lock, Shift, etc were toggled.
The ToUnicodeEx function takes the keyboard state as argument, and earlier we were getting this using GetKeyboardState. This can be avoid by passing an array with all values set to 0, so that it considers no key to be pressed. As suggested by @saahmedm in #2198, I have only set the Caps Lock to be on, so that in case of English we get capital letters for the key names. This would have different effects on other languages (In French for example, Caps Lock behaves like Shift and gives the second character for all characters including symbols/numbers).

PR Checklist

 Applies to #2198
 CLA signed. If not, go over here and sign the CLA",2,0
2222,2020-04-19T01:13:07Z,2020-04-19T18:42:48Z,2020-04-19T18:42:48Z,5,127,25,"Summary of the Pull Request
This PR allows us to tab between the context buttons for each of the results.  This is needed to be handled manually because we want to keep the focus on the textbox while the user is tabbing or using the arrow keys.   It's not super clear to the user that the row is selected when the context buttons are unselected.  We may need a new visual treatment.


Validation Steps Performed

 Made sure tabing forward navigats the buttons correct  order.
 Made sure tabbing backward navigates through the buttons in reverse order.
 Made sure tabbing will also select the row itself.
 Verified hitting enter on the row opens the result.
 Verified hitting enter on the context buttons executes the expected command.",3,2
2223,2020-04-19T02:26:16Z,2020-04-21T00:18:39Z,2020-04-21T00:18:39Z,1,1,1,self-explanatory,2,0
2224,2020-04-19T03:10:38Z,2020-04-19T04:37:36Z,2020-04-19T04:37:36Z,4,378,430,"Summary of the Pull Request
This PR adds adds rounded corner and backdrops to the search box and listview. It also fixes the issue with multiple alt+space keypress on launch to show search box.

PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated the working of launcher.",3,1
2232,2020-04-19T19:32:52Z,2020-04-19T23:25:44Z,2020-04-19T23:25:44Z,18,190,155,"Summary of the Pull Request
Allows users to use shortcuts for actions specific to the selected row.  eg.  CTRL-SHIFT-ENTER = Run as Admin, Ctrl-Shift-E open folder location, etc.
 
References

Detailed Description of the Pull Request / Additional comments

Add new object ContextMenuResult instead instead of reusing Result for both query results and context menu results.
Binding KeyboardAccelerator keys to contextmenuitemviewmodel
Enabling and disabling contextmenu items when selecting or deselecting each row.  Because we are manually maintaining selectionwe can't use ScopeOwners as the textbox is really the only item ever in focus.

@crutkas .  #1 is an explicit breaking change if we plan to support Wox plugins directly. However, I would rather be explicit with the data type, and write and adapter if we need to support existing wox plugins in the future.  The design of how these actions are executed is quite different, so I doubt wox plugins would work out of the box anyway right now.


Validation Steps Performed
The following items are being validated by setting breakpoints on each of the modified actions and verifying that the action triggers from the expected accelerator keys

 Executed Run As Admin on a Win32 Program result.
 Executed Open File Location on a Win32 Program result
  Executed Run as Admin on a Shell Program result  -- Typed ""> ping www.bing.com""
 Executed Copy Path on a Indexer Plugin result.
 Executed Open File Location on Indexer Plugin result.
 Executed Copy Path on a Folder Plugin result.
 Executed Open File Location on a File plugin result.
 Verified that Actions for a previously selected row don't fire.  IOW - They are disabled.",3,2
2233,2020-04-19T19:35:31Z,2020-04-21T21:14:51Z,2020-04-21T21:14:51Z,12,45,62,"Summary of the Pull Request
This PR changes the output directory of the KBM UI and KBM Common projects to the modules folder. This was required as a first step for adding KBM to the MSI (#2148). The PR also changes the intermediate dirs for the KBM projects as per #1640.

PR Checklist

 Applies to #2148
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

KBM Common output dir changed to modules/.
KBM UI project was earlier a DLL. This had to be changed to a static lib (following the approach taken by PowerRename and other powertoys), since only the main extension dll gets loaded from the runner, and this fails if the KBMUI dll file is not in the same folder as the runner exe file. Another workaround would be to add a LoadLibrary call in the runner, but that would involve too many changes to common PowerToys code. The output dir was also changed to modules/
After changing the folders and compiling there were some runtime errors occuring with the to_hstring function when directly with constant strings (example: to_hstring(L""Type key"")). While checking this I observed to_hstring was actually not needed, as wchar strings can get automatically type casted by functions requiring hstring as argument. All those unnecessary to_hstring calls were removed.
Removed some helper functions which were now unused",3,0
2235,2020-04-19T23:25:22Z,2020-04-20T08:34:37Z,2020-04-20T08:34:37Z,7,162,149,"Summary of the Pull Request
Added functionality to change launcher color based on Dark/Light mode switching in system settings.

PR Checklist

 Applies to #2044
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manually verified that colors are switched when the Light/Dark mode is changed in system settings.",5,6
2237,2020-04-20T01:33:18Z,2020-04-20T15:59:35Z,2020-04-20T15:59:35Z,2,11,12,"Summary of the Pull Request
The message for ""Remap successful"" and ""All remappings were not successfully applied"" were earlier just text on the side of the buttons. Now it is moved to a flyout.
The exact warnings can be tweaked in a later PR with more information on why the remapping failed

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
Success:

Unsuccesful:",2,0
2242,2020-04-20T06:32:47Z,2020-04-20T21:33:27Z,2020-04-20T21:33:28Z,1,237,0,"Summary of the Pull Request

Launcher can now be installed using MSI.
Product.wxs file was modified.


PR Checklist

 Applies to #2147
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Product.wxs file now has launcher components, directories and files being set.
To build the MSI follow these instructions.


Validation Steps Performed

Verified that the Program Files/PowerToys/modules/launcher folder contains the same files as that of x64/config/modules/launcher.
Manually validated that all the plugins work on installing the msi.",3,0
2246,2020-04-20T10:55:29Z,2020-04-29T20:02:19Z,2020-04-29T20:02:19Z,132,544,228,"Summary of the Pull Request
Moves PowerToys off SDK-provided cppwinrt (1.x) to nuget-provided cppwinrt (2.x). (This also resolves 17134 and 19041 SDK compilation issues.)
References
#1907 - PowerToys doesn't compile with SDKs higher than 10.0.18362.0
PR Checklist

 Applies to #1907
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #1907

Detailed Description of the Pull Request / Additional comments

src/Directory.Build.props introduced to set important global properties (e.g. for cppwinrt compilation success)
Precompiled headers/compilation units all renamed from stdafx to pch, required for cppwinrt/sdk symbiosis
Microsoft.Windows.CppWinRT nuget added to relevant projects. This will rewire project internals at runtime to execute the bundled cppwinrt.exe, generate projection headers, and more. This means identical looking projection headers will be generated for every project. This duplicitous work appears to be per cppwinrt design.
Standardized cpp language standard solution-wide
Due to older platform SDK targets, Conformance Mode has been disabled solution-wide. If/when a conforming Windows SDK ships, we can revisit this.

Validation Steps Performed
Basic smoke test, app launches and modules appear to work.",6,2
2247,2020-04-20T12:01:34Z,2020-04-20T13:03:27Z,2020-04-20T13:03:27Z,14,450,49,"Summary of the Pull Request
Added Shortcut guide settings.
 
References

PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where a discussion took place: #889


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",1,0
2248,2020-04-20T16:12:08Z,2020-04-24T00:11:03Z,2020-04-24T00:11:03Z,38,820,1515,"Summary of the Pull Request
Replace ATL based named pipe server wrapper with a C++/CLI wrapper.
 
References
#1597

PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments


Depends on #2249


The implementation wraps around the Win32 based named pipe server in the common library. This wrapper is C++/CLI based instead of ATL based, and is part of the interop library.



Validation Steps Performed
Verified it works on both settings V1 and Settings V2.",2,1
2249,2020-04-20T16:38:19Z,2020-04-21T04:01:21Z,2020-04-21T04:01:21Z,31,868,350,"Summary of the Pull Request
The LayoutMap class from KeyboardManagerCommon was moved to common in order to reuse it in HotkeySettingsControl. In order to call the c++ code from C#, the  interop project was created, which serves as a C++/CLI wrapper around the native code.
 
References

PR Checklist

 Applies to #889
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

There is also the limitation that projects compiled with the \clr flag cannot use the \MT setting.
This means the C++/CLI wrapper has to use the \MD setting, and this also applies to the common library it wraps around.
To prevent from changing the \MT flag in common, a common-md-flag project was set up that references the same files as common: keyboard_layout.h, keyboard_layout_impl.h and keyboard_layout.cpp


Validation Steps Performed
Manually tested Keyboard Manager works properly, and HotkeySettingsControls as well.",2,0
2250,2020-04-20T16:45:45Z,2020-04-22T02:46:11Z,2020-04-22T02:46:11Z,1,1,1,"Summary of the Pull Request

This is happening because of the code in the shell plugin.
The Shell plugin has it's own code to override the Win+R key and because of the way they are creating and handling hooks, once we press Win+R, the Win key must be pressed again to release it. So basically, they're trying to simulate the Win key press, however since simulating only the win key press would pop up the start menu, they are simulating Win+Ctrl which is the same shortcut as that of ww.

To unblock us and mitigate this issue for now, I used the BackSpace keystroke instead of Control, so we would be simulating a Win+BackSpace keystroke.
NOTE Wox uses NHotkey.wpf nuget package for handling hotkeys and we would like the code for modifying hotkeys to be the same across all of powerToys and as that involves major code refactoring it would be done for v1.

PR Checklist

 Applies to #2035
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

Manually validated that Win+R no longer pops up WindowWalker.",2,0
2255,2020-04-20T20:42:51Z,2020-04-21T00:33:31Z,2020-04-21T00:33:31Z,18,779,476,"Summary of the Pull Request
Merge master into dev/PowerLauncher

PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually verified the working of launcher plugins.",9,0
2256,2020-04-20T20:50:20Z,2020-04-21T20:42:07Z,2020-04-21T20:42:07Z,7,6,36,"Summary of the Pull Request
This PR changes the colors of all the elements in the Edit Keyboard and Edit Shortcuts windows to default as per the OS theme. The theme does not change when the PowerToys settings theme is changed.
Light theme


Dark theme



PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Background and foreground properties removed for all the controls. By removing that, the control using the default WinUI colors, which follow the selected OS theme.
RequestTheme(Light) was removed since that will only give colors for the light theme.
The two places where we manually set the color had to be adjusted:

For the keys in the Type key and Type Shortcut UI, we were using the Border Xaml control with Gray background. This was changes to the SystemBaseLowColor theme resource (which matches the same color in light theme and had a corresponding dark theme variant as well). This does not get refreshed when the OS theme is changed, however the moment another key is clicked the correct color is loaded.
For the Hold Enter to exit animation, we were changing the OK button to dark gray. This was changed to SystemBaseMediumLowColor.


Windows::UI::Xaml::Application::Current().Resources().Lookup(box_value(L""SystemControlBackgroundBaseLowBrush"")).as<Windows::UI::Xaml::Media::SolidColorBrush>() is the code equivalent of {ThemeResource SystemControlBackgroundBaseLowBrush} in XAML.",3,2
2271,2020-04-21T01:38:40Z,2020-04-21T02:53:21Z,2020-04-21T02:53:21Z,30,1280,633,"Summary of the Pull Request

Removed AutosuggestBox and replaced it with Textbox and ListView
Autocomplete functionality.
Added context buttons, navigation, keyboard accelerators, selection, and commands.
Dark/Light mode for launcher.


PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed

 Manually validated working of all plugins
 Tested the working of context menu items.
 Tested dark/light switching on changing system theme.
 Tested autocomplete functionality.",3,2
2272,2020-04-21T03:37:11Z,2020-04-21T15:43:29Z,2020-04-21T15:43:30Z,2,4,4,"Summary of the Pull Request

The SystemControlHighlightAccentBrush was being set to white (in light mode) which was causing the selection highlight to also be white, therefore selecting the text was showing a white text box.
Using the SystemChromeLow theme instead and setting it to the default theme resource so that nothing else in the app gets affected.


PR Checklist

 Issue #2269
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed


Light Mode -



Dark mode -",2,0
2273,2020-04-21T06:32:26Z,2020-04-21T16:42:17Z,2020-04-21T16:42:17Z,2,9,0,"Summary of the Pull Request
This PR removes default transitions from UWP Listview control.

PR Checklist

 Applies to #2267
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated that list view animation is no longer triggered.
Example repro : Type Maps and change it to Ma. The fly in effect should not be present.",2,0
2286,2020-04-21T17:40:25Z,2020-04-21T19:37:29Z,2020-04-21T19:37:29Z,1,13,11,"Summary of the Pull Request

Switching ListView to GridView for horizontal layout.  This fixes the issue of the ListViewItem having being stretched horizontally.
Adding a right margin to the gridview so buttons don't push up against the edge.
Setting the height to 46.  (I don't really understand this).  The grid view items also add a bit of padding veritcally.  46 is a value that adds some buffer to the height of the buttons but includes enough room for margins).  It's a bit of a magic number that I would love to make pixel perfect, but this will likely get re-styled anyway.
Adding background to buttons.


[] Applies to #2261

Detailed Description of the Pull Request / Additional comments


Validation Steps Performed
Manually Validated",2,0
2290,2020-04-21T17:55:54Z,2020-04-21T19:55:05Z,2020-04-21T19:55:05Z,3,421,420,"Summary of the Pull Request

Added missing c++17 compile flag to common-md-flag
Removed .Net Native compilation from Release config in Settings.UI and Settings.UnitTests
This was necessary because .Net Native does not support mixed assemblies, like PowerToysInterop.
We can restore this flag in the future by preventing Settings.UI from using PowerToysInterop through Settings.Lib, and instead separate the UWP Interop in its own Windows Runtime Component.",2,0
2292,2020-04-21T17:59:50Z,2020-04-21T19:56:30Z,2020-04-21T19:56:30Z,20,0,887,"Summary of the Pull Request
Removed folder plugin from launcher

PR Checklist

 Applies to #2268
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated that folder plugin is not queried and other plugins are working as expected.",2,0
2298,2020-04-21T20:18:51Z,2020-04-21T22:50:55Z,2020-04-21T22:50:55Z,1,0,6,"Summary of the Pull Request
due to how UWP apps are deployed via VS, our solution was installing / deploying the wrapper app.

PR Checklist

 Applies to #2282


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
uninstall PowerLauncher.UI from app & features
F5
You should get this below:",2,0
2299,2020-04-21T20:27:49Z,2020-04-23T16:14:16Z,2020-04-23T16:14:16Z,8,327,232,"Summary of the Pull Request
This PR changes the approach of adding the controls on the edit keyboard and edit shortcut window from stack panels to a single grid with three columns. Rows are dynamically added on clicking the + key. The header was also changed to a relative layout. The PR also fixes an indexing bug, where adding and deleting rows in the tables could result in errors on applying the settings.

PR Checklist

 Applies to #6, #2323
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Edit keyboard and Edit shortcut header changed to relative layout
3 column Grid used for all the key/shortcut controls
Instead of using a fixed row index, the row index is now calculated based on the index of the control in the grid in the UI. Since these indices are reliable and match what is shown on the UI, the index will always match the buffer vector where the values are stored.
Moved drop down selection handlers out of the constructor to a separate function. This was done since all the associated controls may not be initialized at the constructor stage (some stack panels in the parent class would be null).
Changed the C++ window logic to account for resizing. Earlier only on the WM_PAINT message the Xaml UI would be resized. However that message is not sent if the window is resized smaller. That has now been fixed.

Screenshots",2,0
2302,2020-04-21T23:36:35Z,,2020-04-23T17:33:56Z,36,325,239,"Summary of the Pull Request
Changes made in the following PR-

Added the runtime folders to the MSI.
Modified the PowerLauncher.UI.csproj file so that the PowerLauncher.csproj can be published. This is to ensure that all the required dlls are produced. This was done by setting the configuration to x64.
Code for the folder plugin has been removed as it is no longer needed.


PR Checklist

 Applies to #2147
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

Manually tested it.
Verified that all the folders are created in the C:/Program Files/PowerToys/modules/launcher folder.

Outstanding tasks

Right now, To be safe, I ensured that the runtime folders of all the architectures are copied. All of them are not required and we need to verify which ones are needed and which one's are not before removing them.",4,2
2305,2020-04-21T23:45:17Z,,2020-05-18T08:51:07Z,14,210,14,"Summary of the Pull Request
Add hotkeys to set focus to adjacent zones
Implements #2303.
References

PR Checklist

[] Applies to #xxx
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
This is pretty much copy paste based on MoveWindowIntoZoneByDirection so a potential refactor to remove code duplication is necessary.

Validation Steps Performed
None. Haven't compiled yet",4,3
2308,2020-04-22T00:33:05Z,2020-04-23T15:37:53Z,2020-04-23T15:37:53Z,9,69,46,"Summary of the Pull Request
This PR adds support for choosing Win from the drop down in both Edit Shortcuts and Edit keyboard rather than just LWin and RWin. The names of the L and R version of keys has also been changed to Key (Left) instead of LKey. For example LAlt is now Alt (Left).

PR Checklist

 Applies to #6
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

VK_WIN_BOTH moved from KBM Constants to shared constants in common so that it can be used in keyboard_layout.cpp
Similar to the handling for Alt, Ctrl, and Shift in #2217 , for single key remaps for Win key the same behaviour has been followed, i.e. remapping Win to something is equivalent to remapping both LWIN and RWIN to that key. For remaps from something to Win key, we handle it by considering the target key to be LWin since the VK_WIN_BOTH is a fake key code (unlike that used for Alt, Ctrl and Shift).
For shortcuts where remap is from Win + something, we have an additional flag in the RemapShortcut class (added in an earlier PR) which is used to remember which win key was pressed (L or R). This information is required since we need to reset the state of the key which the user presses and we cannot default to LWin, since that would result in reseting LWin while the user is pressing down RWin. For remaps to Win + something, we simply use LWin. If the shortcut is from one win shortcut to another then the corresponding pressed win key is used.",2,0
2314,2020-04-22T01:25:34Z,2020-04-22T21:55:45Z,2020-04-22T21:55:45Z,16,269,118,"Summary of the Pull Request

Single Key and Shortcut mappings are displayed in the KeyboardManager settings key.
Keyboard Manager can be enabled and disabled from the Settings page.

 
References

PR Checklist

 Applies to #889 and #2322
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,1
2315,2020-04-22T02:45:20Z,2020-04-22T20:42:09Z,2020-04-22T20:42:09Z,1,6,0,"Summary of the Pull Request

This PR selects the text whenever visibility of launcher is set to visible after being hidden.


PR Checklist

 Applies to #2269
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Text is selected every time the window is made visible.


Validation Steps Performed

Manually validated it.",3,0
2318,2020-04-22T10:03:32Z,2020-04-30T09:05:19Z,2020-04-30T09:05:19Z,2,59,14,"Summary of the Pull Request
This PR represents the beginning of long-planned work to move the control over winhooks from the PT runner to the modules themselves. Shortcut Guide is probably the easiest module to start from.
 
References
Relevant issue: #961

PR Checklist

 Applies to #961
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
The naming conventions may not follow the rest of the solution, but it's in line with the module itself.

Validation Steps Performed
Manually tested the Shortcut guide module, also tried disabling it and then enabling it again.",4,4
2320,2020-04-22T11:23:25Z,2020-04-23T14:33:57Z,2020-04-23T14:33:57Z,1,8,8,"Summary of the Pull Request

change install to per machine from per user


PR Checklist

 Applies to #1848


Validation Steps Performed

installed PT and verified that svg/md previewing works",3,3
2324,2020-04-22T15:50:39Z,2020-04-27T00:34:04Z,2020-04-27T00:34:04Z,38,1429,108,"Summary of the Pull Request

Added Image Resizer Settings
I will be adding tests during the course of the day.

 
References

PR Checklist

 Applies to #889, #2127
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where a discussion took place: #889, #2127",2,12
2327,2020-04-22T17:12:03Z,2020-04-22T22:59:33Z,2020-04-22T22:59:33Z,3,29,22,"Cleaned up the XAML and made things a bit tighter for the text dialog.  In results also, there was a 1px gap at the top.
Before:

After:",4,16
2334,2020-04-22T19:14:09Z,2020-04-22T21:19:26Z,2020-04-22T21:19:26Z,33,205,202,"Update nuget feeds across all of PT.
All unit tests passed.  We'll need to validate this again for build-feature and master",3,0
2339,2020-04-22T23:43:34Z,2020-04-30T09:16:26Z,2020-04-30T09:16:26Z,10,118,70,"Summary of the Pull Request
Current virtual desktop identifier is persisted as registry key on a per session basis, but only after the first virtual desktop switch happens. If the user hasn't switched virtual desktops in this session then this value will be empty. We are using empty GUID for virtual desktop (00000000-0000-0000-0000-000000000000) in this scenario. Once first desktop switch occurs, both desktop will be assigned valid GUID, which can be located in mentioned registry.
Instead of empty GUID, take first GUID from list of virtual desktops (available in Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VirtualDesktops). In order to make this backward compatible, migration of old persisted JSON data which is stored for empty GUID desktops is implemented. On initialization sequence this all JSON data is modified and saved again to file.

PR Checklist

 Applies to #2160",5,0
2341,2020-04-23T01:17:54Z,2020-04-23T03:50:11Z,2020-04-23T03:50:11Z,2,22,14,"Summary of the Pull Request

Run as admin is off by default
Process.Start will get called by the name of the exectuble.
If the user types in a file or directory path, we will launch explorer at that location

NOTE: Settings are cached under %AppData%\PowerLauncher\Settings\Plugins\Wox.Plugin.Shell.  You will need to delete these setting to see the change.
 
References

PR Checklist

 Applies to #2270
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2270


Validation Steps Performed
Validated locally -- see screenshots below:
Open C:\

Launch Terminal

CMD w/ Arguments

Resolving Environment Variables",2,1
2345,2020-04-23T06:03:47Z,2020-04-28T22:06:01Z,2020-04-28T22:06:02Z,491,55586,168,"Summary of the Pull Request
Merge PowerLauncher branch. Alt+Space starts PowerLauncher.
 
References
#2332

PR Checklist

 Applies to #2332
 CLA signed. If not, go over here and sign the CLA


Known issues

Clean Solution and Rebuild, otherwise the compiler complains about Wox.exe.
Enabling PowerLauncher on the Settings page is not instantanous, it takes 5-10 seconds to actually start up.
Some of the PowerLauncher settings are not implemented yet, they appear disabled in the settings page.",10,4
2346,2020-04-23T12:07:03Z,2020-04-27T10:39:48Z,2020-04-27T10:39:48Z,5,92,21,"Summary of the Pull Request

attempt to download the installer 3 times
toast cosmetic improvements


The screenshot was done before I've noticed the missed dots at the end of the sentence, that's also fixed.

PR Checklist

 Applies to #2337


Validation Steps Performed

installed PT with a version set to 0.15.2, update the PT",6,20
2347,2020-04-23T13:51:20Z,2020-04-30T09:40:14Z,2020-04-30T09:40:14Z,1,62,19,"Summary of the Pull Request
This PR moves the code which creates and uses WinHooks used in FancyZones from PowerToys to the FancyZones module, without affecting other modules.
 
References
Relevant issue: #961

PR Checklist

 Applies to #961
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Manually tested the FancyZones module, also tried disabling it and then enabling it again.",5,1
2351,2020-04-23T15:55:41Z,2020-04-25T01:03:30Z,2020-04-25T01:03:30Z,5,111,7,"Summary of the Pull Request
Similar to #2147 and #2302 , this PR adds all the necessary files for KBM and SettingsV2 to the MSI installer. Currently for .NET Core projects (in this PR's case it is the Settings.UI.Runner project), in order to get all the dependencies you have to Publish the project. The settings used for Publish were Framework Dependent, Win-x64. Confirmed the above works with both ReadyToRun enabled or disabled.
Note: Based on the structure of the SettingsV2 output files, the MSI will have to be updated for each new View page or Control that is added to the UI.

PR Checklist

 Applies to #2148 #2149
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

For settingsV2 a large number of files had to be added (as is the case for .NET Core projects). Everything in the SettingsV2.UI.Runner output folder except the runtimes folder and a runtimesconfig.dev.json (which references nuget packages on the local dev machine).
For KBM only the KeyboardManager.dll had to be added
The new PowerToysInterop.dll was also added.
There was an earlier issue with the TwoWayIPCLib.dll being linked only if the user did a build on their machine, but that has been resolved when the entire library was removed in #2248 .


Validation Steps Performed
Confirmed that it worked on my machine and I also tested it on a new user.",2,2
2352,2020-04-23T16:32:26Z,2020-04-23T23:15:32Z,2020-04-23T23:15:32Z,4,96,30,"Summary of the Pull Request
The Fade behavior was exposed to race conditions because Pointer events were conflicting with keyboard input.  This PR does the following:

Removes the fade animation, and sets visibility property.
Encapsulates context button activation inside the resultviewmodel, which knows how to respond to both pointer events and keyboard input

 
References

PR Checklist

 Applies to #2301
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments


Validation Steps Performed

Verified that PointerExit on the selected item doesn't hide the buttons.
Verified that accelerator keys trigger the selected result, not the result in the pointer over state.
Verified that pressing the buttons initiates the context action.
Verified that each result has context menu buttons (except window walker items).",3,0
2353,2020-04-23T16:40:15Z,,2020-04-24T02:41:05Z,2,7,1,"Disabling Win+R Override in shell plugin.  We should also have a single way to do key overrides, this and how the main code base override differently",2,1
2355,2020-04-23T17:47:28Z,2020-04-23T19:07:37Z,2020-04-23T19:07:37Z,2,2,33,"Summary of the Pull Request

Removed the folder plugin.
Modified the dlls to be added (Added propertychanged.dll, which was previously produced in the .nuget global folder)
Set the configuration of the project to x64 so that it would get published.

 
References

PR Checklist

 Applies to #2147
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

To create an MSI, the PowerLauncher project must be published and not built so that all the dlls that are present in C:\users...nuget folder get copied in as well.
Also ensure that the PowerLauncher.deps.json created is from publish and not build, because otherwise it would contain all the runtime debug dependencies which are not needed.
To publish the PowerLauncher project, set teh configuration to-


Framework dependent
win-x64
set Configuration to Release


Validation Steps Performed

Manually validated it and ensured that it works on other machines as well.",2,0
2356,2020-04-23T18:39:41Z,2020-04-23T22:38:08Z,2020-04-23T22:38:08Z,1,0,4,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #2300
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
build and didn't install anything",2,0
2357,2020-04-23T18:39:57Z,2020-04-27T08:04:21Z,2020-04-27T08:04:21Z,2,6,4,"ministrator accounts

Summary of the Pull Request
""Download updates automatically"" toggle enabled only for administrator account

PR Checklist

 Applies to #2354
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manually tested",5,8
2360,2020-04-23T21:18:19Z,2020-04-23T23:16:16Z,2020-04-23T23:16:16Z,2,37,29,"Summary of the Pull Request
Fix for program executing when there is no query text in search box and Enter is pressed.

PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed

Verified that last selected program is not executed again if we press Enter in empty search box.
Manually validated the working of plugins.",2,0
2361,2020-04-23T21:31:23Z,2020-04-23T22:39:56Z,2020-04-23T22:39:56Z,1,9,2,"Summary of the Pull Request

Modify scoring algorithm so that code shows up vscode.

 
References

jjw24/Wox#182 (review)


PR Checklist

 Applies to #2046 .
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manually validated it.",3,0
2368,2020-04-23T23:22:25Z,2020-04-24T01:39:37Z,2020-04-24T01:39:37Z,20,879,0,"Summary of the Pull Request
This PR reverts the change that removed the folder plugin, and removes false call to actions such as 'CTRL - Enter to open the directory'.

PR Checklist

 Applies to #2363
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments


Validation Steps Performed

Manually navigated to directories and subdirectories on my machine.
Verified hitting enter, as well as copy path accelerator and button.",3,0
2369,2020-04-23T23:43:28Z,2020-04-24T01:25:58Z,2020-04-24T01:25:58Z,4,361,391,"removing path and description for text
next will be favoring LNK over exe in total paths (different PR)
uwp

win32",2,0
2370,2020-04-23T23:52:54Z,2020-04-24T20:31:36Z,2020-04-24T20:31:36Z,1,35,35,"Summary of the Pull Request
Push program execution to a background thread.

PR Checklist

 Applies to #2338 #2367
 CLA signed. If not, go over here and sign the CLA
 Tests Added/Passed


Detailed Description of the Pull Request / Additional comments
Whenever a search result was executed through Enter/click, Process.start was freezing the UI thread till it's completion. This PR pushes this operation to a background thread and hides the launcher window.

Validation Steps Performed

Validated that the launcher hides without waiting for process to start.
Manually validated working of all plugins.",2,0
2375,2020-04-24T05:38:33Z,2020-04-24T16:35:21Z,2020-04-24T16:35:21Z,2,25,9,"Note the LNKs here are being pulled from the search plugin, not the program plugin",2,0
2380,2020-04-24T16:13:00Z,2020-04-25T17:54:55Z,2020-04-25T17:54:55Z,5,33,36,"Summary of the Pull Request
This issue fixes the cursor jumping around.
The root cause was that due to a delay there was a disconnect between the text that was in the textbox, and what was being queried.   As a result the cursor was being set to a position that didn't match what was being queried.
PR Checklist

 Applies to #2378


Detailed Description of the Pull Request / Additional comments

Separating the ability to set the text from initiating a query.
Plugins have to explicitly request the query be updated.
Updating Folder plugin to explicitly update the query on folder selection.
Removing unused changes from 'Wox' that don't compile.
Don't set delay on system updated query text.


Validation Steps Performed

Manually typed long queries and watched out for cursor changing position.
Validated that the folder plugin still behaves the same as before.",3,0
2381,2020-04-24T16:42:55Z,2020-04-24T18:10:41Z,2020-04-24T18:10:41Z,2,22,16,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #2379
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
alt-space works, WinR no longer fires",2,0
2385,2020-04-24T20:26:35Z,2020-04-25T17:27:36Z,2020-04-25T17:27:37Z,2,32,0,"Summary of the Pull Request
This PR fixes dll's being loaded when first query is made.

PR Checklist

 Applies to #2283
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Dll's loaded when plugin is queried for first time :

Microsoft.Search.Interop.dll
System.Data.OleDb.dll.
System.Transactions.Local.dll
System.Diagnostics.PerformanceCounter.dll

Dll's loaded when the List view is populated for the first time :

Windows.ApplicationModel.winmd
System.Globalization.dll
System.Reflection.dll
System.Reflection.Extensions.dll
Windows.Storage.winmd


Validation Steps Performed
Manually validated that dll's are loaded before first query.
Steps to compare :

Run in debug mode as the difference can be easily compared.
Open current 'dev/powerlauncher' and when the searchbox is visible for first time type one single letter.
Repeat step 2 with this PR.",4,2
2386,2020-04-25T01:05:43Z,2020-04-26T22:09:41Z,2020-04-26T22:09:41Z,15,439,125,"Summary of the Pull Request
This PR removes all the earlier warning messages from flyouts and now uses an Error icon with a tooltip of the error message. The reason for this is because Flyouts interrupt user input, so by moving the warning to a hidden tooltip, its less intrusive for the user. The PR also adds handling for remapping a key/shortcut to itself, remapping a key/shortcut twice, conflicting remaps (like Ctrl (Left) and Ctrl) and Win L and Ctrl Alt Del remaps. The only flyouts that have been maintained for now are on the Apply button. The key order was also modified to improve search.

PR Checklist

 Applies to #2216
 CLA signed. If not, go over here and sign the CLA

Things that can be improved

While moving to the tooltip based warning makes it less blocking for the user, we should still make it more visible for the user. Maybe like a red colored icon, or if possible the tooltip should force show up without hover so that the user notices it.
Another option is to show a warning next to which ever key/shortcut is giving an error, rather than a single one for the whole row. That way the mouseover point will be close to where the error occured.
Currently if there is an error in both shortcuts in a row, we update the tooltip with the latest error. The warning should be improved to list out all the issues in the shortcuts rather than the latest applied one.


Detailed Description of the Pull Request / Additional comments

Reordered the keys in drop down as the following groups:

Numbers/Alphabets/Symbols
Modifiers
Other named keys
Unknown keys
Each of the above groups are sorted in alphabetical order to improve search as suggested by @traies and @saahmedm


Removed flyouts and changed to a warning symbol with tooltip. This makes it easier for the user to search without being blocked by the flyout popping up.
A warning was also added for incomplete remapping (where a shortcut is incomplete or a row in the remap is incomplete), but this warning is only showed when pressing apply, so that the user does not see an incomplete warning while adding a new row. Also this helps is pointing out which remaps were unsuccessful when the remap partially fails
Constraint on number of keys for shortcut that can be added from UI changed from 5 to 3.


Validation Steps Performed
Run and add different types of shortcuts, both using drop downs and by type shortcut. Same for key remapping.
Remap Key Warnings

Shortcut Remap Warnings",2,0
2392,2020-04-25T17:47:45Z,2020-04-25T19:14:04Z,2020-04-25T19:14:04Z,7,88,51,"Summary of the Pull Request
This change makes the directory navigation behave more like search and the runner.

Arrow keys or tab to select will update the query text to the path of the folder.
Enter on the folder will launch explorer

 
References

PR Checklist

 Applies to #2383
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments.

It became apparent when using the arrow keys to update the query text programatically, that there were holes in the logic to prevent updating the query when we change the text.  To fix this it was broken into to TextChanged event handlers one to deal with programatic input and the other to deal with user text changes.  Because the property changed event and the text changed are on different dispatchers, we can't check the boolean flag inside the event handler.



Validation Steps Performed
Manually tested.

Navigating to a folder from the folder plugin.
Navigating to a folder from the search indexer plugin.
Actioning on a folder from the folder plugin.
Actioning on a folder from the search indexer plugin.
holding arrow keys to validate that a query doesn't get updated upon selecting a new item.",3,3
2394,2020-04-25T21:20:24Z,2020-04-26T23:44:15Z,2020-04-26T23:44:15Z,2,1,12,"Remove reference to TwoWayIPCLib
Downgraded System.Text.Json package in Settings.Lib


Summary of the Pull Request
#2241
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,2
2404,2020-04-26T15:08:34Z,2020-04-26T16:57:28Z,2020-04-26T16:57:28Z,1,59,3,"Summary of the Pull Request
This PR watches for all files and directories being created and deleted out of the Program Files directory. This will trigger the application to reindex after a delay.
I don't think this is a permanent solution, and we will have to put more though into how to do this in a less intrusive way.
 
References

PR Checklist

 Applies to #2398
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
This is not perfect.  We get multiple  writes on installing or uninstalling the uwp app.   The idea is an initial write will trigger a timed delay of the reindex, if another write is detected within that time span it resets the timer.   If the install has delays between file writes we will reindex multiple times (not good).
Also there seems to be thread contention that causes stalls if we are querying for apps while the UWP apps are being reindexed.

Validation Steps Performed

Launch the app.  Verify no ""Reindexing"" is a happening.
Uninstall Terminal, and verify that it triggers a reindex, and that terminal no longer appears in the results.
Reinstall Terminal, and verify that it triggers a reindex and that the terminal will now appear in the results.

NOTE:  There is about a 10-15 second delay after installing, for the results to be reflected in the UI.",4,5
2409,2020-04-27T02:43:44Z,2020-04-27T04:57:52Z,2020-04-27T04:57:52Z,2,34,13,"PR Checklist

 Applies to #2196
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

This only adds the basic scrolling functionality, not the redesigned talked about in the follow up comments of #2196


Validation Steps Performed
Add a bunch of keyboard and shortcuts remappings, the windows are scrollable.",2,0
2411,2020-04-27T04:35:13Z,2020-05-03T10:17:07Z,2020-05-03T10:17:07Z,17,208,37,"Summary of the Pull Request

Added a fix for start as admin.
Settings configs for powerprev changed on the master branch, I applied related changes and added tests

 
References

PR Checklist

 Applies to #2287
 CLA signed. If not, go over here and sign the CLA
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Validation Steps Performed

Added tests and run the application to verify.",4,3
2412,2020-04-27T09:05:56Z,2020-04-27T13:02:28Z,2020-04-27T13:02:29Z,1,3,2,"Summary of the Pull Request
for non-admin users
PR Checklist

 Applies to #2354


Validation Steps Performed

installed the PT as a non-admin user and observed ""Visit""-type toast notification",4,6
2418,2020-04-27T15:09:36Z,2020-04-29T17:14:35Z,2020-04-29T17:14:36Z,9,37,24,"Summary of the Pull Request
Updated the FZ Readme with new screenshots to reflect the current UI.
Removed the description of options that are not available anymore.
Added the description of new options/features.
Removed old items from the backlog (we may consider dropping the backlog since keeping it up-to-date is problematic).
Link to the updated Readme https://github.com/enricogior/PowerToys-1/blob/fancyzones-readme-update/src/modules/fancyzones/README.md

PR Checklist

 Applies to #879",2,0
2421,2020-04-27T16:55:07Z,2020-05-05T21:02:55Z,2020-05-05T21:02:56Z,1,15,4,"Summary of the Pull Request

Bringing WPF into focus using:
ShowWindow(hwnd, SW_NORMAL);
SetForegroundWindow(hwnd);

causes WPF to launch a blank screen.


I tried several suggestions to fix it in the WPF app and none of them work:
https://stackoverflow.com/questions/257587/bring-a-window-to-the-front-in-wpf


Instead of using ShowWidnow, we can relaunch a new window using the same IPC names and Powertoys PID as the old window.


Id like your feedback on this.
 
References
https://stackoverflow.com/questions/257587/bring-a-window-to-the-front-in-wpf

PR Checklist

 Applies to #2340
 CLA signed. If not, go over here and sign the CLA",2,5
2427,2020-04-27T20:33:27Z,2020-04-28T00:35:34Z,2020-04-28T00:35:34Z,2,42,11,"Summary of the Pull Request

Improved styling of the command bar buttons: right margins, applied the IconOnlyButtonStyle that was already in the resources.
Removed the visual elements in the GridViewItem that would show a second pointerover background when hovering over the buttons.
Centrally aligned the application title, path and icon (also horizontally for icons that are not square.
The application title/path no longer run through the command icons.

New result:

References
#2425, #2426

PR Checklist

[] Applies to #2425, #2426
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx",2,0
2432,2020-04-28T09:05:00Z,2020-04-28T12:17:21Z,2020-04-28T12:17:21Z,1,87,242,"54)""
This reverts commit af4678f.

Summary of the Pull Request
That commit seems to greatly increase deadlock probability in FancyZones, so we revert it for now.

Validation Steps Performed
Launched PT and increased DPI",2,2
2446,2020-04-28T19:26:40Z,2020-05-01T21:25:07Z,2020-05-01T21:25:07Z,2,57,13,"Summary of the Pull Request
Added code to position launcher in upper center of the screen and handle display in a multi monitor setting.

PR Checklist

 Applies to #2419
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed

Manually validated that launcher appears in the center when it is visible.
Verified that position is updated when DPI is changed from system settings.
Validated that Launcher is correctly shown/hidden when monitor is changed.",4,11
2471,2020-04-29T02:41:09Z,2020-04-30T17:14:34Z,2020-04-30T17:14:34Z,6,0,12,"Removed headers that never be used.

Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,1
2473,2020-04-29T03:34:52Z,2020-05-01T20:17:30Z,2020-05-01T20:17:31Z,8,29,30,"Summary of the Pull Request
This PR adds a post-build script to the Settings.UI.Runner project. The script runs a build of the project and its dependencies and publish with the required configuration as required for the current MSI. Comments have been added to the script with REM commands. Once this is confirmed to work, we can do the same for the launcher project as well.

PR Checklist
This PR fixes multiple undocumented issues:

The main build pipeline fails because of missing dependencies for the MSI.
This possibly fixes the Xaml Island double compile issue (to be verified by more users)


Detailed Description of the Pull Request / Additional comments


Since dotnet publish CLI was always failing for the Settings.UI UWP project (according to the official github repo, some functionality in VS steps is not present in dotnet CLI), I used MsBuild instead, because VS uses MsBuild internally


For compiling correctly with MsBuild in the interop project a reference to common projects file had to be removed and was changed to a path based reference rather than project based reference. I am not sure why normally building with VS doesn't throw a warning or error about the same.


There was a missing file in the UWP project which existed but was not referenced in the project.


The script in short runs a MSBuild publish task (which internally does build followed by publish). Some extra code had to be added to ensure it doesnt run into a recurse loop, since the msbuild task is a post build event.


For publishing, a publish profile file needs to be created, that has been hardcoded into the script.


For changing the MSI from its current behaviour to self-contained we would have to change one parameter in the script, as well as add the extra dll files created into the Wix toolset file.


Since the script code is only readable when opening it in VS here is the code
rem Check required to avoid a recursive loop of building

IF NOT DEFINED settingsBuildEventCompleted (
setlocal enableDelayedExpansion
SET settingsProfileFolderName=Properties\PublishProfiles\

rem Create the publish profile folder if it doesn't exist
IF NOT EXIST !settingsProfileFolderName! (mkdir !settingsProfileFolderName!)
SET settingsProfileFileName=SettingsProfile.pubxml
SET settingsPublishProfile=!settingsProfileFolderName!!settingsProfileFileName!

rem Create the publish profile pubxml
echo ^<?xml version=""1.0"" encoding=""utf-8""?^> > !settingsPublishProfile!
echo ^<^^!-- >> !settingsPublishProfile!
echo https://go.microsoft.com/fwlink/?LinkID=208121.  >> !settingsPublishProfile!
echo --^> >> !settingsPublishProfile!
echo ^<Project ToolsVersion=""4.0"" xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""^> >> !settingsPublishProfile!
echo   ^<PropertyGroup^> >> !settingsPublishProfile!
echo     ^<PublishProtocol^>FileSystem^</PublishProtocol^> >> !settingsPublishProfile!
echo     ^<Configuration^>$(ConfigurationName)^</Configuration^> >> !settingsPublishProfile!
echo     ^<Platform^>x64^</Platform^> >> !settingsPublishProfile!
echo     ^<TargetFramework^>netcoreapp3.1^</TargetFramework^> >> !settingsPublishProfile!
echo     ^<PublishDir^>..\..\..\x64\$(ConfigurationName)\SettingsUIRunner^</PublishDir^> >> !settingsPublishProfile!
echo     ^<RuntimeIdentifier^>win-x64^</RuntimeIdentifier^> >> !settingsPublishProfile!
echo     ^<SelfContained^>false^</SelfContained^> >> !settingsPublishProfile!
echo     ^<PublishSingleFile^>False^</PublishSingleFile^> >> !settingsPublishProfile!
echo     ^<PublishReadyToRun^>False^</PublishReadyToRun^> >> !settingsPublishProfile!
echo   ^</PropertyGroup^> >> !settingsPublishProfile!
echo ^</Project^> >> !settingsPublishProfile!

rem Set a variable to know that the publish event is called to avoid it being called again
SET settingsBuildEventCompleted=1

rem In case of Release we should not use Debug CRT in VCRT forwarders
IF $(ConfigurationName)==Release (
""$(MSBuildBinPath)\msbuild.exe"" Microsoft.PowerToys.Settings.UI.Runner.csproj  -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:VCRTForwarders-IncludeDebugCRT=false -p:PublishProfile=!settingsProfileFileName!
) ELSE (
""$(MSBuildBinPath)\msbuild.exe"" Microsoft.PowerToys.Settings.UI.Runner.csproj  -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:PublishProfile=!settingsProfileFileName!
)
)




Validation Steps Performed

Build Debug and Release and tried building the MSI. Also ran PowerToys to verify settings opens. Also check the x64\Config\Settings.UI.Runner*.deps.json file which should only contain win-x64 version of dlls.",3,4
2475,2020-04-29T05:03:01Z,2020-04-29T17:29:32Z,2020-04-29T17:29:32Z,7,10,10,"Noticed this during the bug bash.  As this is en-us, behavior is misspelled.",1,0
2477,2020-04-29T05:16:52Z,2020-04-29T17:33:59Z,2020-04-29T17:33:59Z,5,58,495,"Summary of the Pull Request

Refactored code, removed unnecessary style resources.
Tweaked the border / shadow
Resolved a bug where the search text would run through the search icon
Changed the autosuggest textbox into a textblock.
Stripped the textbox template from unnecessary elements.
Fixed a bug where the command bar buttons would fall off the screen / weird offset.

Light theme

Dark theme

References
#2474 #2423 #2422
PR Checklist

 Applies to #2474 #2423 #2422
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx",5,11
2485,2020-04-29T13:43:52Z,2020-04-30T10:16:09Z,2020-04-30T10:16:09Z,7,448,345,"Summary of the Pull Request
Separated part of code responsible for moving windows between zones
 
References

PR Checklist

 Applies to #2484
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx",4,2
2489,2020-04-29T18:58:52Z,2020-04-29T21:45:35Z,2020-04-29T21:45:35Z,0,0,0,"Summary of the Pull Request

Reverted previous merge
Merged in previous changes from dev/traies/build_feature_launcher_integration

 
References

PR Checklist

 Applies to #2345
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
Previous merge was squashed in instead of rebased into dev/build-features

Validation Steps Performed

Building and running contains PowerLauncher/Settings integration
Can build a working MSI.",9,0
2496,2020-04-29T20:49:06Z,2020-04-29T22:10:54Z,2020-04-29T22:10:55Z,1,1,1,"Summary of the Pull Request
Polling for changes in HKEY_CURRENT_USER will trigger RegisterVirtualDesktopUpdates function call to often, even if nothing related to virtual desktops has changed. Fix this and only register updates in Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VirtualDesktops regkey.

PR Checklist

 Applies to #2482",2,0
2502,2020-04-29T21:06:59Z,2020-05-01T11:26:39Z,2020-05-01T11:26:39Z,2,24,24,"PR Checklist

 Applies to #1495",3,4
2510,2020-04-29T22:33:23Z,2020-04-30T17:19:46Z,2020-04-30T17:19:46Z,5,96,502,"Summary of the Pull Request
Merge in two missing commits from dev/PowerLauncher

[Launcher] Fluent UX fixes for the results list (#2427)
[Launcher] Fluent UX enhancements (#2477)


PR Checklist

 Applies to #2345
 CLA signed. If not, go over here and sign the CLA",5,2
2512,2020-04-29T22:36:12Z,2020-05-01T01:47:04Z,2020-05-01T01:47:04Z,1,1,1,"Summary of the Pull Request
This PR fixes issue with calculator results showing up results only once.

PR Checklist

 Applies to #2254
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
The plugin ID for WW and calculator was same. This caused results from calculator plugin to be overwritten with results from WW.

Validation Steps Performed
Validated that calculator plugin works as expected.",2,1
2513,2020-04-29T23:14:16Z,2020-05-01T22:58:55Z,2020-05-01T22:58:55Z,3,22,34,"Summary of the Pull Request
Disable Win+R overriding functionality in Launcher.
 
References

PR Checklist

 Applies to #2345
 CLA signed. If not, go over here and sign the CLA",3,3
2534,2020-04-30T11:22:02Z,2020-05-27T14:52:59Z,2020-05-27T14:53:00Z,3,131,17,"Summary of the Pull Request
Some application like outlook uses multiple windows. If application was zoned ""Move newly created window to zone"" all other windows were moved to the zone also.
After changes only one window of same application will be zoned on creation, rest will not be moved by fancy zones.
When one window of same application window is zoned, zoning other window can be zoned, but it will not be saved in zone-settings.json.
Edit: Now multiple instances of same application will be zoned based on process id. First window of aplication instance will be zoned, rest will be unzoned while starting app

PR Checklist

 Applies to #1192


Validation Steps Performed

Manual testing
Unit tests passed",8,9
2561,2020-04-30T19:30:05Z,2020-05-04T20:30:38Z,2020-05-04T20:30:38Z,2,8,0,"Summary of the Pull Request
This PR adds a post build event to create all the publish dependencies for Launcher required for the MSI, however, unlike the PR for settings (#2473 ), this does not fix the double compile issue, and this is also currently added only for Release, since Debug was showing odd behavior.
In case of Release, the logic is now to build the project again followed by a publish only step.
To be merged in after #2473

PR Checklist

Fix for the build pipeline for launcher - verified by running a build on a duplicate branch on the main repo.
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
  rem Check required to avoid a recursive loop of building

  IF NOT DEFINED launcherBuildEventCompleted (
  setlocal enableDelayedExpansion
  SET launcherProfileFolderName=Properties\PublishProfiles\

  rem Create the publish profile folder if it doesn't exist
  IF NOT EXIST !launcherProfileFolderName! (mkdir !launcherProfileFolderName!)
  SET launcherProfileFileName=launcherProfile.pubxml
  SET launcherPublishProfile=!launcherProfileFolderName!!launcherProfileFileName!

  rem Create the publish profile pubxml
  echo ^<?xml version=""1.0"" encoding=""utf-8""?^> > !launcherPublishProfile!
  echo ^<^^!-- >> !launcherPublishProfile!
  echo https://go.microsoft.com/fwlink/?LinkID=208121.  >> !launcherPublishProfile!
  echo --^> >> !launcherPublishProfile!
  echo ^<Project ToolsVersion=""4.0"" xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""^> >> !launcherPublishProfile!
  echo   ^<PropertyGroup^> >> !launcherPublishProfile!
  echo     ^<PublishProtocol^>FileSystem^</PublishProtocol^> >> !launcherPublishProfile!
  echo     ^<Configuration^>$(ConfigurationName)^</Configuration^> >> !launcherPublishProfile!
  echo     ^<Platform^>x64^</Platform^> >> !launcherPublishProfile!
  echo     ^<TargetFramework^>netcoreapp3.1^</TargetFramework^> >> !launcherPublishProfile!
  echo     ^<PublishDir^>..\..\..\x64\$(ConfigurationName)\launcherUIRunner^</PublishDir^> >> !launcherPublishProfile!
  echo     ^<RuntimeIdentifier^>win-x64^</RuntimeIdentifier^> >> !launcherPublishProfile!
  echo     ^<SelfContained^>false^</SelfContained^> >> !launcherPublishProfile!
  echo     ^<PublishSingleFile^>False^</PublishSingleFile^> >> !launcherPublishProfile!
  echo     ^<PublishReadyToRun^>False^</PublishReadyToRun^> >> !launcherPublishProfile!
  echo   ^</PropertyGroup^> >> !launcherPublishProfile!
  echo ^</Project^> >> !launcherPublishProfile!

  rem Set a variable to know that the publish event is called to avoid it being called again
  SET launcherBuildEventCompleted=1

  rem In case of Release we should not use Debug CRT in VCRT forwarders
  IF $(ConfigurationName)==Release (
  ""$(MSBuildBinPath)\msbuild.exe"" Microsoft.PowerToys.launcher.UI.Runner.csproj  -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:VCRTForwarders-IncludeDebugCRT=false -p:PublishProfile=!launcherProfileFileName!
  ""$(MSBuildBinPath)\msbuild.exe"" -t:Publish Microsoft.PowerToys.launcher.UI.Runner.csproj  -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:VCRTForwarders-IncludeDebugCRT=false -p:PublishProfile=!launcherProfileFileName!
  )
  )


Validation Steps Performed
Ran the main build pipeline, and also verified on fresh builds in Release config. Building again results in the double compile issue as before. For the purpose of the build pipeline since it always starts from a clean solution, the correct files will be generated.",2,1
2562,2020-04-30T19:56:07Z,2020-05-04T18:36:58Z,2020-05-04T18:36:58Z,2,8,1,"Summary of the Pull Request
I got it to stop crashing by bypassing XamlBridge Window focus handling.
It seems there was some initialization missing that was the root cause of the strange crashes in Windows Insiders.
 

PR Checklist

 Applies to #2321
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Xaml Bridge seems to not handle focus events properly, so this fix just bypasses it by handling the WM_SETFOCUS event directly.
This also solves another not documented crash that involved minimizing the window, then closing by pressing the X button without interacting with the window content itself.
Solved by calling winrt::init_apartment and WindowsXamlManager::InitializeForCurrentThread() in the constructor of the XamlBridge class.


Validation Steps Performed
For Windows Insiders users

Click on the Remap a key button with no key remappings.
Close the window by pressing the X button.
It shouldn't crash.
Repeat for Redefine a shortcut.

Another crashing scenario.

Click on the Remap a key button.
Minimize the Window.
Click on the taskbar to show the window again.
Close the window by pressing the X button.
It shouldn't crash.",3,6
2566,2020-04-30T23:22:32Z,2020-05-02T00:34:43Z,2020-05-02T00:34:43Z,4,5,5,"Summary of the Pull Request
The crash mentioned in the linked issue was happening because we use a single KeyboardManagerState variable for both of the windows, so when one of the windows is closed there is most likely something getting set to nullptr while a window is still open. The way the code was written was considering only one window open, so the best way to solve this with minimal changes is to ensure only one window can be opened at a time.
The PR changes the behavior of the buttons, such that when clicking either of the buttons - if Edit keyboard or edit shortcut either of them are open, it will bring that window in focus. Earlier if Edit keyboard was open and you clicked the same button again, it would just bring that to focus. By this change we ensure that only one window is open at a time, and by bring that in focus the user should also notice the window lying open.
This is a first step for #2466 . The pending work for the modal dialog is to prevent the user from being able to access the Settings window while this dialog box is up.
This also adds a fix where the remap button would stop working if you closed KBM from the taskbar (the runner would not crash though).

PR Checklist

 Applies to #2469, #2569
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Tried closing and reopening the windows with both the buttons multiple times.",2,0
2568,2020-04-30T23:29:15Z,2020-05-01T14:13:18Z,2020-05-01T14:13:18Z,3,107,75,"Summary of the Pull Request
After we detect changes in virtual desktops (creation / deletion) send windows message to FancyZones thread and do the handling there, instead of accessing private FancyZones members from VirtualDesktopUpdates thread. Move some virtual desktops related logic to VirtualDesktopUtils namespace.

PR Checklist

 Applies to #2528 & #2437",5,2
2581,2020-05-01T08:52:44Z,2020-05-01T10:35:38Z,2020-05-01T10:35:38Z,1,0,13,"Summary of the Pull Request
This should have been removed as a part of #1761.
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,0
2582,2020-05-01T09:59:39Z,2020-05-01T14:14:36Z,2020-05-01T14:14:36Z,1,17,12,"Summary of the Pull Request
This PR invokes synchronous window animation functions in a separate thread, so we don't wait for them before allowing a window to be snapped onto a zone

PR Checklist

 Applies to #2098


Validation Steps Performed

tested with ""show window on all monitors"" turned off and on",5,2
2583,2020-05-01T10:00:41Z,2020-05-01T14:17:16Z,2020-05-01T14:17:16Z,10,67,39,"Summary of the Pull Request
New toggle is added into FancyZones settings to enable/disable snapping windows to zones across monitors when moving windows using Windows Snap Hotkeys.

 
References

PR Checklist

[] Applies to #2319
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Validation Steps Performed
Manually tested for correct functionality and regressions on single and multi-monitor environment.",3,3
2584,2020-05-01T11:00:37Z,2020-05-01T14:13:52Z,2020-05-01T14:13:53Z,1,68,25,"Summary of the Pull Request

subscribe only to handled WinHook events
(un)hook EVENT_OBJECT_LOCATIONCHANGE handler only when required


PR Checklist

 Applies to #1264


Validation Steps Performed

moved windows in FZ with various options turned off and on",4,1
2589,2020-05-01T15:15:09Z,2020-05-04T14:42:06Z,2020-05-04T14:42:06Z,6,42,33,"Summary of the Pull Request

This PR fixes the Fancyzones and MarkDown Preview Handler issues which was causing them to not work on upgrading Markdig.Signed from v0.18 to v0.20.


PR Checklist

 Applies to #2453
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
The changes made in the pull request are as follows -

The output folders of the FileExplorerPreview Projects is now set to modules/FileExplorerPreview so that the dlls don't interfere with the fancyZones dlls.
Modifed the Product.wxs file to ensure that the paths are updated while generating the new MSI and all the dlls are in the correct location.
Updated the path for the registry setup of PreviewHandlers.


Validation Steps Performed

Created an MSI and validated the working of both Fancyzones, Svg and Markdown rendering.",3,0
2593,2020-05-01T16:48:20Z,2020-05-02T00:26:02Z,2020-05-02T00:26:02Z,4,9,9,"Summary of the Pull Request
Updated Description of search results to show which plugin it came from.

PR Checklist

 Applies to #2262
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated that plugins show updated descriptions.",4,5
2601,2020-05-01T20:08:35Z,2020-05-04T21:40:32Z,2020-05-04T21:40:32Z,13,174,46,"Summary of the Pull Request
Version number shown in General Settings page is now in line with whats in the installer/Version.props file

PR Checklist

 Applies to #2550
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

powertoys_version field gets updated if its version is newer than that of the file, it is left untouched otherwise. This check should be useful in case of any migrations necessary on the future.


Validation Steps Performed

Navigate to the General Settings page, should display v0.17.0.
Settings.json powertoys_version is updated to v0.17.0 if coming from a previous version.",2,2
2604,2020-05-01T20:42:44Z,2020-05-05T07:00:50Z,2020-05-05T07:00:50Z,5,123,52,"Summary of the Pull Request
Move ImageResizer general settings from windows registry to persisted JSON data file. Support migration, and always up to date enabled flag for ImageResizer.

PR Checklist

 Applies to #1413",7,5
2607,2020-05-01T23:42:42Z,2020-05-05T21:28:45Z,2020-05-05T21:28:45Z,9,204,11,"Summary of the Pull Request

Updated PowerRename controls header text and tests to align with those of settings in v1 from .17 release


PR Checklist

 Applies to #2599
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2599",1,0
2611,2020-05-02T08:55:42Z,2020-05-05T11:15:47Z,2020-05-05T11:15:47Z,3,5,1,"Summary of the Pull Request
Improved layout for Image Resizer.
PR Checklist

 Applies to #2610
 CLA signed. If not, go over here and sign the CLA",3,3
2616,2020-05-02T11:43:35Z,2020-05-05T08:13:51Z,2020-05-05T08:13:51Z,5,54,11,"Summary of the Pull Request
After FancyZones module start, get list of currently active virtual desktops and go through all persisted device information and delete those related to desktops that no longer exist.

PR Checklist

 Applies to #1312


Validation Steps Performed

Create several virtual desktops and zone layouts on them.
Close PowerToys.
Close all virtual desktops but primary.
Start PowerToys.

Check zones-settings.json file after PowerToys start. All device info related to closed virtual desktops is removed.",5,3
2624,2020-05-02T19:51:08Z,2020-05-05T07:21:56Z,2020-05-05T07:21:56Z,1,1,1,"Summary of the Pull Request
Check the status of VK_RWIN as well as VK_LWIN, so that keyboards with (only) right-hand Windows keys or keys that send the right-hand Windows key virtual key can use Windows Snap hotkey overriding in FancyZones as expected.
Fixes #436

PR Checklist

 Applies to #436
 CLA signed.
 Tests added/passed: Manually tested. I had a look in the FancyZonesTests dir and couldn't see any related to this, but please let me know if I missed them!
 Requires documentation to be updated: No change required.
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx",3,2
2627,2020-05-02T22:43:00Z,2020-05-03T16:45:29Z,2020-05-03T16:45:29Z,4,83,0,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,5
2642,2020-05-04T08:13:29Z,,2020-05-05T19:08:36Z,0,0,0,"Summary of the Pull Request

Updated shortcut guide UI and text to match that of the .17 Powertoys release.



PR Checklist

 Applies to #2599
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where a discussion took place: #2599",3,2
2648,2020-05-04T14:38:39Z,2020-05-05T12:16:38Z,2020-05-05T12:16:38Z,9,156,107,"Summary of the Pull Request

postpone WinHookEvent processing until FancyZones::WndProc function by PostMessages
in theory, we might start removing mutexes from FancyZones class, e.g. starting by replacing it with null_mutex and test if it still works


PR Checklist

 Applies to #961, #2654


Validation Steps Performed

played with FZ with various settings turned on and off, added and removed VDs
unit tests passed",7,2
2653,2020-05-04T15:35:43Z,2020-05-05T03:34:35Z,2020-05-05T03:34:35Z,99,161,146,"Summary of the Pull Request

Updates save location to be  ../AppData/Local/Microsoft/PowerToys/Run for Launcher.
Rename Launcher save directory from Launcher to Run
Rename Wox.Plugin.* assemblies and folder locations to Microsoft.Plugin.*

Note:  Some minor code updates were made to reference code ouside of the plugins folder.  I did not change the Wox.Plugin.csproj namespaces.
This change was done so that the save code could still save to a folder based on the assembly where the plugin is done.



 
References

PR Checklist

 Applies to #2450
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed


Verified that save file location was correct, and that plugins are saving based on the correct assembly.



Generated and tested the following MSI (Link only available to microsoft).
https://microsoft-my.sharepoint.com/:u:/p/ryanbod/EW5F_mHaO3hGnz8Q_GJivjABRJYsrHyRnl9aw96gIjWwAQ?e=ipEgKQ",3,2
2655,2020-05-04T15:41:32Z,2020-05-05T03:33:53Z,2020-05-05T03:33:53Z,1,4,2,"Summary of the Pull Request
I noticed a crash when pressing tab if there is no selected item.
I put in a guard that prevents us from attempting to select the next context menu item if there is no selected item in the results.
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Steps to reproduce (Prior to this change).
Type a string that will return no results such as 'asdfghjkl'.
Press 'Tab'.
Observe the crash.


Validation Steps Performed

Performed the above steps and verified that there was no longer a crash.
Also verified that the expected tabbing behavior was executed going forward and backwards.",2,0
2664,2020-05-04T18:21:52Z,2020-05-04T22:40:16Z,2020-05-04T22:40:16Z,55,0,14778,"Summary of the Pull Request
Remove WW module from powertoys

PR Checklist

 Applies to #2333
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed

Manually validated that runner works as expected
Manually validated that WW is not present in settings and MSI",2,0
2666,2020-05-04T18:42:05Z,2020-05-04T22:49:37Z,2020-05-04T22:49:37Z,8,81,27,"Summary of the Pull Request
This PR makes the following changes:

On the Edit Keyboard screen, key remappings are not applied, so even if the user has orphaned a key, then can still search with it in the drop down menu
On the Edit Shortcuts screen, shortcut remappings are not applied, so even if the user has orphaned a shortcut, then can still use it on that window. This is for consistency with the above behavior.
Commented out App-Specific and ToggleKeyToModifier handlers in the back-end (even though they wouldn't technically do anything unless they were in the settings). This can be uncommented when we add in the feature to the UI.


PR Checklist

 Applies to #2551
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manually verified that even if a key is orphaned you can

Still use it in Edit Keyboard
You can't use it if you change focus to another app and try typing - To make sure ""Apply"" makes sense",2,1
2670,2020-05-04T22:38:31Z,2020-05-05T19:30:50Z,2020-05-05T19:30:50Z,11,100,44,"Summary of the Pull Request
This PR adds telemetry to KBM.
The following telemetry has been added after discussing with @saahmedm

KBM Enabled/Disabled - This can be used to see what percentage of users leave it on, and also if users need to disable and re-enable KBM often for restarting the hook. We plan to add more text in the documentation so that users are aware of this behavior
Number of single key remaps on applying at Edit Keyboard
Number of os level shortcut remaps on applying at Edit Shortcuts

A combination of the above metrics can be used for estimating MAD.

PR Checklist

 Applies to #2558
 CLA signed. If not, go over here and sign the CLA",5,0
2673,2020-05-05T01:05:40Z,2020-05-05T16:41:11Z,2020-05-05T16:41:12Z,1,3,1,"Summary of the Pull Request
C:// is not recognized as valid path by window explorer or start menu search but recognized by Run. Run allows you to interchange between / and \ and append any number of slashes.
This PR adds support to specify path similar to Run. It also fixes the issue of opening Documents folder on typing C:// rather than root of drive.

PR Checklist

 Applies to #2495
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated that folder plugin handles / and \ scenario and behave like Run.",2,0
2674,2020-05-05T01:48:00Z,2020-05-05T22:53:31Z,2020-05-05T22:53:31Z,4,46,2,"Summary of the Pull Request
This PR detects if the OS version is before 19h1 or after.
If it was an earlier build, it accordingly deploys the old settings UI page and renders the description of Launcher and keyboard remapper as follows. If not the user is redirected to the new settings UI.
Image resizer shows it's old


 
References

PR Checklist

 Applies to #2443
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

The code obtains the build number from the registry and checks if it is before or after the 19h1 release. It accordingly deploys the new or old settings UI executable.

Outstanding Tasks

Need to evaluate the differences in Image resizer in v0.17 v/s settings v2 and implement it accordingly. Shall do it as a part of a separate PR. As of now Image resizer settings show up as follows in the old settings -




Validation Steps Performed

Created vhd images for RS4 and RS5 releases and validated the MSI by running it on those builds.
Link to MSI - (Internal to microsoft) https://microsoft.sharepoint.com/:u:/t/Notes145/Ebf-9tk39U1Cha7ECAGyOxQBjJiA3LSQiMRG94ng878n2Q?e=50bBIt",6,7
2676,2020-05-05T02:55:54Z,2020-05-05T17:02:32Z,2020-05-05T17:02:32Z,11,411,47,"Summary of the Pull Request

Updated General Settings
Added ""Always Run as Admin Toggle""
Added Tests

Admin mode:

Non Admin Mode:


PR Checklist

 Applies to #2599
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2599


Validation Steps Performed

Verified changes/updates in the UI and json file.",5,8
2687,2020-05-05T14:42:56Z,2020-05-07T09:01:02Z,2020-05-07T09:01:02Z,4,48,0,"Summary of the Pull Request
Added information about company name, module name, version into windowwalker.dll, notifications.dll, windowwalker.exe

PR Checklist

 Applies to #2439
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
Added information to WindowWalker resource file, added resource file for notifications dll project. Added assembly info to WindowWalker app

Validation Steps Performed
Manually tested, checked details of notifications.dll, windowwalker.dll, windowwalker.exe",5,1
2689,2020-05-05T16:04:45Z,,2020-05-06T10:06:08Z,14,207,64,"Summary of the Pull Request
Activating zones using mouse button click instead of mouse button hold

PR Checklist

 Applies to #2136 #2533
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Changed the way zones are activated by mouse from holding down mouse button to mouse clicking to enable/disable zones. Added settings option to disable zones activation by mouse. Added telemetry and Unit tests.

Validation Steps Performed
Manually tested, passed all unit tests",5,1
2691,2020-05-05T17:20:55Z,2020-05-06T15:16:16Z,2020-05-06T15:16:16Z,4,36,14,"Summary of the Pull Request
When moving window into zone by index set, only move windows on currently active work area.

PR Checklist

 Applies to #2690
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

Assign zone layout on primary desktop.
Assign window to certain zone in the layout.
Create new virtual desktop.
Choose different layout on new virtual desktop.
Switch back to primary desktop.

Expected behavior: Window assigned in zone on the primary desktop kept his position.",5,0
2693,2020-05-05T19:03:17Z,2020-05-05T23:01:55Z,2020-05-05T23:01:55Z,1,14,1,"Summary of the Pull Request
This is a work around fix for the Settings UnitTests failing caused by #2601
 
References

PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
Tests were failing because GeneralSettings uses the interop library to get version information. interop is a C++/CLI project, and can't be called by an UWP app. This is not a problem in the Settings.UI exe because we are using XamlIslands, but thats not so in the UnitTests.
The current fix is just to handle the exception, which solves the crashes that happened in the UnitTest project.
A more permanent solution could be to set up the UnitTest project in a similar fashion to the Main application, that is, by having a .NET Core runner invoking a XamlIsland.

Validation Steps Performed

Microsoft.PowerToys.Settings.UnitTest pass.
The version number in the GeneralSettings page is displayed properly",2,0
2695,2020-05-05T19:26:14Z,2020-05-05T21:13:52Z,2020-05-05T21:13:53Z,3,14,0,"Summary of the Pull Request
Settings Window gets closed whenever the user clicks Exit on the PowerToys system tray menu.
 
References

PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
The settings window used to outlast the Runner executable. This fixes this by killing the Settings proecess when the runner window gets destroyed.

Validation Steps Performed

Start PowerToys.
Click on the Runner. A Settings window should show up.
Right click on the system tray icon, then select exit.
Both the Settings window and the runner should exit at the same time.",3,1
2696,2020-05-05T20:05:26Z,2020-05-06T22:10:23Z,2020-05-06T22:10:23Z,31,589,163,"Summary of the Pull Request
Adds the following Telemetry Events.



Module
Event
Property:Values
Property:Values
Property:Values
Relevant  Spec Item




Settings
SettingsEnabledModuleEvent
ModuleName:{""FancyZones"",File Explorer"",""Image Resizer"",""Keyboard Manager"",""PowerRename"",""Run"",""Shortcut Guide"",""Window Walker""}
Value:0=disabled,1=Enabled

N/A


Launcher
LauncherBootEvent
BootTimeMs:int


Requirement 1


Launcher
LauncherQueryEvent
QueryTimeMs:int
QueryLength:int
NumResults:int
Requirement 2


Launcher
LauncherFirstDeleteEvent



Requirement 3


Launcher
LauncherShowEvent



Requirement 5


Launcher
LauncherHideEvent



Requirement 5


Launcher
LauncherResultActionEvent
Trigger:{""Click"",""KeyboardShortcut}""
PluginName:Microsoft.Plugins.*
ActionName:{""Copy Path"", ""Run As Administrator"" etc}
Requirements 6/7



Note:  Requirement 5 in the Launcher spec is covered by the SettingsEnabledModuleEvent
 
References

PR Checklist

 Applies to #2060
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
TelemetryBase will need to be replaced at runtime.  Note:  This is a 'link' reference in each of the managed projects.

Validation Steps Performed
Validated Events in wpr / WPA.  Screenshots inbound",4,5
2697,2020-05-05T20:12:03Z,2020-05-06T22:55:54Z,2020-05-06T22:55:54Z,4,2,4,"Replaced NLog.Web.AspNetCore with NLog.Extensions.Logging

NOTE: When trying to build an MSI update after this PR, you might still get and Microsoft.AspNetCore.App runtime required error. This is because, for some reason, the generated PowerToys.runtimeconfig.json file still lists AspNetCore as a requirement. This can be fixed by cleaning the repository completely using git clean -xfd and rebuilding the MSI from scratch.

PR Checklist

 Applies to #2542
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

PowerLauncher builds and runs.
Log files are still written in \AppData\Local\Microsoft\PowerToys\Run\Logs\1.0.0\
ASP .NET dependency is gone.",2,3
2700,2020-05-05T21:22:09Z,2020-05-06T19:12:40Z,2020-05-06T19:12:40Z,9,127,90,"Summary of the Pull Request

Removed underline of the hyperlink buttons, so the styling is consistent with the W10 Settings app. (#2479)
Consistent enable toggleswitch for Image Resizer (#2476)
Fixed visual inconsistency for the image resizer sizes listview (#2478)
Tweaked vertical spacing of the module toggle switch.


References
#2479 #2479 #2478
PR Checklist

 Applies to #2479 #2479 #2478
 CLA signed. If not, go over here and sign the CLA",3,3
2704,2020-05-06T02:42:49Z,2020-05-06T04:17:44Z,2020-05-06T04:17:44Z,1,1,1,"Summary of the Pull Request
This PR fixes a crash on launching Settings due to an out of bound index error due to an uninitialized theme string as identified by @laviusmotileng-ms. Verified the elevated argument is read on opening settings (adding in #2676 ).",2,0
2705,2020-05-06T02:51:55Z,2020-05-06T15:34:27Z,2020-05-06T15:34:27Z,5,27,5,"Summary of the Pull Request
This PR makes the following tweaks required as P0 for Build:

Descriptions on landing page have been added
Descriptions on Remap Keyboard and Edit Shortcuts have been fixed
Remove button background made to match the window background
Landing page buttons follow Windows accent color scheme





PR Checklist

 Applies to #2544
 CLA signed. If not, go over here and sign the CLA",5,6
2709,2020-05-06T05:48:18Z,2020-05-08T15:23:18Z,2020-05-08T15:23:19Z,1,23,11,"Summary of the Pull Request

Powerpreview.dll output path changed. this PR loads the dll from the updated output folder.

 
References

PR Checklist

 Applies to #2761
[] CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2761


Validation Steps Performed

verified changes in the son file and loading of modules from specified folders.",5,13
2711,2020-05-06T08:35:43Z,2020-05-07T02:25:15Z,2020-05-07T02:25:15Z,756,71056,13472,"Summary of the Pull Request
This takes the lastest changes from build-features and pulls them in master.
Master Commit:  8b98840
Build-features:  e75916f
The following commits show changes made merging from master to build-features.
640fade Merge
4703722 fix compile issues for missing . I'm not sure why this wasn't needed to compile in master.

Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
TODO:

 - Build Debug
 - Build Release
 - Validate from build.

 - Test SVG Preview
 - Test Markdown Preview
 - Test image resizer
 - Test fancy zones
 - Test keyboard manager
 - Test powerrename


 - Build MSI

 - Test SVG Preview
 - Test Markdown Preview
 - Test image resizer
 - Test fancy zones
 - Test keyboard manager
 - Test powerrename",10,8
2717,2020-05-06T11:32:55Z,2020-05-06T23:21:33Z,2020-05-06T23:21:33Z,10,75,45,"Summary of the Pull Request
Option to disable zones activation by mouse

PR Checklist

 Applies to #2533
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Detailed Description of the Pull Request / Additional comments
Added option in settings to disable zones activation by mouse. Also added telemetry and updated unit tests

Validation Steps Performed
Manually tested, passed all unit tests",5,5
2719,2020-05-06T15:07:15Z,2020-05-06T16:41:55Z,2020-05-06T16:41:55Z,1,1,0,Mission accepted - Added doc/Interns/zhaonancy/MyFirstCommit.md with date inside,4,0
2724,2020-05-06T15:22:03Z,2020-05-06T17:24:45Z,2020-05-06T17:24:45Z,2,16,3,"Summary of the Pull Request
Create a new file in docs/interns",5,0
2726,2020-05-06T15:35:42Z,2020-05-06T17:56:48Z,2020-05-06T17:56:48Z,2,15,3,,5,0
2727,2020-05-06T16:03:25Z,2020-05-06T18:16:53Z,2020-05-06T18:16:53Z,2,15,3,This is just my first commit as instructed by https://github.com/microsoft/PowerToys/blob/interns/dev/doc/Interns/MyFirstCommit.md ~,5,3
2728,2020-05-06T16:15:21Z,2020-05-06T19:49:35Z,2020-05-06T19:49:35Z,1,0,0,"Summary of the Pull Request

Fix incorrect merge conflict resolution in Microsoft.Launcher.rc file made in PR #2674 which overwrote the changes made in da550a4a6744e0f197fdc88cb96d47205c1855e0.


Detailed Description of the Pull Request / Additional comments

This does not affect the current settings but the older settings which would show Launcher instead of Run.

As that file cannot be directly viewed, link to file in the branch creating this PR - https://github.com/alekhyareddy28/PowerToys/blob/fixIncorrectMerge/src/modules/launcher/Microsoft.Launcher/Microsoft.Launcher.rc
Validation Steps performed

Verified that it shows Run in the older settings.",2,0
2731,2020-05-06T16:35:15Z,2020-05-06T18:33:11Z,2020-05-06T18:33:11Z,2,16,3,First PR,5,1
2736,2020-05-06T17:10:30Z,2020-05-06T18:43:43Z,2020-05-06T18:43:43Z,1,1,0,This is my first pull request!,4,0
2741,2020-05-06T17:41:07Z,2020-05-06T20:53:07Z,2020-05-06T20:53:07Z,1,4,0,"Summary of the Pull Request
My first commit
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,0
2742,2020-05-06T17:48:17Z,2020-05-07T13:46:12Z,2020-05-07T13:46:12Z,2,15,3,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",5,0
2743,2020-05-06T17:52:01Z,2020-05-06T22:52:32Z,2020-05-06T22:52:32Z,2,15,3,first pull request,5,0
2751,2020-05-06T19:37:36Z,2020-05-07T09:21:30Z,2020-05-07T09:21:30Z,1,1,1,"Summary of the Pull Request
Close Shortcut Guide on right Win button release.

PR Checklist

 Applies to #2641
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Validation Steps Performed
Open Shortcut Guide with right Win button and release button.",2,0
2753,2020-05-06T20:00:37Z,2020-05-08T17:43:16Z,2020-05-08T17:43:16Z,6,255,0,"Here is a rough proof of concept of the color picker. This code logs the RGB value from the pixel at the mouse head onto the console.
This code does not support multiple monitors (only works for the primary monitor) but we will tackle this problem next.
Also Misha and I work on LiveShare so commits are not specific to the person, we've both been working together.",5,4
2759,2020-05-07T02:10:53Z,2020-05-08T16:07:19Z,2020-05-08T16:07:19Z,11,90,20,"Summary of the Pull Request
This PR mitigates the double compile issue for settings and launcher. The issue that F5 does a build even when there is no change in files still exists however.
The PR currently removed the publish post build events and instead adds publishing as pre-build events in the installer project
Details of the PR

Removed post-build events in Settings and Launcher
Disabled IncrementalClean targets for Settings and Launcher
Updated Wox project output directories to separate directories to avoid clash with PowerLauncher.csproj output
Added the telemetry dlls for Launcher and Settings introduced in #2696 to the MSI.
Removed the Wox json files and the PowerLauncher.runtimeconfig.dev.json from the MSI since those are not used. The runtimeconfig.dev.json contains file paths for the local nuget packages on the machine so those should not be included in MSI, they are only there for functioning on the dev machine.
Added the following command line pre-build events to PowerToysSetup project


Creates pubxml publishing profile based on the required parameters (using a publish profile is the only way and recommended way for publishing .NET Core projects).


Publishes the .NET Core project based on those parameters


The same is repeated for Settings and Launcher.


rem statements have been added as comments
setlocal enableDelayedExpansion

rem Publish Settings
SET settingsProfileFolderName=..\..\..\..\src\core\Microsoft.PowerToys.Settings.UI.Runner\Properties\PublishProfiles\
rem Create the publish profile folder if it doesn%27t exist
IF NOT EXIST !settingsProfileFolderName! (mkdir !settingsProfileFolderName!)
SET settingsProfileFileName=SettingsProfile.pubxml
SET settingsPublishProfile=!settingsProfileFolderName!!settingsProfileFileName!

rem Create the publish profile pubxml
echo ^<?xml version=""1.0"" encoding=""utf-8""?^> > !settingsPublishProfile!
echo ^<^^!-- >> !settingsPublishProfile!
echo https://go.microsoft.com/fwlink/?LinkID=208121.  >> !settingsPublishProfile!
echo --^> >> !settingsPublishProfile!
echo ^<Project ToolsVersion=""4.0"" xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""^> >> !settingsPublishProfile!
echo   ^<PropertyGroup^> >> !settingsPublishProfile!
echo     ^<PublishProtocol^>FileSystem^</PublishProtocol^> >> !settingsPublishProfile!
echo     ^<Configuration^>$(ConfigurationName)^</Configuration^> >> !settingsPublishProfile!
echo     ^<Platform^>$(PlatformName)^</Platform^> >> !settingsPublishProfile!
echo     ^<TargetFramework^>netcoreapp3.1^</TargetFramework^> >> !settingsPublishProfile!
echo     ^<PublishDir^>..\..\..\$(PlatformName)\$(ConfigurationName)\SettingsUIRunner^</PublishDir^> >> !settingsPublishProfile!
echo     ^<RuntimeIdentifier^>win-x64^</RuntimeIdentifier^> >> !settingsPublishProfile!
echo     ^<SelfContained^>false^</SelfContained^> >> !settingsPublishProfile!
echo     ^<PublishSingleFile^>False^</PublishSingleFile^> >> !settingsPublishProfile!
echo     ^<PublishReadyToRun^>False^</PublishReadyToRun^> >> !settingsPublishProfile!
echo   ^</PropertyGroup^> >> !settingsPublishProfile!
echo ^</Project^> >> !settingsPublishProfile!

rem In case of Release we should not use Debug CRT in VCRT forwarders
IF $(ConfigurationName)==Release (
""$(MSBuildBinPath)\msbuild.exe"" ..\..\..\..\src\core\Microsoft.PowerToys.Settings.UI.Runner\Microsoft.PowerToys.Settings.UI.Runner.csproj -t:Publish -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:VCRTForwarders-IncludeDebugCRT=false -p:PublishProfile=!settingsProfileFileName!
) ELSE (
""$(MSBuildBinPath)\msbuild.exe"" ..\..\..\..\src\core\Microsoft.PowerToys.Settings.UI.Runner\Microsoft.PowerToys.Settings.UI.Runner.csproj -t:Publish -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:PublishProfile=!settingsProfileFileName!
)

rem Publish Launcher
SET launcherProfileFolderName=..\..\..\..\src\modules\launcher\PowerLauncher\Properties\PublishProfiles\

rem Create the publish profile folder if it doesn%27t exist
IF NOT EXIST !launcherProfileFolderName! (mkdir !launcherProfileFolderName!)
SET launcherProfileFileName=LauncherProfile.pubxml
SET launcherPublishProfile=!launcherProfileFolderName!!launcherProfileFileName!

rem Create the publish profile pubxml
echo ^<?xml version=""1.0"" encoding=""utf-8""?^> > !launcherPublishProfile!
echo ^<^^!-- >> !launcherPublishProfile!
echo https://go.microsoft.com/fwlink/?LinkID=208121.  >> !launcherPublishProfile!
echo --^> >> !launcherPublishProfile!
echo ^<Project ToolsVersion=""4.0"" xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""^> >> !launcherPublishProfile!
echo   ^<PropertyGroup^> >> !launcherPublishProfile!
echo     ^<PublishProtocol^>FileSystem^</PublishProtocol^> >> !launcherPublishProfile!
echo     ^<Configuration^>$(ConfigurationName)^</Configuration^> >> !launcherPublishProfile!
echo     ^<Platform^>$(PlatformName)^</Platform^> >> !launcherPublishProfile!
echo     ^<TargetFramework^>netcoreapp3.1^</TargetFramework^> >> !launcherPublishProfile!
echo     ^<PublishDir^>..\..\..\..\$(PlatformName)\$(ConfigurationName)\modules\launcher^</PublishDir^> >> !launcherPublishProfile!
echo     ^<RuntimeIdentifier^>win-x64^</RuntimeIdentifier^> >> !launcherPublishProfile!
echo     ^<SelfContained^>false^</SelfContained^> >> !launcherPublishProfile!
echo     ^<PublishSingleFile^>False^</PublishSingleFile^> >> !launcherPublishProfile!
echo     ^<PublishReadyToRun^>False^</PublishReadyToRun^> >> !launcherPublishProfile!
echo   ^</PropertyGroup^> >> !launcherPublishProfile!
echo ^</Project^> >> !launcherPublishProfile!

rem In case of Release we should not use Debug CRT in VCRT forwarders
IF $(ConfigurationName)==Release (
""$(MSBuildBinPath)\msbuild.exe"" ..\..\..\..\src\modules\launcher\PowerLauncher\PowerLauncher.csproj -t:Publish -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:VCRTForwarders-IncludeDebugCRT=false -p:PublishProfile=!launcherProfileFileName!
) ELSE (
""$(MSBuildBinPath)\msbuild.exe"" ..\..\..\..\src\modules\launcher\PowerLauncher\PowerLauncher.csproj -t:Publish -p:Configuration=""$(ConfigurationName)"" -p:Platform=""$(PlatformName)"" -p:AppxBundle=Never -p:PublishProfile=!launcherProfileFileName!
)





Known issues

By disabling IncrementalClean, Clean Solution no longer cleans the Settings project or the Launcher project and cleaning Settings/Launcher projects don't work either. A separate issue can be created for this and it may be possible to fix this by tweaking the target conditions (enabling incremental clean only for the Clean target).
#2758 still exists on the build farm. I think the quickest way to unblock this would be to move FZ dlls to a separate folder.
Even if there are no changes in the project, F5 still does some building for Settings/Launcher, but it is quicker than before


Validation Steps Performed

Debug and Release F5ed many times, both Launcher and Settings worked every time.
Built MSI with Release multiple times alternated with multiple builds of PowerToys.sln to confirm deteminism.
Confirmed that the MSI builds on the CDPX pipeline. MSI installs and works fine except FancyZones due to #2758",4,18
2768,2020-05-07T11:23:27Z,2020-05-07T13:12:58Z,2020-05-07T13:12:58Z,1,1,415,"Summary of the Pull Request
Removed x86, ARM and ARM64 build platforms.
 
References
This closes #2767

PR Checklist

 Applies to #2767
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Built the solution on x64 in both Debug and Release and ran unit tests.
In Release: some unit tests in Wox fail and some in Microsoft.PowerToys.Settings.UnitTest are not run.
In Debug: the same tests in Wox fail and in Microsoft.PowerToys.Settings.UnitTest/ViewModelTests/General all tests fail
Most importantly, the build succeeds.",3,2
2775,2020-05-07T13:36:19Z,2020-05-07T14:39:33Z,2020-05-07T14:39:33Z,9,200,10,"Summary of the Pull Request
As we show the exit dialog during the installation, we launch action_runner -install_dotnet action, which:

checks if .net core is installed
if not, downloads it and installs it

Also fixed copyright for action_runner and added missed file stream .Close() call.

PR Checklist

 Applies to #2713


Validation Steps Performed
Current master fails to build MSI, so I've commented some of the Components for testing.

installed PT on a clean VM without dotnet core, verified that Settings window works
installed PT on a clean VM with dotnet core 3.1.1 - it's successfully detected
installed PT 0.16 with a custom code on a clean VM without dotnet core to update from a local MSI, launched the update installation, verified that .net core is also installed at the end of the update process",2,1
2776,2020-05-07T13:58:46Z,2020-05-07T18:24:20Z,2020-05-07T18:24:20Z,2,41,90,"Summary of the Pull Request
Settings v2 changed fancy zones color picker json format to ARGB which caused crush on displaying fancy zones.
Also: Changing any color resets fancyzones_highlight_opacity.
Changing fancyzones_highlight_opacity resets colors (fancyzones_zoneHighlightColor, fancyzones_zoneBorderColor, fancyzones_zoneColor)
After the change:

Color are saved in RGB
Transparency options for each color are removed since we have global transparency option
All fancyzones are now saved when changing colorpicker or other setting
Buttons responsible for saving colors are removed to match instant save which applies to other settings


PR Checklist

 Applies to #2763",3,3
2786,2020-05-07T20:51:10Z,2020-05-08T15:22:58Z,2020-05-08T15:22:58Z,10,425,32,"Summary of the Pull Request

Updated Shortcut Guide settings default values.
Updated FancyZones settings default values.
Updated Shortcut guide tests to check for default values.
Updated FancyZones tests to check for default values.


PR Checklist

 Applies to #2335, #2747
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2335, #2747


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed

Ran and updated tests",2,2
2788,2020-05-08T01:01:36Z,,2020-05-08T07:03:39Z,815,71909,13726,"Summary of the Pull Request
Added a file containing today's date!",22,0
2791,2020-05-08T07:17:33Z,2020-05-11T16:49:44Z,2020-05-11T16:49:44Z,1,1,0,"Summary of the Pull Request
Added ""MyFirstCommit.md"".
Modified one file, not 800 this time. Hah!",3,0
2796,2020-05-08T13:29:08Z,2020-05-11T12:37:30Z,2020-05-11T12:37:30Z,5,76,16,"Summary of the Pull Request
""Maximum numbers of items to show in recently used list for autocomplete dropdown.""  had:

No default value in settings
""Enable autocomplete and autosuggest of recently used list for autocomplete dropdown."" was duplicated in settings
Had no caption
Had no limits for min and max value
Could be edited while ""Enable autocomplete and autosuggest of recently used list for autocomplete dropdown."" was off

This PR fixes this problems.

PR Checklist

 Applies to ##2792",4,2
2797,2020-05-08T16:12:39Z,2020-05-08T20:34:22Z,2020-05-08T20:34:22Z,4,0,0,"Summary of the Pull Request

Added MDL2 EB3B to replace the app.png and app_error.png purple icons.
Icons where added both to the \Wox\Images folder and \PowerLauncher\Images folder, though only the \Wox folder images seem to be in use.
48 px icons were dowloaded to match the other icons.


PR Checklist

 Applies to #2336
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
Dark mode

Light mode


Validation Steps Performed

A reliable way I found to have the icon show up is by moving an exe into the One Drive folder and searching for it",3,0
2798,2020-05-08T16:16:25Z,2020-05-09T00:34:25Z,2020-05-09T00:34:25Z,11,210,99,"Summary of the Pull Request
This PR adds many P0 and P1 UI tweaks as well as some bug fixes. Final UI tweaks on column sizes will be made after fixing #2778 . I'll make those changes in a separate PR but off of this branch to make reviewing simpler.


PR Checklist

 Applies to #2651, #2650, #2545 , #2486
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Fixed KBM window not in foreground on first launch
Added arrow for clear direction on remapping
Changed window headers to wrap to text so that it doesn't get cut out on resizing
Changed column sizes and tweaked alot of the UI parameters
Added constants for all the column and table related logic to make tweaking code much easier (earlier a ton of numbers were hardcoded)
Fixed an issue where incorrect warnings would appear for conflicting modifer keys
Set default window sizes for both windows
Set center of the screen as default start location for the windows. Multi-monitor issue still exists however
Set the Type Key and Type shortcut buttons to match in size with drop down",4,4
2799,2020-05-08T16:41:39Z,2020-05-08T20:59:50Z,2020-05-08T20:59:50Z,1,2,0,"noticed this on the wpf branch, surprised the call pattern wasn't in the island version as well.",3,0
2809,2020-05-08T18:22:08Z,2020-05-08T21:13:49Z,2020-05-08T21:13:49Z,2,26,31,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #1782
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
2811,2020-05-08T20:29:27Z,2020-05-11T19:45:56Z,2020-05-11T19:45:56Z,9,239,26,"Summary of the Pull Request

A confirmation dialog appears for single key remappings if there are orphaned keys.
Apply button is changed to OK, and closes the window after applying the changes.
A confirmation dialog appears for both single key and shortcut remappings if not all remappings are valid.


PR Checklist

 Applies to #2461, #2779, #2815
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments


Validation Steps Performed

When remapping single keys, a confirmation dialog shows up if there is at least one orphaned key.
When remapping either shortcuts or single keys, a confirmation dialog shows up if there is at least one invalid remapping.",3,4
2814,2020-05-08T20:45:20Z,2020-05-08T23:12:38Z,2020-05-08T23:12:38Z,6,79,16,"Summary of the Pull Request
This PR does the following.

Enables svg and markdown preview by default.
Raises telemetry events when enabling or disabling the markdown.

 
References

PR Checklist

 Applies to #2060, #2745
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
The following considerations were made in this PR

To be backwards compatible with .17 we need to serialize and deserialize as a BoolProperty.   I've added a BoolPropertyJsonConverter to serialize and deserialize bool Properties as the BoolProperty type.
Because we want to detect when the EnableSvg and EnableMarkdown properties are set we don't want to expose this type to calling methods.  Eg. Settings.properties.EnableSvg.Value = value; becomes Settings.properties.EnableMd = value; and we don't interact with the BoolProperty directly.


Validation Steps Performed
Installed .17:

Verified that the settings are loaded into settings v2.

Toggling EnableSvg and EnableMarkdown settings and verified.

Telemetry Events are fired for both.
Settings are serialized in the same format:

Comparison of .17 settings and settngs v2:
.17

.18

Note name appears in a different order, but this is still equivalent from a json perspective
WPA Events:",2,1
2816,2020-05-09T00:05:26Z,2020-05-11T17:10:37Z,2020-05-11T17:10:37Z,11,85,117,"Summary of the Pull Request
This PR reverts the warning system to flyouts since most of the bug bash feedback revolved around warnings not being visible/noticeable. The main issue with the flyout system was that drop downs were almost unusable since searching on them would trigger flyouts even if you dont select them.

PR Checklist

 Applies to #2778 , #2665
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Removed the warning exclamation icon
Added the old flyout design for warnings introduced in #2140
The main issue with the flyouts was that it made searching in drop downs very difficult. The ComboBox.SelectionChanged handler gets called even when searching in the drop down and a selection is highlighted. This would cause the flyout to appear and it would close the drop down. This caused issues such that if the user cannot type A because it's the first drop down, they could not search for Alt either since A would be the first selection and the flyout would pop up.
Based on an idea from this stackoverflow answer, I moved the selection handler to the ""Drop Down closed"" event. By doing this the selection logic and validation of the shortcut is done only when the drop down is closed, so searching is not affected by this. This however would not work for the following two scenarios:


The user uses Type Key/shortcut to enter a key/shortcut and presses OK. In this case the drop downs get populated but it is never opened/closed so that method would not get triggered
When opening remap key/shortcuts if you have old remappings then those would have to be reloaded. Again in this case dropdownClosed is not triggered.
If the user has keyboard focus on the combo box and just types in something, dropDownClosed isnt triggered.


To handle the above to cases we have to use the SelectionChangedHandler, however we have to ensure we only do this only for those cases. This is done by checking if the drop down is currently closed. This encompasses all the above cases and the only case where it still happens apart from the above list is if we SetSelectedIndex from within the DropDownClosed handler. Since we only set it to -1 there, and we chave checked for SelectedIndex !=-1 in the selectionchanged logic this is not a problem. All other cases where you have to open the drop down and you click something do not trigger SelectionChanged because SelectionChanged is called first, then the dropDownClosed handler is called, so the drop down is considered open during that.
After switching to the flyout case there was one bug with using None. If you would set None and the drop down gets deleted but the resulting shortcut has a conflict with another shortcut then an error would occur because a flyout would try to open on that deleted drop down. This has been resolved by doing the drop down deletion only after ensuring that there are no other errors/conflicts if that drop down was removed.


Validation Steps Performed
Validated all the error messages still appear as before and ensured that warnings appear as they should when using the following:

Type Shortcut/Key
Opening remap keyboard/shortcuts with old remappings and just clicking apply should maintain all the remappings (to ensure selection handlers are correctly called)
Using the entire UI both using keyboard and using keyboard+mouse and navigating with the drop down and searching using them.",2,1
2822,2020-05-09T13:39:37Z,2020-05-11T19:36:56Z,2020-05-11T19:36:56Z,15,246,124,"Summary of the Pull Request

Re-organized the General page (#2804 #2688)
Applied consistent add button styling (for KBM and ImageResizer( #2806 #2710)
Increased the default step value for the shortcut transition time (#2808)
Changed the 'About feature' text to 'About [MODULE NAME]' (#2805)
Added a direct link to this GitHub repo on the General page.
Minor localization fixes.

General page:

New Add button style:

References
#2804 #2688 #2806 #2710 #2808 #2805
PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx",6,41
2826,2020-05-09T15:32:18Z,,2020-08-07T08:51:06Z,2,37,16,"Summary of the Pull Request
Updated cellChildMaps for priority grid layout such that zones stay in the same location as the number of zones is increased or decreased.

PR Checklist

 Applies to #1890
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
The definition for the IZoneSet interface was updated but in a way that should not impact any existing code. An overload param with default value was added to the existing AddZone method for use with the grid and priority grid layouts.
I didn't want to change the actual arrangement of zones in any way as this would require changes in the fancy zones editor to be made as well.
I feel as though above 7 zones the defined layouts may be inideal for most users. I only really imagine users with ultrawide monitors ever using this and some of the decisions such as there being 4 even rows don't seem desireable. Perhaps the userbase should be surveyed on this feature.
That being said, it seems like some future work in the pipeline may invalidate this layout completely, what's the point in a priority zone that's two rows wide when you can stretch a window across multiple zones?

Validation Steps Performed
Went from 0 zones to max with the keep windows in zones when the layout changes option enabled to ensure that windows stay in the correct region of the screen.",5,9
2827,2020-05-09T15:56:52Z,2020-05-09T21:10:58Z,2020-05-09T21:10:58Z,2,82,1,"Summary of the Pull Request
This PR hides the loading icon which appears for the Settings and Launcher xaml island projects. After these changes an icon symbol still quickly appears and then disappears but it's for a couple of milliseconds.

PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Once the XamlApplication has been initialized we get the CoreWindow and set it's window state to SW_HIDE as suggested by @ocalvo",3,4
2837,2020-05-11T09:20:16Z,2020-05-11T18:22:24Z,2020-05-11T18:22:24Z,4,27,21,"Summary of the Pull Request
PR Checklist

 Applies to #2758


Validation Steps Performed

rebuild solution and MSI
tested running FZ/FZE from VS
tested running FZ/FZE from the installed MSI",6,0
2840,2020-05-11T11:01:35Z,2020-05-11T12:46:33Z,2020-05-11T12:46:33Z,2,4,1,"Summary of the Pull Request
This PR changes the text shown on the settings page of Shortcut guide from 'Choose Settings color' to 'Choose Shortcut Guide overlay color', as it used to be in 0.17.
 
References
#2839

PR Checklist

 Applies to #2839
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Built the solution and verified that both the text on the General page and Shortcut Guide page are correct, as they used the same resource string before.",3,0
2842,2020-05-11T13:43:40Z,2020-05-11T17:31:43Z,2020-05-11T17:31:43Z,64,3485,0,Uploading OOBE Sandbox (replicate of PowerToys settings),4,1
2859,2020-05-11T20:21:35Z,,2020-05-11T21:32:43Z,73,3719,0,Used toast notifications for app lanuch,5,1
2861,2020-05-11T21:05:10Z,2020-05-13T15:06:44Z,2020-05-13T15:06:44Z,5,100,1,"Summary of the Pull Request
Toast notification that pops up on screen and stays in Windows Notification center

Detailed Description of the Pull Request

Notification pops up when app is opened
Button currently does not redirect anywhere",6,1
2866,2020-05-11T21:40:22Z,2020-05-12T00:18:12Z,2020-05-12T00:18:13Z,4,67,42,"Summary of the Pull Request
This PR adds the same preprocessing for the remapped keys list on the landing page as done on the C++ side. In the C++ side of the code, to make key handling easier since ""VK_CONTROL"" is never actually sent as a key message, it was decided that if a user remaps Ctrl_Left and Ctrl_Right to the same key then we combine it as Ctrl has been remapped, and similarly for all modifiers. However this was not reflected on the landing page.

PR Checklist

 Applies to #2783 (Closes #2783)
 CLA signed. If not, go over here and sign the CLAx


Detailed Description of the Pull Request / Additional comments

Restructured the C++ side of the logic to be clean and readable with code re-use.
Added a Constants class to the interop namespace in order to access constants from common.
Added this constant from interop to the Helper class in Lib.Utilities
Duplicated the C++ preprocessing logic in the LoadProfile function on the C# side. I did not use it through interop since I wasn't comfortable with moving it there since on the C++ side we manipulate an unordered_map but on the C# side we have to manipulate a list.


Validation Steps Performed
Tried adding L and R versions of modifiers and verified that the appear as expected when remapped to different keys and when remapped to the same key.",4,1
2868,2020-05-11T22:25:15Z,2020-05-12T16:58:30Z,2020-05-12T16:58:30Z,20,275,44,"Summary of the Pull Request

This PR creates a dll, os-detection.dll which has a C++ function, namely use_new_settings(). This function uses API contracts to determine whether the OS version that PowerToys is being run on is older than 19h1 or not.
For older versions of Windows, the ImageResizer settings hyperlink is displayed.
For newer versions of windows (19h1 and later), the ImageResizer settings hyperlink is hidden as those options are moved to settings v2 instead.

 

PR Checklist

 Applies to #2443
 CLA signed. If not, go over here and sign the CLA
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
The following change has been made in this PR (Note the settings hyperlink in the lower left corner) -


For windows which have the May 2019 update, the Img Resizer setting looks as follows -



For the older OS versions, setting looks as follows -



As the C++ code is being accessed by the runner (C++) as well as the ImageResizerSettings UI (C#), p/invoke and DllImport have been used to avoid code replication.



Validation Steps Performed

Tested it on an RS4 and RS5 VMs as well as 19h1 dev machine.
MSI created by this change (accessible only to Microsoft) - https://microsoft.sharepoint.com/:u:/t/Notes145/ETrVUIkcSaJJuQIvnHqCqHUBgtRIUneIE5Jd6OlschRQUw",3,2
2870,2020-05-11T22:41:00Z,2020-05-12T16:21:55Z,2020-05-12T16:21:55Z,2,233,224,"Summary of the Pull Request
Reverted the buttons to what it was earlier for .18, since @jyuwono pointed out that using a + symbol didn't make sense since the UI is for editing and not just adding remaps. We will have to rethink this design after .18. The newly added code has been commented out, so that we can tweak it after .18",3,3
2873,2020-05-12T00:15:56Z,2020-05-12T17:17:28Z,2020-05-12T17:17:28Z,4,16,12,"Summary of the Pull Request
This PR fixes the default window size to scale with DPI. The code is reused from the common library which allows you to convert the width/height in pixels based on the current DPI.

PR Checklist

 Applies to #2872 (Closes #2872 )
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Opened the KBM window with default scaling and increased windows scaling.
Screenshots
The default size should support adding 4 keys/shortcuts in terms oh height and width should be enough to see all text in a single line and for shortcuts 3->3 should be completely visible along with some arrow and delete button spacing
Remap Keyboard

Remap Shortcuts",2,1
2875,2020-05-12T00:27:24Z,2020-05-12T03:13:08Z,2020-05-12T03:13:08Z,6,21,2,"Summary of the Pull Request
Added Segoe  MDL2 KeyboardClassic as KeyboardManager icon.
 
References

PR Checklist

 Applies to #2869
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments


Validation Steps Performed

Launch PowerToys.
Open Settings
Go to KeyboardManager settings
Add a single key remap.
The Window's title bar icon should be the new one, the icon in the task bar should be the new one.
Add a shortcut.
The Window's title bar icon should be the new one, the icon in the task bar should be the new one.",2,0
2879,2020-05-12T04:59:53Z,2020-05-15T16:08:40Z,2020-05-15T16:08:40Z,34,505,354,"Summary of the Pull Request
This change basically adds a PartA_PrivTags field to all telemetry events.  It is up to the individual event to specify the value of PartA_PrivTags.
 
References

PR Checklist

 Applies to #2878
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
Note:  Version number is hard coded.  This will be removed post .18 in #3040

Validation Steps Performed
Here are the Data Viewer Log files:
Microsoft.PowerToys.LauncherBootEvent.txt
Microsoft.PowerToys.SettingsEnabledEvent.txt
Microsoft.PowerToys.SettingsBootEvent.txt
Microsoft.PowerToys.MarkdownFileHandlerLoaded.txt
Microsoft.PowerToys.MarkdownFilePreviewed.txt
Microsoft.PowerToys.SvgFileHandlerLoaded.txt
Microsoft.PowerToys.SvgFilePreviewed.txt
Microsoft.PowerToys.SvgFilePreviewError.txt
Microsoft.PowerToys.LauncherFirstDeleteEvent.txt
Microsoft.PowerToys.LauncherQueryEvent.txt
Microsoft.PowerToys.LauncherResultActionEvent.txt
Microsoft.PowerToys.LauncherShowEvent.txt
Microsoft.PowerToys.LauncherHideEvent.txt",3,13
2881,2020-05-12T06:03:14Z,,2020-05-12T17:20:53Z,2,16,8,"Fixed General Settings tests by wrapping ResourceLoader in try/catch block. Otherwise, it would throw an exception when testing

Summary of the Pull Request

Fixes General Settings tests by avoiding the exception that was being thrown from the ResourceLoader initialization.
Removes some asserts that requires ResourceLoader.


PR Checklist

 Applies to #xxx
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed

Run all Microsoft.PowerToys.Settings.UnitTest",2,0
2883,2020-05-12T07:21:45Z,2020-05-12T17:20:40Z,2020-05-12T17:20:40Z,1,1,1,"Summary of the Pull Request
Fixed tables in MarkDown previews being displayed incorrectly.
 
References

#2022


PR Checklist

 Applies to MarkDown previews
 CLA signed.
 Tests added/passed


Detailed Description of the Pull Request / Additional comments


Verified the expected result in the Windows Explorer preview window.",4,1
2889,2020-05-12T09:36:10Z,2020-05-12T10:55:37Z,2020-05-12T10:55:37Z,1,1,1,"Summary of the Pull Request
Removed dlls causing build error

PR Checklist

 Applies to #2886",2,0
2895,2020-05-12T11:26:51Z,2020-05-12T12:27:20Z,2020-05-12T12:27:20Z,3,12,8,"Summary of the Pull Request

PR Checklist

 Applies to #2894


Validation Steps Performed

build Release version of the solution",2,0
2896,2020-05-12T11:29:39Z,2020-05-12T17:33:42Z,2020-05-12T17:33:42Z,1,7,3,"Summary of the Pull Request
Currently PowerLauncher can be zoned using overriden win+arrow key or by dragging it with shift.
After changed fancyzones ignores PowerLauncher making it unsnappable

PR Checklist

 Applies to #2888",3,5
2897,2020-05-12T11:34:52Z,2020-05-12T16:37:34Z,2020-05-12T16:37:34Z,1,1,1,"Summary of the Pull Request
Removed .NET Core DLLs from PowerToys launcher

PR Checklist

 Applies to #2886
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Build PowerToysSetup, install created msi",4,5
2901,2020-05-12T15:45:08Z,2020-05-13T16:53:29Z,2020-05-13T16:53:29Z,6,273,0,"Here is the PR RGB functionality in C#. This code logs to console the RGB value of the current pixel upon mouse click.
The basic structure:

SystemHook is abstract has the base functionality to connect to system hook.
MouseEvent is a child of SystemHook, and handles a system hook which is mouse related.
PixelColor finder creates the callback which gets passed into the MouseEvent class, this class will probably need to be integrated into a WPF controller at a later date.",9,3
2904,2020-05-12T16:25:31Z,2020-05-12T19:15:14Z,2020-05-12T19:15:15Z,37,180,177,This is a half-implemented backend multi-monitor support in preparation to merge w/ frontend.,5,0
2905,2020-05-12T16:26:14Z,2020-05-12T18:00:29Z,2020-05-12T18:00:29Z,828,73137,13743,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",23,0
2915,2020-05-12T18:38:57Z,2020-05-12T22:58:12Z,2020-05-12T22:58:12Z,6,50,21,"Summary of the Pull Request
This PR changes the disable behavior such that it closes all active KBM windows. This ensures that users do not see unexpected behavior on disabling KBM but continuing to use the UI since the hook would be disabled.

PR Checklist

 Applies to #2914
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Added functions to close active windows, which are called from dllmain
Changed some constants data types to fix warnings
Removed the minimize option from both windows to convey the idea of a dialog box. More details here


Validation Steps Performed
Verified that behavior is as expected if disabling when windows are open or closed. The one scenario I'm a bit concerned with is if the user clicks OK and then quickly goes and disables the saving to file could get interrupted, but I wasn't able to repro this.",3,0
2916,2020-05-12T18:41:18Z,2020-05-12T20:25:32Z,2020-05-12T20:25:32Z,9,70,2,"Summary of the Pull Request
The initial color bar for the color picker is completed. We just need to connect the backend to add the logic to provide functionality for the buttons and the textboxes.
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,0
2917,2020-05-12T18:41:25Z,2020-05-12T22:42:22Z,2020-05-12T22:42:22Z,10,458,345,"Summary of the Pull Request
This PR replaces the UWP search box with an equivalent WPF control to fix the initial focus issue.

PR Checklist

 Applies to #2365
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed

Manually validated that search box functionality remains similar to previously used UWP control.
Manually validated that colors are toggled with change in system theme.",3,0
2921,2020-05-12T19:20:30Z,2020-05-14T18:04:02Z,2020-05-14T18:04:02Z,5,135,12,"Summary of the Pull Request
Phase 1 implementation for multi-monitor support:

Users can now open the editor one monitor, pick a specific layout and choose a different monitor from the combo box to apply the changes to
The identify button right now just shows a simple message box that would be replaced by actual functionality in a later phase
Also in phase 2/3 we will be utilizing the System.management namespace to correctly map the Display number to the Monitor ID (right now the mapping is arbitrary but since the devices array in zone-settings.json is always sorted it works out) -> Once this feature is implemented as well we will be able to default the drop down menu to the location of the monitor that started the editor

(Also Max and I were pair programming on the last couple of commits)",4,0
2923,2020-05-12T19:49:46Z,2020-05-13T18:58:40Z,2020-05-13T18:58:40Z,7,375,3,"This PR creates a simple front-end and a method for updating the displayed color.
It integrates the back-end code by modifying it for our needs. Essentially, we now use a timer rather than mouse move events, removing the need for the system hooks. The files have not yet been removed, but will be in a following PR once some of their useful functionality is extracted.
This version also includes a way to stop the color selection by pressing the space bar. This will eventually be replaced by a mouse click in a future PR.
Screenshot (very rough WIP and subject to change):",4,1
2925,2020-05-12T20:50:12Z,,2020-05-13T14:10:43Z,9,89,44,"Summary of the Pull Request
Visually improved the read me file, so it looks more appealing to (new) users:

Added hero image at the top with the new PowerToys logo
Added screenshots for all modules
Added Keyboard Manager and PowerToys Run (@crutkas proper descriptions are still needed there) for version 0.18.
Added 3 'shortcuts' after the project description (Download / Release notes / Privacy statement




References
#2766
PR Checklist

 Applies to #2766
 CLA signed. If not, go over here and sign the CLA",4,3
2928,2020-05-12T22:15:43Z,2020-05-14T16:12:41Z,2020-05-14T16:12:41Z,1,12,2,"Summary of the Pull Request

In the event the runner takes time to launch the Settings UI, and if the user clicks the launch icon again while the runner is in the process of launching the first window, the runner will create another process to launch another settings window. To prevent this, I added a flag to tell if the runner is still launching the first window and to discard any clicks from the launch icon until the first settings window is launched.

 
References
#2900

PR Checklist

 Applies to #2900
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2900


Validation Steps Performed

Added a loop (on line 218) to delay the launching of the first settings UI so the runner can start two processes to launch the settings UI.

for (int c = 1; c <= 32767; c++)
{
        for (int d = 1; d <= 32767; d++)
        {
        }
}


Without the flag, on double click, the runner should launch two windows. With the flag, the runner should only launch one window.",4,1
2929,2020-05-12T22:15:56Z,2020-05-12T23:41:50Z,2020-05-12T23:41:50Z,1,17,9,"Summary of the Pull Request

Fixed the issue by starting a new Thread and setting it to STA.
Clipboard needs to be accessed from an STA thread https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.clipboard?view=netcore-3.1 (for some reason, this warning appears in the System.Windows.Forms.Clipboard msdn page but not in System.Windows.Clipboard, but it seems both are affected)
Clipboard opeartions launched from the context menu are not affected because they use the Main application thread and not the Task pool, which is set to STA.

 
References

PR Checklist

 Applies to #2657
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

Launch Launcher and type 1 + 1
Click on the result
Paste somewhere. It should paste the number 2",4,0
2930,2020-05-12T22:28:47Z,2020-05-14T16:23:52Z,2020-05-14T16:23:52Z,4,55,23,"Summary of the Pull Request
This PR fixes an issue where typing keys with longer names would overflow on the Type Shortcut UI. This has been fixed with the following changes:

Shortened some unnecessarily long key names
Added a second stack panel row, such that when more than 3 keys are entered they are added to the second row - the stack panel is hidden if there are 3 keys or lesser that have been pressed so that the double margin does not appear.

The changes only affect UI and makes no change to the actual logic in shared info between the threads.
Note: Couldn't use text wrapping to do the second row method, because a stack panel cannot be wrapped since it extends based on the content. The other alternative would be to add a max width to each textblock and wrap each of them but that would appear worse.

PR Checklist

 Applies to #2465 (Closes #2465)
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Tried typing in 2/3/4/5 key shortcuts with all custom named keys.
Screenshots
3 keys

5 keys",4,2
2931,2020-05-13T00:01:39Z,2020-05-13T17:13:45Z,2020-05-13T17:13:46Z,4,49,35,"Summary of the Pull Request
This PR changes the type key and type shortcut behavior to hold enter to accept instead of hold and release, so that it is consistent with the Esc behavior. It was also observed that in tab ordering for Remap Keyboard and Remap Shortcuts windows the Cancel key would get highlighted before OK which is not in the Left to Right order, so that has been swapped.

PR Checklist

 Applies to #2661 (Closes #2661)
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

The onAccept lambda was split into two parts, onPress and onRelease
In onPress we perform all the accept logic followed by detectKeyBox.hide() but we do not perform the ResetUIState and unregisterkeys()
The resetting of UI state along with disabling the key delay handler is done in onRelease. Because of this, we stop swallowing input only when Enter key is released, and this allows us to avoid the issue where pressing Enter triggers the Type key button again.
onPress is performed in case of the long press delay handler (along with the primary button color change even though that would appear for just a few milliseconds but the user can notice it)
onRelease is performed in case of the key release delay handler so that when user lets go of Enter key everything in the KBM state is cleared up
We define onAccept as onPress followed by onRelease so that primary button click behavior remains unchanged


Validation Steps Performed
Used OK and Cancel options from the type key/shortcut screen by clicking with mouse and also using hold enter and hold esc.",3,3
2943,2020-05-13T11:10:06Z,2020-05-13T16:23:57Z,2020-05-13T16:23:57Z,1,36,10,"Summary of the Pull Request
See #2942 for issue description.

PR Checklist

 Applies to #2942


Validation Steps Performed

install PT on a clean VM, verified dotnet --list-runtimes output:

Microsoft.NETCore.App 3.0.3 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
Microsoft.WindowsDesktop.App 3.0.3 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]",3,1
2945,2020-05-13T13:37:04Z,2020-05-14T09:36:28Z,2020-05-14T09:36:28Z,7,52,9,"Summary of the Pull Request
Autoupdate option visible only for administrators group

PR Checklist

 Applies to #2885
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
Autoupdate is visible for users from administrators group and hidden for other users

Validation Steps Performed
Manually tested using accounts from different groups",5,2
2946,2020-05-13T14:10:27Z,2020-05-14T04:31:36Z,2020-05-14T04:31:37Z,9,79,51,"Summary of the Pull Request
Visually improved the read me file, so it looks more appealing to (new) users:

Added hero image at the top with the new PowerToys logo
Added screenshots for all modules
Added Keyboard Manager and PowerToys Run (@crutkas proper descriptions are still needed there) for version 0.18.

I'm using  to align the text correctly with the images. Using the  html tag to make sure that the text can float to the right next to the image.

Added 3 'shortcuts' after the project description (Download / Release notes / Contribution




References
#2766
PR Checklist

 Applies to #2766
 CLA signed. If not, go over here and sign the CLA",3,4
2952,2020-05-13T16:23:05Z,2020-05-13T18:43:57Z,2020-05-13T18:43:57Z,6,186,21,"Summary of the Pull Request
The Program plugin was using ShObjldITIb.dll for launching applications using the Application Activation Manager and to get information about other applications using Shell Links.
Changes made in this PR -

Used COM Interop to get access to the IShellLinkW interface and the Application Activation Manager instead of referencing the dll.
System.Interop.RuntimeServices. ComTypes namespace was used to get access to IPersistFile.
Accessibility namespace was used for _RemotableHandle.
WIN32_FIND_DATAW, ActivateOptions, SLGP_FLAGS and SLR_FLAGS were defined.

 
References

For Application Activation Manager - https://github.com/MicrosoftEdge/edge-launcher/blob/108e63df0b4cb5cd9d5e45aa7a264690851ec51d/MIcrosoftEdgeLauncherCsharp/Program.cs
For IShellLinkW interface and other structures and enums - http://www.pinvoke.net/default.aspx/Interfaces.IShellLinkW


PR Checklist

 Applies to #2660
 CLA signed. If not, go over here and sign the CLA
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Validation Steps Performed

Validated the code flow by settings break points.
Deleted the cache and ensured that the Win32 application data was correctly populated by shell link.
Set breakpoints and ensured that the UWP applications were launched properly by the Application Activation Manager.",3,0
2955,2020-05-13T17:31:10Z,2020-05-13T18:51:53Z,2020-05-13T18:51:53Z,2,168,69,"Made FancyZones Adaptive Layout
On window resize to smaller window, the ""About Feature"" and corresponding GIF should appear on top of the regular settings
On window resize to a larger window, the ""About Feature"" and corresponding GIF should appear in their own column at the right side
Added Hover feature to show placeholder of Github link on Module Overview link hover",4,0
2956,2020-05-13T18:03:37Z,,2020-05-14T15:52:11Z,2,49,1,"Enabled Graphics Capture capability to be able to use Windows.Graphics.Capture API
Implementation will follow",5,1
2958,2020-05-13T18:44:54Z,2020-05-14T17:22:58Z,2020-05-14T17:22:58Z,3,140,53,"Summary of the Pull Request

Create toast for new Update and Update available
Changed design of button
refactored code for notifications
Add activation tags

Details

On Launch both a ""Get Started with PowerToys"" and ""New PowerToys Update"" toast should pop up",7,3
2962,2020-05-13T20:21:20Z,,2020-05-14T16:14:13Z,4,540,6,"Summary of the Pull Request
Drag and drop to draw rectangle in area below toolbar, can resize/move. Lock selection in place when record button is clicked. Selection is cleared when stop button is clicked. (added ResizableRectangle class from online tutorial)
Edit:
ResizableRectangle Credit to: https://github.com/kareemsulthan07/ResizableRectangleSample
YouTube video series (9 parts): https://www.youtube.com/watch?v=a8IsZFUIzQo",4,1
2963,2020-05-13T20:25:44Z,2020-05-14T13:42:30Z,2020-05-14T13:42:30Z,1,46,49,New teaching tips to reflect new design,5,0
2966,2020-05-13T20:46:53Z,2020-05-14T13:30:18Z,2020-05-14T13:30:18Z,2,3,3,"Summary of the Pull Request
This PR changes the title of the auto-download setting in the old and new settings ui.

PR Checklist

 Applies to #2967 (original proposal in #2885)
 CLA signed. If not, go over here and sign the CLA
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2967


Detailed Description of the Pull Request / Additional comments
The updates don't get automatically downloaded when the user is connected over a metered connection. This is something the user should known about. Because of not have to be afraid on having extra costs and to not being confused if it not works on metered connections.
Old title: Download updates automatically
New Title: Download updates automatically (Except on metered connections, where charges may apply)

Validation Steps Performed
Not validation steps done.",3,2
2968,2020-05-13T23:12:57Z,2020-05-14T00:50:20Z,2020-05-14T00:50:20Z,3,3,3,"Summary of the Pull Request
Updated powertoy run module name in settings. This is to fix powertoy run not reacting to settings changes cause in #2961

PR Checklist

 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated that powertoy run reacts to change in all the settings.",3,0
2969,2020-05-13T23:33:10Z,2020-05-14T16:24:51Z,2020-05-14T16:24:51Z,2,8,2,"Summary of the Pull Request
This PR makes the scroll viewer scroll to the bottom whenever a new remap is added. This hack works for now since the Add button is at the bottom, but we would want to remove this when we decide the correct positioning for the button. This hack had to be done since the UWP ScrollViewer control does not have a ""ScrollChanged"" handler unlike WPF where we could have used this solution.
 
References

PR Checklist

 Applies to #2460
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Tried adding remaps both when there are less remaps and scroll doesnt exist and when there are many remaps",2,0
2971,2020-05-14T00:02:17Z,2020-05-15T16:38:47Z,2020-05-15T16:38:48Z,4,18,15,"Summary of the Pull Request

Updated Tests General Settings ViewModel.

 
References

PR Checklist

 Applies to 2910
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx

Validation Steps Performed

Ran the tests.
Verified if changes in the UI are still working as intended.",2,0
2972,2020-05-14T00:52:52Z,2020-05-14T18:58:56Z,2020-05-14T18:58:57Z,3,30,8,"Summary of the Pull Request

Updated default values for Fancy Zones colors.

 
References
#2964

PR Checklist

 Applies to #2964
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #2964


Validation Steps Performed

Deleted settings files and ran the settings ui to check if default values were set.
ran tests.",1,0
2983,2020-05-14T10:22:28Z,2020-05-14T12:09:50Z,2020-05-14T12:09:50Z,2,5,2,"Summary of the Pull Request
Disabling toggles for Powertoys Run and Keyboard Manager

PR Checklist

 Applies to #2965
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Manually tested",5,2
2985,2020-05-14T11:19:16Z,2020-05-14T16:20:06Z,2020-05-14T16:20:06Z,6,103,5,"Summary of the Pull Request

update dotnet core to 3.1.4
close PowerToys which might be running during installation process
add Notice.md


PR Checklist

 Applies to #2442, #2887


Detailed Description of the Pull Request / Additional comments
We need to launch custom action TerminateProcesses on update/uninstall, so it doesn't have Installed condition. It's implemented as a C++ CA instead of using util:CloseApplication, because I was keep getting this error:
MSI (s) (EC!AC) [11:49:03:171]: Product: PowerToys (Preview) -- The installer has encountered an unexpected error installing this package. This may indicate a problem with this package. The error code is 2762. The arguments are: , , 

Action ended 11:49:03: WixCloseApplicationsDeferred. Return value 3.
WixCloseApplications:  Error 0x80070643: Failed MsiDoAction on deferred action

even though I've tried various combinations of ElevatedCloseMessage/RebootPrompt argument values. In short, scheduling WixCloseApplications before InstallInitialize was breaking the installer, but scheduling it after it wasn't sufficient, since the dialog from #2887 is generated during InstallValidate, which runs before InstallInitialize.
We also need certain logic of terminating the process: first we send WM_CLOSE, then we wait for a timeout value and terminate the process. This ensures that .NET core dlls are unloaded and we don't encounter #2887. I was getting the prompt w/o the timeout even when sending WM_CLOSE messages first.

Validation Steps Performed

install PT on a clean VM
verified that Launcher and Settings work
verified that Notice.md is present
launched uninstallation while Launcher and Settings window are open
uninstallation proceeded successfully w/o any prompts",5,2
2990,2020-05-14T13:57:37Z,2020-05-14T16:46:21Z,2020-05-14T16:46:21Z,11,257,194,"This PR includes the functionality for the transparent window. This window allows for mouse clicks to be captured without a system hook, and allows for the cursor icon to be changed.
Notes:

app.manifest is a boilerplate file, I only uncommented the part to change the process to be per monitor DPI aware (line 53 - 58)
app.config changes are also to support DPI awareness
The project now includes an assembly reference to both System.Drawing and System.Windows.Forms",5,0
2992,2020-05-14T14:35:07Z,2020-05-14T17:23:59Z,2020-05-14T17:23:59Z,5,78,2,"on click of the ""Check for Updates button"" in General Settings, the update content dialog should pop up",3,0
2999,2020-05-14T16:31:45Z,2020-05-14T18:19:06Z,2020-05-14T18:19:06Z,4,0,0,"Summary of the Pull Request
Update the icon for PowerToys.exe, the legacy Settings app and for the MSI dialogs.
Waiting to receive the 44x44 and 150x1550 icons for the new Settings app (#2487).

PR Checklist

 Applies to #1118


Validation Steps Performed
Built the MSI, insalled it and verified the new icon is used.",3,2
3000,2020-05-14T16:47:22Z,2020-05-14T19:48:34Z,2020-05-14T19:48:34Z,870,75138,13743,"Created a basic front end frame work for the context menus, and the properties that each of the menu items hold",23,0
3002,2020-05-14T16:59:16Z,2020-05-14T22:40:32Z,2020-05-14T22:40:32Z,18,986,0,"console application that demonstrates a programmatic resolution change. This functionality will be transferred to a form that can be used by the frontend wpf app (using interops). It was tested manually.
Addresses #27
Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,2
3003,2020-05-14T17:13:46Z,2020-05-14T19:26:27Z,2020-05-14T19:26:27Z,8,171,42,"This PR polishes the color picker's UI to its final version, including the design from Tanvi Chhabra.
Screenshot:

New features:

Redesigned UI
Maximizing and resizing are disabled
Toggle button for ""New Color"" is colored to show the current state (selection mode or frozen)
Remove state-conserving boolean to query state from toggle button directly
Press Escape to exit from selection mode and return to the previously frozen color

To do in a future PR:

Add feature to copy RGB/HEX values to clipboard upon clicking the textbox",5,0
3008,2020-05-14T17:38:12Z,2020-05-14T21:16:19Z,2020-05-14T21:16:19Z,3,50,41,"Summary of the Pull Request

Create toasts that activate the OnInstall and OnUpdate functionality

Detailed Description of the Pull Request / Additional comments

On launch, two toasts icons pop up
Pushing Get Started with PowerToys opens up OnInstall pop-up
Pushing New PowerToys update opens Update popup
Pressing either icon will remove all toasts immediately",3,0
3009,2020-05-14T17:40:27Z,2020-05-15T13:25:05Z,2020-05-15T13:25:05Z,3,87,0,"Purpose:

Inform future devs who implement a PowerToys OOBE of component decisions and issues we ran into
Inform about TODOs",3,0
3013,2020-05-14T18:25:17Z,2020-05-14T20:52:49Z,2020-05-14T20:52:49Z,2,4,3,"Summary of the Pull Request
This PR fixes issues with multi-monitor not centering correctly on vertical layout. The top was not being set after we migrated to WPF searchbox.

PR Checklist

 Applies to #2994
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated that powertoys run works in both vertical and horizontal layout.
Note:  I am still noticing following issues :

Shuddering after the first launch on monitor change.
The launcher goes out of focus and the selected text is not highlighted as well on first launch after monitor change. The issue is fixed on subsequent launches.",2,1
3017,2020-05-14T19:26:16Z,2020-05-14T23:24:21Z,2020-05-14T23:24:21Z,5,131,10,"Summary of the Pull Request
Add click eyedropper functionality and preventing color picking in the color picker window.",3,0
3030,2020-05-14T21:06:59Z,2020-05-15T15:53:31Z,2020-05-15T15:53:31Z,3,27,0,"Documentation of rationale, design, code and consideration for the welcome window",7,0
3032,2020-05-14T21:54:58Z,2020-05-15T15:41:22Z,2020-05-15T15:41:22Z,2,47,12,"Summary of the Pull Request

Add ApplicationSettings listeners so that Update popup and First Install popup only appear after an update or install
Create a sandbox function in App.xaml.cs so that toast notifications will be triggered on launch
Toasts can also trigger the appropriate popups
Sandbox notification function is present to replicate the background activation that should trigger toasts


Detailed Description of the Pull Request / Additional comments

Comment out final else statement in the MainPage.xaml.cs onNavigation (as described in comments) to prevent the First Install popup to appear on launch (as the current system properties will view your launch as a ""firstlaunch""
Two content dialogs cannot be open at the same time.",5,0
3033,2020-05-14T22:12:57Z,2020-05-14T23:26:46Z,2020-05-14T23:26:46Z,1,1,1,"Summary of the Pull Request
This PR fixes issue causing two sets of module name for powertoys run as indicated in the image below


PR Checklist

 Applies to #3027
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed


Validation Steps Performed
Manually validated only one folder named ""PowerToys Run"" is produced for both settings and power toys run configuration using steps given below :

Clean ""Microsoft\PowerToys\PowerToysRun"" folder in appdata folder, if present.
Build runner
Verify that only one folder named ""PowerToys Run"" is produced for launcher.",4,3
3034,2020-05-14T22:57:53Z,2020-05-15T00:24:18Z,2020-05-15T00:24:18Z,9,74,2,"Summary of the Pull Request

Updated readme
Added GIFs for readme
Added link for module overview


PR Checklist

 Applies to #2858
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

Clicked module overview in Settings which now opens launcher page
GIFs in readme are showing and playing",3,3
3037,2020-05-14T23:25:50Z,2020-05-15T15:49:45Z,2020-05-15T15:49:45Z,5,122,40,"Summary of the Pull Request


The Program plugin was previously using the AppxPackagingTlb.dll to get information about UWP applications.


This PR uses COM interop to access the IAppxFactory, IAppxManifestReader, IAppxManifestApplicationsEnumerator, IAppxManifestApplication and IAppxManifestProperties interfaces.



PR Checklist

 Applies to #2660
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

A helper class has been added which uses COM interop to access various interfaces.


Validation Steps Performed

Set breakpoints after deleting launcher cache and ensured that the information about UWP applications is properly populated.
Validated that the breakpoints are hit and that UWP applications show up while searching.",2,0
3038,2020-05-14T23:33:36Z,2020-05-18T01:31:30Z,2020-05-18T01:31:30Z,16,193,97," NEW FEATURE 

[OLD] Multi-monitor support  ~ Three iterations were completed over the feature!


[OLD ]Note: If our implementation is ever considered for a merge with master, I'd like to point out that App.ActiveMonitors (used to keep track of what monitors are being edited at a specific point in time) is a quick fix and not the best solution. As our hackathon is coming to a close, we decided to go with it but I'd definitely suggest you explore different alternatives in the future or, who knows, maybe my team and I will beat you to it with contributions outside the hackathon! 

[OLD] Here's a video of the implementation: https://streamable.com/9urxmv
 UPDATE 

Multi-monitor support  ~ Five iterations were completed over the feature!


Removed the App.ActiveMonitors mentioned earlier.

Here's a video of the implementation: https://streamable.com/vt302u
Other than that, if you'd like to ask any specific questions on the implementation, feel free to reach out to me (Dan // t-dachia@microsoft.com) or my colleague (Alex // t-alvoro@microsoft.com).",5,1
3039,2020-05-14T23:43:41Z,2020-05-15T17:23:08Z,2020-05-15T17:23:08Z,5,137,25,"Here is the code for the magnification. The basic premise is that the magnification image contents updates on an interval, while the position updates upon mouse movements. This keeps the mouse movements responsive.",5,0
3044,2020-05-15T05:50:30Z,2020-05-15T16:37:11Z,2020-05-15T16:37:12Z,1,4,1,"Summary of the Pull Request
This PR fixes a bug where FZ would not CallNextHook if it doesn't have to suppress the key event.

PR Checklist

 Applies to #3043
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments
Instead of return the value of the HandleKeyboardHookEvent function, return 1 only if it is equal to 1.",4,1
3045,2020-05-15T06:09:21Z,2020-05-16T00:16:04Z,2020-05-16T00:16:05Z,10,95,1,"Adding Read Me
GIFs + Link in Settings

 
Summary of the Pull Request
 
References

PR Checklist

 Applies to #2462
 CLA signed. If not, go over here and sign the CLA
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Validation Steps Performed
Setting page link works and https://github.com/saahmedm/PowerToys/tree/user/saahmedm/readme/src/modules/keyboardmanager gifs load",4,8
3048,2020-05-15T08:10:55Z,2020-06-11T22:32:35Z,2020-06-11T22:32:36Z,1,19,0,"Summary of the Pull Request
This is my suggestion of a bugfix for the issue I reported here:
#2938
Explorer loses the focus (title bar changes color) when using the SVG preview handler, and we cannot switch to the next file with the cursor keys any more.
 
References
No

PR Checklist

 Applies to #2938
 CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments
Before each call to SetParent, I check whether the form has the WS_CHILD style. If not, I set the style so it can become a child control within the Explorer preview pane.

Validation Steps Performed
I have compiled the project, then replaced the installed PreviewHandlerCommon.dll with my copy and checked whether the issue still occurs or not.",6,13
3050,2020-05-15T08:41:16Z,2020-05-25T14:05:28Z,2020-05-25T14:05:28Z,11,555,57,"Summary of the Pull Request
Added backend functionality for resolution to the application. Some of the marshalling needs to be fixed. Until then there are a number of place holder values.
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,1
3053,2020-05-15T12:46:47Z,2020-05-15T15:03:31Z,2020-05-15T15:03:31Z,1,2,2,"Summary of the Pull Request
Very obvious problem with a very obvious fix.
 
References
See #3052

PR Checklist

 Applies to #3052
 CLA signed. If not, go over here and sign the CLA


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Tested manually, now the crash does not happen and the settings work.",1,0
3055,2020-05-15T13:38:35Z,2020-05-15T15:37:51Z,2020-05-15T15:37:51Z,1,1,0,"Fix for randomly collapsing and expanding excluded apps list

PR Checklist

 Applies to #3051",3,1
3056,2020-05-15T14:25:21Z,2020-05-15T17:00:56Z,2020-05-15T17:00:56Z,2,22,65,"Removed general settings teaching tip
Changed run as user teaching tip content",3,0
3057,2020-05-15T14:36:22Z,2020-05-15T17:04:36Z,2020-05-15T17:04:36Z,2,74,4,"This adds support for copying the RGB or HEX values from the textboxes when clicking on them. This makes the overall user experience much more enjoyable by adding the chosen color to your clipboard as quickly as possible.
Screenshot:

Flow:

Select a color using the color selection mode (enabled on open, and then by clicking the ""New Color"" button after a first color is selected)
Click on the textbox containing the desired color format (RGB or HEX)
The text in the textbox is automatically selected, to give the user feedback, and copied to the clipboard
A small pop-up appears below the clicked textbox to confirm that the color has been copied to the clipboard",4,0
3058,2020-05-15T14:53:57Z,2020-05-15T16:31:17Z,2020-05-15T16:31:17Z,2,31,5,"Summary of the Pull Request
Click escape when in color picking mode to close the application.
When color picking, the mouse turns into a cross, and is restored afterwards.",3,0
3059,2020-05-15T14:57:17Z,2020-06-08T18:07:10Z,2020-06-08T18:07:10Z,5,188,0,"Created FrameInfo: to hold individual frame metadata in GIFs
Created RecorderConf: to hold current recording session details (size, framerate, screen coordinates)
Created Recorder: interface to link with front end (calls start pause stop)",5,5
3060,2020-05-15T15:49:58Z,,2020-05-15T17:12:45Z,3,39,5,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,0
3061,2020-05-15T16:01:03Z,2020-05-15T17:11:17Z,2020-05-15T17:11:17Z,8,21,22,Added styling to the welcome screen window so that all animated gifs have the same width and height,5,1
3066,2020-05-15T17:36:45Z,2020-05-15T19:42:56Z,2020-05-15T19:42:56Z,5,52,2,"Summary of the Pull Request
Add documentation for toast notifications in README.md",3,0
3067,2020-05-15T17:39:15Z,2020-05-15T22:17:23Z,2020-05-15T22:17:24Z,7,26,255,"This PR creates a README.md file with basic information. It also removes the initial console-only early proof of concept, which is no longer necessary now that its features are included in the main program.",5,0
3071,2020-05-15T18:25:01Z,2020-05-15T19:48:20Z,2020-05-15T19:48:20Z,7,164,57,"Summary of the Pull Request
Added a history palette that keeps track of colors saved previously so that you can return to them.
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",3,0
3081,2020-05-15T23:19:13Z,2020-05-16T01:51:57Z,2020-05-16T01:51:57Z,1,1,1,"Summary of the Pull Request

By default we want four results to show and not six, before settings loads the json file.


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed

Delete the PowerToys Run Appdata folder and run Launcher to get four results at start-up.

NOTE - Delete the AppData PowerToys Run folder before validating.",2,0
3092,2020-05-17T07:57:27Z,2020-05-19T22:07:07Z,2020-05-19T22:07:07Z,1,1,1,fix typo in comment,2,0
3093,2020-05-17T13:09:12Z,2020-05-20T08:49:29Z,2020-05-20T08:49:29Z,15,21,115,"Summary of the Pull Request
Remove ""Keep windows pinned to virtual desktop location flag"" FancyZones setting. Remove it both from new and old settings application.

PR Checklist

 Applies to #1562
 CLA signed. If not, go over here and sign the CLA",5,0
3097,2020-05-17T15:38:49Z,2020-05-25T08:15:43Z,2020-05-25T08:15:43Z,2,27,1,"Summary of the Pull Request
While moving windows through zones with win + left/right arrow handle maximized windows as well.

PR Checklist

 Applies to #2068
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed

Apply any zone layout to work area.
Take any window and maximize it.
Make sure Override Windows Snap hotkeys (win+arrow) to move windows between zones is ON.
Press win + left or right arrow.

Expected result: Window should be snapped out of maximized state and moved into correct zone.",4,0
3105,2020-05-18T08:30:33Z,2020-05-18T17:58:44Z,2020-05-18T17:58:44Z,1,1,1,"Summary of the Pull Request
Replaced the image MD tag with HTML. Seems to solve the issue.
References
#3104
PR Checklist

 Applies to #3104
 CLA signed. If not, go over here and sign the CLA",3,1
3106,2020-05-18T13:36:33Z,2020-05-25T07:59:05Z,2020-05-25T07:59:06Z,34,227,235,"Summary of the Pull Request
We now conditionally disable PCHs using a new CIBuild property and pass it as part of CI build process, so we don't clutter the build machine with PCHs.

PR Checklist

 Applies to #3069


Validation Steps Performed

build Release and Debug/Release with CIBuild=true",7,2
3123,2020-05-18T23:27:22Z,2020-05-20T16:17:46Z,2020-05-20T16:17:46Z,1,1,1,Changed UWP To packaged for issue #3116,2,0
3132,2020-05-19T10:10:52Z,2020-05-26T14:01:13Z,2020-05-26T14:01:13Z,17,341,873,"Summary of the Pull Request

Windows are now both stamped and their history is saved in a JSON file in such a way to support snapping to multiple zones.
Many responsibilities of the Zone class are now moved up to ZoneSet
Some unit tests which test the Zone class have been removed
More unit tests to test snapping to multiple zones should be added in the near future
App zone settings are now saved in a separate file
Fixed a bug with resizing, as described in #3111

 
References
Applies to #2579, #2580 and #3111

PR Checklist

 Applies to #2580
 CLA signed. If not, go over here and sign the CLA
 Tests added/passed
 Requires documentation to be updated
 I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed
Unit tests pass. Manually tested:

Moving the window using win+arrows works as intended, with or without the option to move between monitors
App settings are saved and restored properly
Windows can snap to multiple zones and are resized correctly when the layout/resolution changes

Not tested yet, but should work:
Migrating settings from older versions (e.g. 0.17)",5,0
3142,2020-05-19T16:11:07Z,2020-05-19T17:29:07Z,2020-05-19T17:29:07Z,1,1,1,"Summary of the Pull Request
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",2,0
3197,2020-05-19T19:14:12Z,2020-05-19T20:24:20Z,2020-05-19T20:24:20Z,3,27,10,"-added picture of app

added issues and future improvements
changed README.md.txt to README.md",3,0
3203,2020-05-19T19:34:01Z,2020-05-28T21:47:32Z,2020-05-28T21:47:32Z,11,722,594,"Summary of the Pull Request
This PR makes the following changes:

Set treat warnings as errors for all 3 KBM projects. Warning 4002 had to be disabled for these projects as it is a known bug in Xaml Islands (warning C4002: too many arguments for function-like macro invocation 'GetCurrentTime')
Moved all additional functions in dllmain except the base HandleKeyboardHookEvent to a KeyboardEventsHandler header file. This includes the singlekey remap handler and shortcut remap handlers. Other functions like SetKeyEvent and GetCurrentApplication were moved to Helpers.h in the KeyboardManagerCommon project.
Moved constants that were declared inside the PT module class to KeyboardManagerConstants.h
To clean up the projects in VS, Header files, Source files and Resource files filters were added for the projects.
No actual code was changed, functions were just moved around

The above changes are also required for making unit tests for the handlers. (#3112 )

PR Checklist

 Applies to #2918
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Build and run in Debug/Release",3,1
3213,2020-05-19T20:25:35Z,2020-05-19T23:10:41Z,2020-05-19T23:10:41Z,2,21,12,"Summary of the Pull Request

On typing vim, Vim Diff was showing up as the first result and instead of Vim.
This was happening because we assign a score to the results which is the max matching score of it's name, description and the executable name.
However, since all of them had the same executable name vim.exe all the results were getting the same score.


PR Checklist

 Applies to #3128
 CLA signed. If not, go over here and sign the CLA
 Tests added for exact matching results to get a greater score.


Detailed Description of the Pull Request / Additional comments

The score is increased by 10 when there is an exact match in the name of the search result.


Validation Steps Performed

Tests added.
Manually validated.",3,0
3235,2020-05-19T22:36:09Z,2020-05-20T16:56:00Z,2020-05-20T16:56:00Z,1,10,0,"Summary of the Pull Request
Fixes a scenario where a user could open Type key and switch to some other window but remappings would not be disabled.

PR Checklist

 Applies to #3227
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Verified that keys appear as expected in each of the window states.",3,6
3256,2020-05-20T02:00:48Z,2020-06-01T21:55:04Z,2020-06-01T21:55:04Z,1,65,0,"Summary of the Pull Request
Added readme for project documentation.
 
References

PR Checklist

[] Applies to #xxx
[] CLA signed. If not, go over here and sign the CLA
[] Tests added/passed
[] Requires documentation to be updated
[] I've discussed this with core contributors already. If not checked, I'm ready to accept this work might be rejected in favor of a different grand plan. Issue number where discussion took place: #xxx


Detailed Description of the Pull Request / Additional comments

Validation Steps Performed",4,4
3259,2020-05-20T03:00:10Z,2020-05-20T16:35:03Z,2020-05-20T16:35:03Z,3,66,69,"Summary of the Pull Request
This PR moves the publishing steps done as pre-build events to a separate publish.cmd which is called from the build.cmd script.
Since the paths in the script would depend on which folder it was being called from, a variable was set which would store the path of the powertoys root folder. This can be overrided before calling the publish script.
Note: With this change for making MSIs locally you need to separately run the publish.cmd first on cmd prompt after running the following command (required for msbuild to be accepted as a command)
call ""C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\Common7\Tools\VsDevCmd.bat"" -arch=amd64 -host_arch=amd64 -winsdk=10.0.18362.0
I will make a separate PR for making this publish.cmd run automatically while building locally but not on the pipeline, but that need not be pushed as a hotfix into stable since it only affects local MSIs.
I also had to hard code in ""Release"" and ""x64"" since I could not use the $(Configuration) and $(Platform) anymore since those variables wouldn't be set when running it from cmd as compared to a build-event.

PR Checklist

 Applies to #3028
 CLA signed. If not, go over here and sign the CLA


Validation Steps Performed
Tested local MSI by running the publish.cmd script manually, and also verified on the build pipeline.",2,0
